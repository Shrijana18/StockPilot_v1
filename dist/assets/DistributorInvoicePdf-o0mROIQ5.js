import{j as e}from"./index-DRC3F7i0.js";import"./router-BPBaD_i0.js";import{D as g,P as u,S as T,V as n,T as s,I as D}from"./FileSaver.min-DVuNBBJs.js";import{s as b}from"./pricing-SUVGnFgL.js";const t=T.create({page:{padding:30,fontSize:8,fontFamily:"Helvetica",color:"#111827",backgroundColor:"#FFFFFF"},header:{marginBottom:12,paddingBottom:10,borderBottomWidth:2,borderBottomColor:"#E5E7EB"},heading:{fontSize:20,fontWeight:700,marginBottom:3,color:"#111827"},invoiceMeta:{fontSize:7,color:"#6B7280",marginTop:2,lineHeight:1.3},sectionTitle:{fontSize:9,fontWeight:700,marginBottom:5,textTransform:"uppercase",letterSpacing:.3,color:"#374151"},card:{borderWidth:1,borderColor:"#E5E7EB",borderRadius:6,padding:8,marginBottom:8,backgroundColor:"#FAFAFA"},row:{flexDirection:"row",justifyContent:"space-between",gap:8},infoText:{fontSize:8,lineHeight:1.4,color:"#374151",marginBottom:2},table:{marginTop:6,borderWidth:1,borderColor:"#E5E7EB",borderRadius:4,overflow:"hidden",backgroundColor:"#FFFFFF"},tableHeader:{flexDirection:"row",backgroundColor:"#F3F4F6",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},tableRow:{flexDirection:"row",borderBottomWidth:.5,borderBottomColor:"#F3F4F6",backgroundColor:"#FFFFFF"},th:{fontWeight:700,fontSize:7,padding:4,color:"#374151"},td:{fontSize:7,padding:4,color:"#111827",lineHeight:1.3},bold:{fontWeight:700},breakdownRow:{flexDirection:"row",justifyContent:"space-between",fontSize:7,marginBottom:2,paddingVertical:1},breakdownTotal:{flexDirection:"row",justifyContent:"space-between",fontSize:9,fontWeight:700,marginTop:4,paddingTop:4,borderTopWidth:1,borderTopColor:"#E5E7EB",color:"#111827"},footer:{marginTop:12,paddingTop:8,borderTopWidth:1,borderTopColor:"#E5E7EB",textAlign:"center",fontSize:7,color:"#6B7280"},grandTotalBox:{backgroundColor:"#ECFDF5",borderWidth:1,borderColor:"#10B981",borderRadius:4,padding:8,marginTop:8}}),o=r=>`â‚¹${Number(r||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,w=r=>{if(!r)return null;if(r instanceof Date)return r;if(typeof r=="number")return new Date(r);if(typeof r=="string"){const a=new Date(r);return Number.isNaN(a.getTime())?null:a}return r?.seconds?new Date(r.seconds*1e3):r?.toDate?r.toDate():null},f=r=>{const a=w(r);return a?a.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A"},B=(r,a,c)=>{const l=c.pricingMode||"LEGACY",y=Number(c.basePrice||0),d=Number(c.mrp||0),i=Number(c.sellingPrice||c.price||c.unitPrice||0),p=Number(c.gstRate||c.taxRate||0),h=Array.isArray(r?.proforma?.lines)?r.proforma.lines[a]:void 0,x=h?.gstRate!==void 0?Number(h.gstRate):p;return l==="MRP_INCLUSIVE"?d>0&&x>0?b(d,x).base:d||i:l==="SELLING_PRICE"?i>0&&x>0?b(i,x).base:i:l==="BASE_PLUS_TAX"?y>0?y:i>0&&x>0?b(i,x).base:i:y||i},R=({invoice:r={},order:a=null})=>{const c=Array.isArray(a?.items)?a.items:Array.isArray(r?.items)?r.items:[],l=r.totals||{};let y="Pending";if(a)(a.isPaid===!0||a.paymentStatus==="Paid"||a.payment?.isPaid===!0)&&(y="Paid");else{const d=r.payment||{};if(typeof d.isPaid=="boolean")y=d.isPaid?"Paid":"Pending";else{const i=d.status||r.paymentStatus||r.isPaid;i===!0||i==="Paid"||i==="paid"?y="Paid":i===!1||i==="Pending"||i==="pending"?y="Pending":y=r.paymentStatus||(r.payment?.isPaid?"Paid":"Pending")}}return e.jsx(g,{title:r.invoiceNumber||r.id||"Invoice",children:e.jsxs(u,{size:"A4",style:t.page,wrap:!0,children:[e.jsxs(n,{style:t.header,children:[e.jsx(s,{style:t.heading,children:"TAX INVOICE"}),e.jsxs(n,{style:t.row,children:[e.jsxs(n,{style:{flex:1},children:[e.jsxs(s,{style:t.invoiceMeta,children:[e.jsx(s,{style:t.bold,children:"Invoice No: "}),r.invoiceNumber||r.id||"N/A"]}),e.jsxs(s,{style:t.invoiceMeta,children:[e.jsx(s,{style:t.bold,children:"Date: "}),f(r.issuedAt)]}),e.jsxs(s,{style:t.invoiceMeta,children:[e.jsx(s,{style:t.bold,children:"Status: "}),y]})]}),e.jsx(n,{style:{flex:1,alignItems:"flex-end"},children:e.jsxs(n,{style:t.grandTotalBox,children:[e.jsx(s,{style:[t.sectionTitle,{fontSize:8,marginBottom:4}],children:"Grand Total"}),e.jsx(s,{style:[t.infoText,t.bold,{fontSize:16,color:"#059669"}],children:o(l.grandTotal||0)})]})})]})]}),e.jsxs(n,{style:t.row,children:[e.jsxs(n,{style:[t.card,{flex:1}],children:[e.jsx(s,{style:t.sectionTitle,children:"Bill To (Buyer)"}),e.jsx(s,{style:t.infoText,children:r.buyer?.businessName||"N/A"}),r.buyer?.email&&e.jsxs(s,{style:t.infoText,children:["Email: ",r.buyer.email]}),r.buyer?.phone&&e.jsxs(s,{style:t.infoText,children:["Phone: ",r.buyer.phone]}),(r.buyer?.city||r.buyer?.state)&&e.jsx(s,{style:t.infoText,children:[r.buyer?.city,r.buyer?.state].filter(Boolean).join(", ")})]}),e.jsxs(n,{style:[t.card,{flex:1}],children:[e.jsx(s,{style:t.sectionTitle,children:"Sold By (Seller)"}),e.jsx(s,{style:t.infoText,children:r.seller?.businessName||"N/A"}),r.seller?.email&&e.jsxs(s,{style:t.infoText,children:["Email: ",r.seller.email]}),r.seller?.phone&&e.jsxs(s,{style:t.infoText,children:["Phone: ",r.seller.phone]}),r.seller?.gstNumber&&e.jsxs(s,{style:t.infoText,children:["GST: ",r.seller.gstNumber]}),(r.seller?.city||r.seller?.state)&&e.jsx(s,{style:t.infoText,children:[r.seller?.city,r.seller?.state].filter(Boolean).join(", ")})]})]}),e.jsxs(n,{style:t.card,children:[e.jsx(s,{style:t.sectionTitle,children:"Order Items"}),c.length===0?e.jsx(s,{style:t.infoText,children:"Order details not available."}):e.jsxs(n,{style:t.table,children:[e.jsxs(n,{style:t.tableHeader,children:[e.jsx(s,{style:[t.th,{flex:2.5}],children:"Product"}),e.jsx(s,{style:[t.th,{flex:.8}],children:"SKU"}),e.jsx(s,{style:[t.th,{flex:.6}],children:"Brand"}),e.jsx(s,{style:[t.th,{flex:.7}],children:"GST %"}),e.jsx(s,{style:[t.th,{flex:.9}],children:"Base"}),e.jsx(s,{style:[t.th,{flex:.9}],children:"Selling"}),e.jsx(s,{style:[t.th,{flex:.5}],children:"Qty"}),e.jsx(s,{style:[t.th,{flex:1}],children:"Total"})]}),c.map((d,i)=>{const p=Number(d.quantity||d.qty||0),h=Number(d.sellingPrice||d.price||d.unitPrice||0),x=p*h,j=Number(d.gstRate||d.taxRate||0),m=B(a||r,i,d);return e.jsxs(n,{style:t.tableRow,children:[e.jsxs(s,{style:[t.td,{flex:2.5}],children:[d.productName||d.name||"N/A",d.hsnCode?`
HSN: ${d.hsnCode}`:""]}),e.jsx(s,{style:[t.td,{flex:.8}],children:d.sku||"â€”"}),e.jsx(s,{style:[t.td,{flex:.6}],children:d.brand||"â€”"}),e.jsx(s,{style:[t.td,{flex:.7}],children:j>0?`${j}%`:"â€”"}),e.jsx(s,{style:[t.td,{flex:.9}],children:o(m)}),e.jsx(s,{style:[t.td,{flex:.9}],children:o(h)}),e.jsx(s,{style:[t.td,{flex:.5}],children:p}),e.jsx(s,{style:[t.td,{flex:1}],children:o(x)})]},i)})]})]}),e.jsxs(n,{style:t.card,children:[e.jsx(s,{style:t.sectionTitle,children:"Invoice Breakdown"}),e.jsxs(n,{children:[l.grossItems!==void 0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"Unit Price Total"}),e.jsx(s,{children:o(l.grossItems)})]}),l.lineDiscountTotal!==void 0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"- Line Discounts"}),e.jsx(s,{children:o(l.lineDiscountTotal)})]}),l.itemsSubTotal!==void 0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"Items Sub-Total"}),e.jsx(s,{children:o(l.itemsSubTotal)})]}),l.delivery>0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"+ Delivery"}),e.jsx(s,{children:o(l.delivery)})]}),l.packing>0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"+ Packing"}),e.jsx(s,{children:o(l.packing)})]}),l.insurance>0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"+ Insurance"}),e.jsx(s,{children:o(l.insurance)})]}),l.other>0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"+ Other"}),e.jsx(s,{children:o(l.other)})]}),l.discountTotal>0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"- Order Discount"}),e.jsx(s,{children:o(l.discountTotal)})]}),l.taxableBase!==void 0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{style:t.bold,children:"Taxable Base"}),e.jsx(s,{style:t.bold,children:o(l.taxableBase)})]}),l.taxBreakup&&e.jsxs(e.Fragment,{children:[l.taxBreakup.igst!==void 0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"IGST"}),e.jsx(s,{children:o(l.taxBreakup.igst)})]}),l.taxBreakup.cgst!==void 0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"CGST"}),e.jsx(s,{children:o(l.taxBreakup.cgst)})]}),l.taxBreakup.sgst!==void 0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"SGST"}),e.jsx(s,{children:o(l.taxBreakup.sgst)})]})]}),l.roundOff!==void 0&&l.roundOff!==0&&e.jsxs(n,{style:t.breakdownRow,children:[e.jsx(s,{children:"Round Off"}),e.jsx(s,{children:o(l.roundOff)})]}),e.jsxs(n,{style:t.breakdownTotal,children:[e.jsx(s,{children:"Grand Total"}),e.jsx(s,{children:o(l.grandTotal||0)})]})]})]}),r.orderId&&e.jsxs(n,{style:t.card,children:[e.jsx(s,{style:t.sectionTitle,children:"Order Reference"}),e.jsxs(s,{style:t.infoText,children:["Order ID: ",r.orderId]})]}),(r.deliveryDetails||r.deliveryMode||r.expectedDeliveryDate)&&e.jsxs(n,{style:t.card,children:[e.jsx(s,{style:t.sectionTitle,children:"Delivery Information"}),e.jsxs(n,{style:{marginTop:4},children:[r.deliveryMode&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Delivery Mode: "}),r.deliveryMode]}),r.expectedDeliveryDate&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Expected Delivery Date: "}),f(r.expectedDeliveryDate)]}),r.deliveryDetails?.personName&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Delivery Person: "}),r.deliveryDetails.personName,r.deliveryDetails.personDesignation&&` (${r.deliveryDetails.personDesignation})`]}),r.deliveryDetails?.personPhone&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Contact: "}),r.deliveryDetails.personPhone]}),r.deliveryDetails?.vehicleType&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Vehicle Type: "}),r.deliveryDetails.vehicleType]}),r.deliveryDetails?.vehicleNumber&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Vehicle Number: "}),r.deliveryDetails.vehicleNumber]}),r.deliveryDetails?.transportMethod&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Transport Method: "}),r.deliveryDetails.transportMethod.replace(/-/g," ")]}),r.deliveryDetails?.awbNumber&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"AWB/Tracking Number: "}),r.deliveryDetails.awbNumber]}),r.deliveryDetails?.transportServiceName&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Transport Service: "}),r.deliveryDetails.transportServiceName]}),r.deliveryDetails?.courierName&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Courier: "}),r.deliveryDetails.courierName]}),r.deliveryDetails?.deliveryNotes&&e.jsxs(s,{style:[t.infoText,{marginTop:4}],children:[e.jsx(s,{style:t.bold,children:"Delivery Notes: "}),`
`,r.deliveryDetails.deliveryNotes]})]})]}),r.payment&&e.jsxs(n,{style:[t.section,{marginTop:12,padding:8,backgroundColor:"#F3F4F6"}],children:[e.jsx(s,{style:[t.heading,{fontSize:10,marginBottom:6}],children:"ðŸ’³ Payment Information"}),r.payment.isPaid?e.jsxs(n,{children:[e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Status: "}),e.jsx(s,{style:{color:"#10B981"},children:"Paid"})]}),r.payment.receivedMethodLabel&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Payment Received Via: "}),r.payment.receivedMethodLabel]}),r.payment.receivedTransactionId&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Transaction ID: "}),r.payment.receivedTransactionId]}),r.payment.receivedReference&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Reference: "}),r.payment.receivedReference]}),r.payment.receivedAt&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Received At: "}),f(r.payment.receivedAt)]}),r.payment.receivedBy?.name&&e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Received By: "}),r.payment.receivedBy.name,r.payment.receivedBy.type==="employee"&&e.jsx(s,{style:{fontSize:7,color:"#6B7280"},children:" (Employee)"})]}),r.payment.receivedNotes&&e.jsxs(s,{style:[t.infoText,{marginTop:4}],children:[e.jsx(s,{style:t.bold,children:"Notes: "}),r.payment.receivedNotes]})]}):e.jsxs(s,{style:t.infoText,children:[e.jsx(s,{style:t.bold,children:"Status: "}),e.jsx(s,{style:{color:"#F59E0B"},children:"Pending"})]}),r.payment.mode&&e.jsxs(s,{style:[t.infoText,{marginTop:4}],children:[e.jsx(s,{style:t.bold,children:"Original Payment Mode: "}),r.payment.mode]})]}),e.jsxs(n,{style:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6,marginTop:12,paddingTop:8,borderTopWidth:1,borderTopColor:"#E5E7EB"},children:[e.jsx(D,{src:"/assets/flyp_logo.png",style:{width:24,height:24,opacity:.8},cache:!1}),e.jsxs(s,{style:t.footer,children:["Powered by FLYP Â· ",f(new Date().toISOString())]})]})]})})};export{R as D};
