import{httpsCallable as l}from"./index.esm-Bux_mLJ0.js";import{w as h}from"./index-DRC3F7i0.js";const i=l(h,"fetchIndiaLocationData"),s={states:null,districts:new Map,cities:new Map,cacheTime:new Map,CACHE_DURATION:360*60*1e3},o=t=>{const r=s.cacheTime.get(t);return r?Date.now()-r<s.CACHE_DURATION:!1},w=async()=>{if(s.states&&o("states"))return s.states;try{const t=await i({type:"states"});if(!t?.data?.success||!Array.isArray(t?.data?.data))throw console.error("Invalid response structure:",t?.data),new Error("Invalid response from Cloud Function");const r=t.data.data,e=r.filter(a=>a&&a.id&&a.name);if(e.length===0)throw console.error("No valid states in response:",r),new Error("No valid states found in response");return s.states=e,s.cacheTime.set("states",Date.now()),e}catch(t){return console.error("Error fetching states:",t),[]}},u=async t=>{if(!t)return[];const r=`districts_${t}`;if(s.districts.has(t)&&o(r))return s.districts.get(t);try{const e=await i({type:"districts",stateId:t});if(!e?.data?.success||!Array.isArray(e?.data?.data))return console.error("Invalid response structure for districts:",e?.data),[];const c=e.data.data.filter(n=>n&&n.id&&n.name).map(n=>({...n,stateId:t.toUpperCase()}));return c.length>0&&(s.districts.set(t,c),s.cacheTime.set(r,Date.now())),c}catch(e){return console.error(`Error fetching districts for state ${t}:`,e),[]}},y=async(t,r)=>{if(!t||!r)return[];const e=`cities_${t}`;if(s.cities.has(t)&&o(e))return s.cities.get(t);try{const c=(await i({type:"cities",districtId:t,stateId:r}))?.data?.data||[];return s.cities.set(t,c),s.cacheTime.set(e,Date.now()),c}catch(a){return console.error(`Error fetching cities for district ${t}:`,a),[]}},A=async t=>{if(!Array.isArray(t)||t.length===0)return[];const r=[];for(const e of t){const a=await u(e);r.push(...a)}return r},m=async(t,r)=>{if(!Array.isArray(t)||t.length===0)return[];const e=Array.isArray(r)?r:r?[r]:[],a=[];for(const c of t){const n=e.length>0?e[0]:null,f=await y(c,n);a.push(...f)}return a};export{A as a,m as b,u as c,w as f};
