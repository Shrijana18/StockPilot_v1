import{l as f,j as e,d as g}from"./index-DRC3F7i0.js";import{u as w,b as j,r as o}from"./router-BPBaD_i0.js";import{e as v,d as y}from"./firebase-DWi1MSv1.js";import{W as N}from"./whatsappService-BELSGllU.js";import{m}from"./proxy-BgUy8BPw.js";import"./vendor-Ckhrjn13.js";import"./index.esm-Bux_mLJ0.js";import"./whatsappConfig-B767RKqS.js";const T=()=>{const a=w(),[u]=j(),[h,x]=o.useState(!0),[b,p]=o.useState(!1),r=f.currentUser?.uid,n=u.get("returnUrl")||"/distributor-dashboard?tab=profile&section=whatsapp";o.useEffect(()=>{(async()=>{if(!r){setTimeout(()=>a(n),2e3);return}try{const s=new URLSearchParams(window.location.search),c=s.get("waba_id");if(s.get("pending")==="true"&&c)try{const t=getFunctions(void 0,"us-central1"),i=await httpsCallable(t,"detectNewWABA")();i.data?.found&&i.data?.wabaId===c&&console.log("WABA matched and saved:",i.data)}catch(t){console.warn("Could not match pending WABA:",t)}await new Promise(t=>setTimeout(t,2e3));const d=await v(y(g,"businesses",r));if(d.exists()){const t=d.data();t.whatsappEnabled&&(t.whatsappProvider===N.META||t.whatsappProvider==="meta_tech_provider")&&p(!0)}}catch(s){console.error("Error verifying connection:",s)}finally{x(!1)}})()},[r,a,n]);const l=()=>{a(n)};return h?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-emerald-500 border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Verifying connection..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:e.jsx(m.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-slate-800/90 backdrop-blur-md rounded-2xl shadow-2xl max-w-md w-full p-8 border border-emerald-500/30",children:b?e.jsxs(e.Fragment,{children:[e.jsxs(m.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",duration:.5},className:"text-center mb-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:"‚úÖ"}),e.jsx("h2",{className:"text-2xl font-bold text-emerald-400 mb-2",children:"Successfully Connected!"}),e.jsx("p",{className:"text-gray-300",children:"Your WhatsApp Business API is now connected and ready to use."})]}),e.jsxs("div",{className:"bg-emerald-900/20 border border-emerald-500/30 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-sm text-emerald-200 font-medium mb-2",children:"üöÄ Unlocked Features:"}),e.jsxs("ul",{className:"text-xs text-gray-300 space-y-1",children:[e.jsx("li",{children:"‚úÖ Automated message sending"}),e.jsx("li",{children:"‚úÖ Real-time status tracking"}),e.jsx("li",{children:"‚úÖ Rich media support"}),e.jsx("li",{children:"‚úÖ Message templates"}),e.jsx("li",{children:"‚úÖ Two-way communication"}),e.jsx("li",{children:"‚úÖ Webhook integration"})]})]}),e.jsx("button",{onClick:l,className:"w-full py-3 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white font-bold rounded-lg transition-all",children:"Continue to Dashboard ‚Üí"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-5xl mb-4",children:"‚è≥"}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Processing Connection..."}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Please wait while we verify your connection."})]}),e.jsx("button",{onClick:l,className:"w-full py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Go to Dashboard"})]})})})};export{T as default};
