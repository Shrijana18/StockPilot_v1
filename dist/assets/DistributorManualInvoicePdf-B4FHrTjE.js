import{j as e}from"./index-DRC3F7i0.js";import{R as H}from"./router-BPBaD_i0.js";import{D as O,P as _,S as q,V as n,T as s,I as Z}from"./FileSaver.min-DVuNBBJs.js";import{s as E}from"./pricing-SUVGnFgL.js";function X(t){try{const i=Math.round(Number(t||0));if(!isFinite(i))return"Zero";const l=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],d=c=>c?c+" ":"",h=c=>c<20?l[c]:b[Math.floor(c/10)]+(c%10?" "+l[c%10]:""),y=c=>{const z=Math.floor(c/100),g=c%100;return(z?l[z]+" Hundred"+(g?" ":""):"")+(g?h(g):"")};let u="",N=Math.floor(i/1e7),x=i%1e7,S=Math.floor(x/1e5);x=x%1e5;let T=Math.floor(x/1e3);x=x%1e3;let C=x;return N&&(u+=d(y(N))+"Crore "),S&&(u+=d(y(S))+"Lakh "),T&&(u+=d(y(T))+"Thousand "),C&&(u+=y(C)),u.trim()||"Zero"}catch{return"Zero"}}const r=q.create({page:{padding:30,fontSize:8,fontFamily:"Helvetica",color:"#111827",backgroundColor:"#FFFFFF"},header:{marginBottom:12,paddingBottom:10,borderBottomWidth:2,borderBottomColor:"#E5E7EB"},heading:{fontSize:20,fontWeight:700,marginBottom:3,color:"#111827"},invoiceMeta:{fontSize:7,color:"#6B7280",marginTop:2,lineHeight:1.3},sectionTitle:{fontSize:9,fontWeight:700,marginBottom:5,textTransform:"uppercase",letterSpacing:.3,color:"#374151"},card:{borderWidth:1,borderColor:"#E5E7EB",borderRadius:6,padding:8,marginBottom:8,backgroundColor:"#FAFAFA"},row:{flexDirection:"row",justifyContent:"space-between",gap:8},infoText:{fontSize:8,lineHeight:1.4,color:"#374151",marginBottom:2},table:{marginTop:6,borderWidth:1,borderColor:"#E5E7EB",borderRadius:4,overflow:"hidden",backgroundColor:"#FFFFFF"},tableHeader:{flexDirection:"row",backgroundColor:"#F3F4F6",borderBottomWidth:1,borderBottomColor:"#E5E7EB",alignItems:"center"},tableRow:{flexDirection:"row",borderBottomWidth:.5,borderBottomColor:"#F3F4F6",backgroundColor:"#FFFFFF",alignItems:"center"},th:{fontWeight:700,fontSize:7,padding:4,paddingVertical:6,color:"#374151",textAlign:"left"},td:{fontSize:7,padding:4,paddingVertical:4,color:"#111827",lineHeight:1.3,textAlign:"left"},tdRight:{fontSize:7,padding:4,paddingVertical:4,color:"#111827",lineHeight:1.3,textAlign:"right"},bold:{fontWeight:700},breakdownRow:{flexDirection:"row",justifyContent:"space-between",fontSize:7,marginBottom:2,paddingVertical:1},breakdownTotal:{flexDirection:"row",justifyContent:"space-between",fontSize:9,fontWeight:700,marginTop:4,paddingTop:4,borderTopWidth:1,borderTopColor:"#E5E7EB",color:"#111827"},footer:{marginTop:12,paddingTop:8,borderTopWidth:1,borderTopColor:"#E5E7EB",textAlign:"center",fontSize:7,color:"#6B7280"},grandTotalBox:{backgroundColor:"#ECFDF5",borderWidth:1,borderColor:"#10B981",borderRadius:4,padding:8,marginTop:8},taxSummary:{marginTop:8,padding:8,backgroundColor:"#FAFAFA",borderWidth:1,borderColor:"#E5E7EB",borderRadius:4},taxSummaryTitle:{fontSize:10,fontWeight:700,marginBottom:6,color:"#111827"},taxSummaryRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:3,fontSize:8},taxSummaryTotal:{flexDirection:"row",justifyContent:"space-between",marginTop:4,paddingTop:4,borderTopWidth:1,borderTopColor:"#D1D5DB",fontSize:10,fontWeight:700},twoColumn:{flexDirection:"row",gap:8},column:{flex:1}}),a=t=>`₹${Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,Y=t=>{if(!t)return null;if(t instanceof Date)return t;if(typeof t=="number")return new Date(t);if(typeof t=="string"){const i=new Date(t);return Number.isNaN(i.getTime())?null:i}return t?.seconds?new Date(t.seconds*1e3):t?.toDate?t.toDate():null},W=t=>{const i=Y(t);return i?i.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A"},G=t=>{const i=t.pricingMode||"LEGACY",l=Number(t.basePrice||0),b=Number(t.mrp||0),d=Number(t.sellingPrice||t.price||t.unitPrice||0),h=Number(t.gstRate||t.taxRate||0);return i==="MRP_INCLUSIVE"?b>0&&h>0?E(b,h).base:b||d:i==="SELLING_PRICE"||i==="BASE_PLUS_GST"?d>0&&h>0?E(d,h).base:d:i==="BASE_PLUS_TAX"?l>0?l:d>0&&h>0?E(d,h).base:d:l||d},ee=({invoice:t={}})=>{const i=Array.isArray(t.items)?t.items:Array.isArray(t.cartItems)?t.cartItems:[],l=t.totals||{},b=l.taxType==="IGST";let d=0,h=0,y=0,u=0,N=0;i.forEach(o=>{const R=Number(o.quantity||o.qty||1);Number(o.sellingPrice||o.price||o.unitPrice||0);const w=Number(o.gstRate||o.taxRate||0),p=G(o),k=Number(o.discount||o.discountPct||0),f=Number(o.discountAmount||0),m=p,F=f>0?f/R:m*(k/100),D=(m-F)*R,j=D*(w/100);u+=D,N+=f>0?f:m*R*(k/100),b?y+=j:(d+=j/2,h+=j/2)});const x=l.taxBreakup?.cgst>0?l.taxBreakup.cgst:d,S=l.taxBreakup?.sgst>0?l.taxBreakup.sgst:h,T=l.taxBreakup?.igst>0?l.taxBreakup.igst:y,C=x+S+T,c=l.itemsSubTotal||l.taxableBase||u,z=l.lineDiscountTotal||l.discountTotal||N;let g="Pending";const P=t.payment||{};if(typeof P.isPaid=="boolean")g=P.isPaid?"Paid":"Pending";else{const o=P.status||t.paymentStatus||t.isPaid;o===!0||o==="Paid"||o==="paid"?g="Paid":(o===!1||o==="Pending"||o==="pending")&&(g="Pending")}return e.jsx(O,{title:t.invoiceNumber||t.id||"Invoice",children:e.jsxs(_,{size:"A4",style:r.page,wrap:!0,children:[e.jsxs(n,{style:r.header,children:[e.jsx(s,{style:r.heading,children:"TAX INVOICE"}),e.jsxs(n,{style:r.row,children:[e.jsxs(n,{style:{flex:1},children:[e.jsxs(s,{style:r.invoiceMeta,children:[e.jsx(s,{style:r.bold,children:"Invoice No: "}),t.invoiceNumber||t.invoiceId||t.id||"N/A"]}),e.jsxs(s,{style:r.invoiceMeta,children:[e.jsx(s,{style:r.bold,children:"Date: "}),W(t.issuedAt||t.createdAt)]}),e.jsxs(s,{style:r.invoiceMeta,children:[e.jsx(s,{style:r.bold,children:"Status: "}),g]})]}),e.jsx(n,{style:{flex:1,alignItems:"flex-end"},children:e.jsxs(n,{style:r.grandTotalBox,children:[e.jsx(s,{style:[r.sectionTitle,{fontSize:8,marginBottom:4}],children:"Grand Total"}),e.jsx(s,{style:[r.infoText,r.bold,{fontSize:16,color:"#059669"}],children:a(l.grandTotal||t.totalAmount||0)})]})})]})]}),e.jsxs(n,{style:r.row,children:[e.jsxs(n,{style:[r.card,{flex:1}],children:[e.jsx(s,{style:r.sectionTitle,children:"Bill To (Buyer)"}),e.jsx(s,{style:r.infoText,children:t.buyer?.businessName||t.customer?.name||t.customer?.businessName||"N/A"}),(t.buyer?.email||t.customer?.email)&&e.jsxs(s,{style:r.infoText,children:["Email: ",t.buyer?.email||t.customer?.email]}),(t.buyer?.phone||t.customer?.phone)&&e.jsxs(s,{style:r.infoText,children:["Phone: ",t.buyer?.phone||t.customer?.phone]}),(t.buyer?.city||t.customer?.city||t.buyer?.state||t.customer?.state)&&e.jsx(s,{style:r.infoText,children:[t.buyer?.city||t.customer?.city,t.buyer?.state||t.customer?.state].filter(Boolean).join(", ")}),(t.buyer?.address||t.customer?.address)&&e.jsx(s,{style:r.infoText,children:t.buyer?.address||t.customer?.address})]}),e.jsxs(n,{style:[r.card,{flex:1}],children:[e.jsx(s,{style:r.sectionTitle,children:"Sold By (Seller)"}),e.jsx(s,{style:r.infoText,children:t.seller?.businessName||"N/A"}),t.seller?.email&&e.jsxs(s,{style:r.infoText,children:["Email: ",t.seller.email]}),t.seller?.phone&&e.jsxs(s,{style:r.infoText,children:["Phone: ",t.seller.phone]}),t.seller?.gstNumber&&e.jsxs(s,{style:r.infoText,children:["GST: ",t.seller.gstNumber]}),(t.seller?.city||t.seller?.state)&&e.jsx(s,{style:r.infoText,children:[t.seller?.city,t.seller?.state].filter(Boolean).join(", ")}),t.seller?.address&&e.jsx(s,{style:r.infoText,children:t.seller.address})]})]}),e.jsxs(n,{style:r.card,children:[e.jsx(s,{style:r.sectionTitle,children:"PRODUCTS"}),i.length===0?e.jsx(s,{style:r.infoText,children:"No items available."}):e.jsxs(n,{style:r.table,children:[e.jsxs(n,{style:r.tableHeader,children:[e.jsx(s,{style:[r.th,{flex:2.8}],children:"Name"}),e.jsx(s,{style:[r.th,{flex:1}],children:"Unit"}),e.jsx(s,{style:[r.th,{flex:.6,textAlign:"right"}],children:"Qty"}),e.jsx(s,{style:[r.th,{flex:1.2,textAlign:"right"}],children:"Unit (Net)"}),e.jsx(s,{style:[r.th,{flex:.8,textAlign:"right"}],children:"Discount"}),e.jsx(s,{style:[r.th,{flex:1,textAlign:"right"}],children:"Net"}),e.jsx(s,{style:[r.th,{flex:.8,textAlign:"right"}],children:"GST %"}),e.jsx(s,{style:[r.th,{flex:.8,textAlign:"right"}],children:"Tax"}),e.jsx(s,{style:[r.th,{flex:1,textAlign:"right"}],children:"Total"})]}),i.map((o,R)=>{const w=Number(o.quantity||o.qty||1);Number(o.sellingPrice||o.price||o.unitPrice||0);const p=Number(o.gstRate||o.taxRate||0),k=G(o),f=Number(o.discount||o.discountPct||0),m=Number(o.discountAmount||0),F=k,D=m>0?m/w:F*(f/100),j=(F-D)*w,A=j*(p/100),M=j+A,B=l.taxType==="IGST",I=B?0:p/2,$=B?0:p/2,L=B?0:A/2,V=B?0:A/2,U=B?A:0;return e.jsxs(H.Fragment,{children:[e.jsxs(n,{style:r.tableRow,children:[e.jsx(s,{style:[r.td,{flex:2.8}],children:o.productName||o.name||"N/A"}),e.jsx(s,{style:[r.td,{flex:1}],children:o.unit||o.packSize||"—"}),e.jsx(s,{style:[r.tdRight,{flex:.6}],children:w}),e.jsx(s,{style:[r.tdRight,{flex:1.2}],children:a(F)}),e.jsx(s,{style:[r.tdRight,{flex:.8}],children:m>0?a(m):f>0?`${f}%`:"—"}),e.jsx(s,{style:[r.tdRight,{flex:1}],children:a(j)}),e.jsx(s,{style:[r.tdRight,{flex:.8}],children:p>0?`${p.toFixed(2).replace(/\.00$/,"")}%`:"—"}),e.jsx(s,{style:[r.tdRight,{flex:.8}],children:a(A)}),e.jsx(s,{style:[r.tdRight,{flex:1}],children:a(M)})]}),e.jsxs(n,{style:[r.tableRow,{backgroundColor:"#F9FAFB",paddingVertical:2}],children:[e.jsx(s,{style:[r.td,{flex:2.8,fontSize:6,color:"#6B7280"}]}),e.jsx(s,{style:[r.td,{flex:1,fontSize:6,color:"#6B7280"}]}),e.jsx(s,{style:[r.tdRight,{flex:6.2,fontSize:6,color:"#6B7280"}],children:B?`IGST ${I.toFixed(2).replace(/\.00$/,"")}% = ${a(U)}`:`CGST ${I.toFixed(2).replace(/\.00$/,"")}% = ${a(L)} • SGST ${$.toFixed(2).replace(/\.00$/,"")}% = ${a(V)}`})]})]},R)})]})]}),e.jsxs(n,{style:r.taxSummary,children:[e.jsx(s,{style:r.taxSummaryTitle,children:"Tax Summary"}),e.jsxs(n,{style:{alignItems:"flex-end"},children:[e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"Net Subtotal:"}),e.jsx(s,{style:{fontSize:8},children:a(c)})]}),e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"Total Discount:"}),e.jsx(s,{style:{fontSize:8},children:a(z)})]}),e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"Total Tax:"}),e.jsx(s,{style:{fontSize:8},children:a(C)})]}),x>0&&e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"CGST:"}),e.jsx(s,{style:{fontSize:8},children:a(x)})]}),S>0&&e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"SGST:"}),e.jsx(s,{style:{fontSize:8},children:a(S)})]}),T>0&&e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"IGST:"}),e.jsx(s,{style:{fontSize:8},children:a(T)})]}),(l.delivery||l.orderCharges?.delivery||0)>0&&e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"Delivery:"}),e.jsx(s,{style:{fontSize:8},children:a(l.delivery||l.orderCharges?.delivery||0)})]}),(l.packing||l.orderCharges?.packing||0)>0&&e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"Packing:"}),e.jsx(s,{style:{fontSize:8},children:a(l.packing||l.orderCharges?.packing||0)})]}),(l.insurance||l.orderCharges?.insurance||0)>0&&e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"Insurance:"}),e.jsx(s,{style:{fontSize:8},children:a(l.insurance||l.orderCharges?.insurance||0)})]}),(l.other||l.orderCharges?.other||0)>0&&e.jsxs(n,{style:r.taxSummaryRow,children:[e.jsx(s,{style:{fontSize:8,color:"#6B7280",marginRight:12},children:"Other:"}),e.jsx(s,{style:{fontSize:8},children:a(l.other||l.orderCharges?.other||0)})]}),e.jsx(n,{style:{height:1,backgroundColor:"#D1D5DB",marginVertical:4,width:"100%"}}),e.jsxs(n,{style:r.taxSummaryTotal,children:[e.jsx(s,{style:{fontSize:10,fontWeight:700},children:"Grand Total:"}),e.jsx(s,{style:{fontSize:12,fontWeight:700,color:"#059669"},children:a(l.grandTotal||t.totalAmount||0)})]})]}),e.jsxs(s,{style:{fontSize:7,color:"#6B7280",marginTop:6},children:["Payment Mode: ",(t.payment?.mode||t.paymentMode||"N/A").toUpperCase()," | Invoice Type: ",(t.invoiceType||"Tax").charAt(0).toUpperCase()+(t.invoiceType||"Tax").slice(1)]}),g==="Paid"&&t.payment?.paidOn&&e.jsxs(s,{style:{fontSize:7,color:"#10B981",marginTop:2},children:["✅ Paid on: ",W(t.payment.paidOn)," via ",(t.payment.paidVia||t.paidVia||"").toUpperCase()]})]}),e.jsxs(n,{style:[r.row,{marginTop:8}],children:[e.jsxs(n,{style:[r.card,{flex:1,marginRight:4}],children:[e.jsx(s,{style:r.sectionTitle,children:"Bank Details"}),e.jsxs(s,{style:r.infoText,children:[t.seller?.bank?.bankName||t.bank?.bankName||"Bank",t.seller?.bank?.branch||t.bank?.branch?` — ${t.seller?.bank?.branch||t.bank?.branch}`:""]}),(t.seller?.bank?.accountNumber||t.bank?.accountNumber)&&e.jsxs(s,{style:r.infoText,children:["Account: ",t.seller?.bank?.accountNumber||t.bank?.accountNumber]}),(t.seller?.bank?.ifsc||t.bank?.ifsc)&&e.jsxs(s,{style:r.infoText,children:["IFSC: ",t.seller?.bank?.ifsc||t.bank?.ifsc]}),(t.seller?.bank?.accountName||t.bank?.accountName)&&e.jsxs(s,{style:r.infoText,children:["Name: ",t.seller?.bank?.accountName||t.bank?.accountName]})]}),e.jsxs(n,{style:[r.card,{flex:1,marginLeft:4}],children:[e.jsx(s,{style:r.sectionTitle,children:"UPI"}),e.jsx(s,{style:r.infoText,children:t.seller?.payment?.upiId||t.payment?.upiId||"—"})]})]}),e.jsxs(n,{style:[r.row,{marginTop:8}],children:[e.jsxs(n,{style:[r.card,{flex:1,marginRight:4}],children:[e.jsx(s,{style:[r.sectionTitle,{fontSize:8,marginBottom:4}],children:"Amount in Words"}),e.jsxs(s,{style:[r.infoText,{fontSize:9,fontWeight:500}],children:["Rupees ",X(l.grandTotal||t.totalAmount||0)," Only"]})]}),e.jsxs(n,{style:[r.card,{flex:1,marginLeft:4}],children:[e.jsx(s,{style:[r.sectionTitle,{fontSize:8,marginBottom:4}],children:"Authorized Signatory"}),e.jsx(n,{style:{height:20,borderBottomWidth:1,borderBottomColor:"#D1D5DB",marginBottom:4}}),e.jsx(s,{style:[r.infoText,{fontSize:7,color:"#6B7280"}],children:"Seal & Signature"})]})]}),e.jsxs(n,{style:{marginTop:12,paddingTop:8,borderTopWidth:1,borderTopColor:"#E5E7EB",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(n,{style:{flexDirection:"row",alignItems:"center",gap:6},children:[e.jsx(Z,{src:"/assets/flyp_logo.png",style:{width:24,height:24,opacity:.8},cache:!1}),e.jsx(s,{style:r.footer,children:"Powered by FLYP"})]}),e.jsx(s,{style:[r.footer,{fontStyle:"italic"}],children:"Thank you for your business!"})]})]})})};export{ee as D};
