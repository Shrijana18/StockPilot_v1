import{o as be,j as e,d as j,y as x,r as fe,s as ge,u as Ne,g as we}from"./index-DRC3F7i0.js";import{u as ye,r as N,R as je}from"./router-BPBaD_i0.js";import{i as ve,d as k,e as P,c as ke,g as Se,q as Ce,w as Ie,u as ae,r as se,G as Pe,O as Ae,E as De,j as Fe,a as Te,k as Le}from"./firebase-DWi1MSv1.js";import{getFunctions as Ee,httpsCallable as Me}from"./index.esm-Bux_mLJ0.js";import{W as Oe}from"./WhatsAppConnection-C8P9Ymrj.js";import{L as $e}from"./LanguageSwitcher-BHE27wEu.js";import{F as B,a as R,b as Y,c as q,d as A,e as Ue,f as te,g as re,h as ne,i as V,j as Be,k as Re,l as Ye,m as qe,n as ie,o as D,p as le,q as v,r as Ve,s as He,t as We,u as oe,v as Ge,w as Ke,x as ze}from"./index-CprmGC-M.js";import{u as Je}from"./useTranslation-C_4YkXWs.js";import{m as p}from"./proxy-BgUy8BPw.js";import{A as _e}from"./index-DSciU07p.js";import"./vendor-Ckhrjn13.js";import"./whatsappConfig-B767RKqS.js";const Qe=({formData:o,setFormData:F,user:T})=>e.jsx(Oe,{user:T,formData:o,setFormData:F}),ma=()=>{const{t:o}=Je(),{isNativeApp:F}=be(),T=ye(),[a,b]=N.useState({ownerName:"",email:"",phone:"",businessName:"",address:"",city:"",state:"",pincode:"",logoUrl:"",gstNumber:"",businessType:"Retailer",invoicePreference:"Minimal",whatsappAlerts:!1,emailNotifications:!0,smsNotifications:!1,profileVersion:0,lastUpdated:"",businessMode:"Online",flypId:"",bankName:"",bankBranch:"",bankAccountNumber:"",bankIfsc:"",bankAccountName:"",upiId:"",whatsappBusinessAccountId:"",whatsappPhoneNumberId:"",whatsappPhoneNumber:"",whatsappEnabled:!1,whatsappProvider:"",whatsappCreatedVia:"",whatsappPhoneRegistered:!1,whatsappPhoneVerificationStatus:"",cashfreeMerchantId:"",cashfreeOnboardingStatus:"",cashfreeActive:!1}),[f,H]=N.useState("owner"),[L,W]=N.useState(null),[G,E]=N.useState(null),[ce,de]=N.useState(!0),[d,M]=N.useState(!1),[me,C]=N.useState(!1),[O,$]=N.useState(""),[K,U]=N.useState(!1),[w,I]=N.useState(!1),l=ve().currentUser,z=N.useMemo(()=>{const t=[a.ownerName,a.email,a.phone,a.businessName,a.address,a.city,a.state,a.pincode,a.gstNumber,a.flypId,a.logoUrl,a.bankName,a.bankAccountNumber,a.upiId],n=t.filter(r=>r&&(typeof r=="string"?r.trim()!=="":!0)).length;return Math.round(n/t.length*100)},[a]),J=[{id:"owner",label:o("profile.ownerInfo")||"Owner Info",icon:B,color:"from-purple-500 to-pink-500"},{id:"business",label:o("profile.businessDetails")||"Business",icon:R,color:"from-indigo-500 to-blue-500"},{id:"tax",label:"Tax Information",icon:Y,color:"from-orange-500 to-red-500"},{id:"banking",label:"Banking & Payment",icon:q,color:"from-blue-500 to-cyan-500"},{id:"payments",label:"Payment Setup",icon:A,color:"from-teal-500 to-cyan-500"},{id:"whatsapp",label:"WhatsApp Business",icon:Ue,color:"from-green-500 to-emerald-500"},{id:"branding",label:o("profile.branding")||"Branding",icon:te,color:"from-pink-500 to-rose-500"},{id:"notifications",label:"Notifications",icon:re,color:"from-yellow-500 to-orange-500"},{id:"preferences",label:o("profile.preferences")||"Preferences",icon:ne,color:"from-gray-500 to-slate-500"},{id:"account",label:"Delete account",icon:V,color:"from-red-500 to-rose-500"}];N.useEffect(()=>{(async()=>{if(!l)return;const n=k(j,"businesses",l.uid),r=await P(n);if(r.exists()){const s=r.data();b(c=>({...c,...s,ownerName:s.ownerName||s.name||"",email:s.email||l.email||"",bankName:s.bankName?String(s.bankName):"",bankBranch:s.bankBranch?String(s.bankBranch):"",bankAccountNumber:s.bankAccountNumber?String(s.bankAccountNumber):"",bankIfsc:s.bankIfsc?String(s.bankIfsc):"",bankAccountName:s.bankAccountName?String(s.bankAccountName):"",upiId:s.upiId?String(s.upiId):"",city:s.city?String(s.city):"",state:s.state?String(s.state):"",pincode:s.pincode!=null?String(s.pincode):"",address:s.address?String(s.address):"",businessName:s.businessName?String(s.businessName):"",phone:s.phone?String(s.phone):"",gstNumber:s.gstNumber?String(s.gstNumber):"",emailNotifications:s.emailNotifications!==void 0?s.emailNotifications:!0,smsNotifications:s.smsNotifications||!1,whatsappBusinessAccountId:s.whatsappBusinessAccountId||"",whatsappPhoneNumberId:s.whatsappPhoneNumberId||"",whatsappPhoneNumber:s.whatsappPhoneNumber||"",whatsappEnabled:s.whatsappEnabled||!1,whatsappProvider:s.whatsappProvider||"",whatsappCreatedVia:s.whatsappCreatedVia||"",whatsappPhoneRegistered:s.whatsappPhoneRegistered||!1,whatsappPhoneVerificationStatus:s.whatsappPhoneVerificationStatus||"",cashfreeMerchantId:s.cashfreeMerchantId||"",cashfreeOnboardingStatus:s.cashfreeOnboardingStatus||"",cashfreeActive:s.cashfreeActive===!0})),s.logoUrl&&E(s.logoUrl)}de(!1)})()},[l]);const u=t=>{t.stopPropagation();const{name:n,value:r,type:s,checked:c}=t.target;b(s==="checkbox"?i=>({...i,[n]:c}):i=>({...i,[n]:r!=null?String(r):""}))},he=t=>{const n=t.target.files[0];n&&(W(n),E(URL.createObjectURL(n)))},y=async()=>{if(!(!l||d)){M(!0);try{const t=k(j,"businesses",l.uid),n=await P(t);if(!n.exists()){x.error("Profile not found. Please refresh the page."),M(!1);return}const r=n.data();let s=a.logoUrl;if(L){const i=fe(ge,`logos/${l.uid}`);await Ne(i,L),s=await we(i)}const c={ownerName:a.ownerName||"",businessName:a.businessName||"",phone:a.phone||"",address:a.address||"",city:a.city||"",state:a.state||"",pincode:a.pincode||"",gstNumber:a.gstNumber||"",bankName:a.bankName||"",bankBranch:a.bankBranch||"",bankAccountNumber:a.bankAccountNumber||"",bankIfsc:a.bankIfsc||"",bankAccountName:a.bankAccountName||"",upiId:a.upiId||"",logoUrl:s||"",invoicePreference:a.invoicePreference||"Minimal",businessMode:a.businessMode||"Online",whatsappAlerts:a.whatsappAlerts||!1,emailNotifications:a.emailNotifications!==void 0?a.emailNotifications:!0,smsNotifications:a.smsNotifications||!1,profileVersion:(a.profileVersion||0)+1,lastUpdated:new Date().toISOString(),name:a.ownerName||""};r.ownerId&&(c.ownerId=r.ownerId),r.email&&(c.email=r.email),r.businessType&&(c.businessType=r.businessType),r.role&&(c.role=r.role),r.flypId&&(c.flypId=r.flypId),await ae(t,c),L&&(b(i=>({...i,logoUrl:s})),E(s)),W(null),b(i=>({...i,profileVersion:c.profileVersion,lastUpdated:c.lastUpdated,logoUrl:c.logoUrl})),x.success("Profile updated successfully!");try{const i=Ee(void 0,"asia-south1");Me(i,"resyncRetailerProfile")().catch(S=>console.warn("[ProfileSync] background resync failed:",S))}catch(i){console.warn("[ProfileSync] init failed:",i)}}catch(t){console.error("Update failed",t);let n="Failed to update profile.";t.code==="permission-denied"?n="Permission denied. Please check your Firestore security rules or contact support.":t.code==="unavailable"?n="Service temporarily unavailable. Please try again.":t.message&&(n=`Failed to update profile: ${t.message}`),x.error(n)}finally{M(!1)}}},ue=async()=>{if(!l||!window.confirm("Are you sure you want to generate your unique FLYP ID? This cannot be changed later."))return;const n="FLYP-"+Math.random().toString(36).substring(2,8).toUpperCase(),r=ke(j,"businesses");if(!(await Se(Ce(r,Ie("flypId","==",n)))).empty){x.error("Try again. FLYP ID already exists.");return}const c=k(j,"businesses",l.uid);await ae(c,{flypId:n}),b(i=>({...i,flypId:n})),x.success("âœ… Your FLYP ID has been created!")},pe=async()=>{if(!(O!=="DELETE"||!l)){U(!0);try{const t=l.providerData?.[0]?.providerId;if(t==="google.com")await se(l,new Pe);else if(t==="apple.com")await se(l,new Ae("apple.com"));else{const n=window.prompt("Enter your password to confirm account deletion:");if(!n){U(!1);return}const r=De.credential(l.email,n);await Fe(l,r)}await Te(k(j,"businesses",l.uid)),await Le(l),x.success("Account deleted."),T("/",{replace:!0}),window.location.reload()}catch(t){console.error("Delete account error:",t),x.error(t?.message||"Could not delete account. Try again.")}finally{U(!1),C(!1),$("")}}};if(ce)return e.jsx("div",{className:"flex items-center justify-center p-8 min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),e.jsx("p",{className:"text-white",children:o("profile.loadingProfile")||"Loading profile..."})]})});const m=je.memo(({label:t,name:n,type:r="text",value:s,onChange:c,placeholder:i,icon:g,required:S=!1,disabled:_=!1,rows:Q})=>{const X=s!=null?String(s):"",Z=S?X.trim()!=="":!0,xe=Q?"textarea":"input",ee=`field-${n}`;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:ee,className:"flex items-center gap-2 text-sm font-medium text-gray-300 cursor-pointer",children:[g&&e.jsx(g,{className:"w-4 h-4 text-emerald-400"}),t,S&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(xe,{id:ee,name:n,type:r,value:X,onChange:c,placeholder:i,disabled:_,rows:Q,autoComplete:"off",className:`w-full bg-slate-800/80 border ${Z?"border-white/10":"border-red-500/50"} text-white placeholder-gray-500 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all ${_?"opacity-60 cursor-not-allowed":"cursor-text"}`}),S&&!Z&&e.jsxs("p",{className:"text-xs text-red-400 flex items-center gap-1",children:[e.jsx(Be,{className:"w-3 h-3"}),"This field is required"]})]})});m.displayName="FormField";const h=F||typeof window<"u"&&window.innerWidth<1024;return e.jsxs("div",{className:`w-full max-w-7xl mx-auto space-y-4 ${h?"p-3 pb-8":"p-4 sm:p-6 lg:p-8 space-y-6"}`,children:[e.jsxs(p.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`flex flex-col ${h?"gap-2":"md:flex-row md:items-center md:justify-between gap-4"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:`font-bold bg-clip-text text-transparent bg-gradient-to-r from-emerald-400 via-cyan-400 to-teal-400 ${h?"text-xl":"text-3xl"}`,children:o("profile.title")||"Profile Settings"}),e.jsx("p",{className:"text-gray-400 mt-0.5 text-xs sm:text-sm",children:"Manage your retailer profile and preferences"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(p.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-r from-emerald-500/20 via-cyan-500/20 to-teal-500/20 border border-emerald-500/30 rounded-xl px-3 py-2 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-emerald-500/20 rounded-lg",children:e.jsx(Re,{className:"w-4 h-4 text-emerald-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:`font-bold text-white ${h?"text-lg":"text-2xl"}`,children:[z,"%"]}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"Complete"})]}),e.jsx("div",{className:"w-20 bg-slate-800/50 rounded-full h-1 mt-0.5 overflow-hidden",children:e.jsx(p.div,{initial:{width:0},animate:{width:`${z}%`},transition:{duration:.5,ease:"easeOut"},className:"h-full bg-gradient-to-r from-emerald-500 via-cyan-500 to-teal-500 rounded-full"})})]})]})}),e.jsx("div",{className:"px-3 py-1.5 bg-emerald-500/20 border border-emerald-500/30 rounded-lg",children:e.jsx("span",{className:"text-xs text-emerald-300 font-medium",children:"ðŸ› Retailer"})})]})]}),h?e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide -mx-1",children:J.map(t=>{const n=t.icon,r=f===t.id;return e.jsxs("button",{onClick:()=>H(t.id),className:`flex-shrink-0 flex items-center gap-2 px-3 py-2 rounded-xl text-sm font-medium transition ${r?`bg-gradient-to-r ${t.color} text-white`:"bg-white/10 text-gray-300"}`,children:[e.jsx(n,{className:"w-4 h-4"}),t.label]},t.id)})}):null,e.jsxs("div",{className:`grid gap-4 ${h?"grid-cols-1":"grid-cols-1 lg:grid-cols-4 gap-6"}`,children:[!h&&e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"space-y-2 sticky top-4",children:J.map(t=>{const n=t.icon,r=f===t.id;return e.jsxs(p.button,{onClick:()=>H(t.id),whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${r?`bg-gradient-to-r ${t.color} text-white shadow-lg shadow-emerald-500/50`:"bg-slate-800/60 border border-white/10 text-gray-300 hover:bg-slate-700/60"}`,children:[e.jsx(n,{className:`w-5 h-5 ${r?"text-white":"text-gray-400"}`}),e.jsx("span",{className:"font-medium",children:t.label}),r&&e.jsx(p.div,{layoutId:"activeIndicator",className:"ml-auto w-2 h-2 bg-white rounded-full"})]},t.id)})})}),e.jsxs("div",{className:h?"":"lg:col-span-3",children:[e.jsx(_e,{mode:"wait",children:e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},onAnimationComplete:()=>{},children:[f==="account"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl ${h?"p-4":"p-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(V,{className:"w-5 h-5 text-red-400"})}),"Delete account"]})}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Permanently delete your FLYP business account and all associated data. This cannot be undone."}),e.jsx("button",{type:"button",onClick:()=>C(!0),className:"px-4 py-2 rounded-lg border border-red-500/50 text-red-300 hover:bg-red-500/20 transition",children:"Delete my account"})]}),f==="owner"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(B,{className:"w-6 h-6 text-purple-400"})}),o("profile.ownerInformation")||"Owner Information"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:o("profile.ownerName")||"Owner Name",name:"ownerName",value:a.ownerName,onChange:u,placeholder:o("profile.enterOwnerName")||"Enter owner name",icon:B,required:!0}),e.jsx(m,{label:o("profile.emailAddress")||"Email Address",name:"email",type:"email",value:a.email,onChange:u,placeholder:o("profile.enterEmail")||"Enter email address",icon:Ye,required:!0}),e.jsx(m,{label:o("profile.phoneNumber")||"Phone Number",name:"phone",type:"tel",value:a.phone,onChange:u,placeholder:o("profile.enterPhoneNumber")||"Enter phone number",icon:qe,required:!0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-500/20 to-cyan-500/20 border border-emerald-500/30 rounded-xl p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-500/20 rounded-lg",children:e.jsx(ie,{className:"w-5 h-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:["FLYP ID",e.jsx(D,{className:"w-4 h-4 text-emerald-400",title:"Your unique business identifier"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Your unique business identifier"})]})]})}),a.flypId?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{disabled:!0,value:a.flypId?String(a.flypId):"",className:"flex-1 bg-slate-800/80 border border-white/10 text-gray-400 cursor-not-allowed px-4 py-3 rounded-lg"}),e.jsxs("span",{className:"px-4 py-2 bg-emerald-500/20 border border-emerald-500/30 rounded-lg text-emerald-300 text-sm font-medium flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Linked"]})]}):e.jsxs(p.button,{onClick:ue,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-6 py-3 rounded-lg font-medium transition-all flex items-center justify-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5"}),"Generate My FLYP ID"]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs(p.button,{onClick:y,disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-8 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx(v,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]})})]}),f==="business"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg",children:e.jsx(R,{className:"w-6 h-6 text-indigo-400"})}),o("profile.businessDetails")||"Business Details"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:o("profile.businessName")||"Business Name",name:"businessName",value:a.businessName,onChange:u,placeholder:"Enter business name",icon:Ve,required:!0}),e.jsx(m,{label:"Business Type",name:"businessType",value:a.businessType,disabled:!0,icon:R}),e.jsx(m,{label:o("retailers.address")||"Address",name:"address",value:a.address,onChange:u,placeholder:"Enter business address",icon:He,rows:3,required:!0}),e.jsx(m,{label:"City",name:"city",value:a.city,onChange:u,placeholder:"Enter city",icon:We,required:!0}),e.jsx(m,{label:"State",name:"state",value:a.state,onChange:u,placeholder:"Enter state",required:!0}),e.jsx(m,{label:"Pincode",name:"pincode",value:a.pincode,onChange:u,placeholder:"Enter pincode",required:!0}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"invoicePreference",className:"block mb-2 text-sm font-medium text-gray-300 cursor-pointer",children:"Invoice Preference"}),e.jsxs("select",{id:"invoicePreference",name:"invoicePreference",value:a.invoicePreference||"Minimal",onChange:u,className:"w-full bg-slate-800/80 border border-white/10 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent cursor-pointer",children:[e.jsx("option",{value:"Minimal",children:"Minimal"}),e.jsx("option",{value:"Detailed",children:"Detailed"}),e.jsx("option",{value:"Modern",children:"Modern"})]})]}),e.jsx("div",{className:"md:col-span-2 bg-slate-800/60 rounded-xl p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-300 mb-1",children:"Business Mode"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Toggle online/offline status"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.businessMode==="Online",onChange:t=>b(n=>({...n,businessMode:t.target.checked?"Online":"Offline"}))}),e.jsx("div",{className:"w-14 h-7 bg-slate-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-emerald-500 rounded-full peer peer-checked:bg-emerald-500 transition-all"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-white",children:a.businessMode})]})]})})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs(p.button,{onClick:y,disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-8 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx(v,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]})})]}),f==="tax"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500/20 rounded-lg",children:e.jsx(Y,{className:"w-6 h-6 text-orange-400"})}),"Tax Information"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(m,{label:o("profile.gstNumber")||"GST Number",name:"gstNumber",value:a.gstNumber,onChange:u,placeholder:"Enter GST number (15 characters)",icon:Y}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-300 font-medium mb-1",children:"GST Information"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Your GST number is used for tax calculations and invoice generation. Make sure it's accurate."})]})]})})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs(p.button,{onClick:y,disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-8 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx(v,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]})})]}),f==="banking"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(q,{className:"w-6 h-6 text-blue-400"})}),"Banking & Payment"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:"Bank Name",name:"bankName",value:a.bankName,onChange:u,placeholder:"Enter bank name",icon:q}),e.jsx(m,{label:"Bank Branch",name:"bankBranch",value:a.bankBranch,onChange:u,placeholder:"Enter branch name"}),e.jsx(m,{label:"Account Holder Name",name:"bankAccountName",value:a.bankAccountName,onChange:u,placeholder:"Enter account holder name"}),e.jsx(m,{label:"Account Number",name:"bankAccountNumber",value:a.bankAccountNumber,onChange:u,placeholder:"Enter account number",type:"text"}),e.jsx(m,{label:"IFSC Code",name:"bankIfsc",value:a.bankIfsc,onChange:u,placeholder:"Enter IFSC code"}),e.jsx(m,{label:"UPI ID",name:"upiId",value:a.upiId,onChange:u,placeholder:"Enter UPI ID (e.g., yourname@paytm)",icon:A})]}),e.jsx("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-emerald-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-emerald-300 font-medium mb-1",children:"Payment Information"}),e.jsx("p",{className:"text-xs text-gray-400",children:"This information is used for receiving payments from customers. Keep it secure and up-to-date."})]})]})}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs(p.button,{onClick:y,disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-8 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx(v,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]})})]}),f==="payments"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-teal-500/20 rounded-lg",children:e.jsx(A,{className:"w-6 h-6 text-teal-400"})}),"Payment Setup"]})}),e.jsx("div",{className:"bg-teal-500/10 border border-teal-500/30 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-teal-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-teal-300 font-medium mb-1",children:"Cashfree Payments"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Connect your payment gateway so you can accept card and UPI payments. Youâ€™ll complete a short KYC on Cashfreeâ€™s secure page; no login required."})]})]})}),a.cashfreeActive?e.jsx("div",{className:"bg-emerald-500/20 border border-emerald-500/40 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-emerald-500/30 rounded-full",children:e.jsx(le,{className:"w-8 h-8 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white text-lg",children:"Payment gateway active"}),e.jsx("p",{className:"text-sm text-gray-400",children:"You can accept payments. Status is updated automatically."})]})]})}):a.cashfreeMerchantId?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-800/60 rounded-xl p-4 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Status"}),e.jsx("p",{className:"text-white font-medium capitalize",children:a.cashfreeOnboardingStatus||"Pending"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Complete KYC on Cashfree to activate your gateway."})]}),e.jsxs(p.button,{onClick:async()=>{if(!(!l||w)){I(!0);try{const t=await l.getIdToken(),n=await fetch("https://asia-south1-stockpilotv1.cloudfunctions.net/cashfreeCreateMerchantAndOnboardingLinkHttp",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({})}),r=await n.json().catch(()=>({}));if(n.ok&&(r?.success||r?.onboardingLink)){const s=k(j,"businesses",l.uid),c=await P(s);if(c.exists()){const i=c.data();b(g=>({...g,cashfreeMerchantId:i.cashfreeMerchantId||r.merchantId||g.cashfreeMerchantId,cashfreeOnboardingStatus:i.cashfreeOnboardingStatus||r.onboardingStatus||g.cashfreeOnboardingStatus,cashfreeActive:i.cashfreeActive===!0}))}r?.onboardingLink&&window.open(r.onboardingLink,"_blank"),x.success("Open the new tab to complete KYC. Weâ€™ll update status when youâ€™re done.")}else x.error(r?.error||"Could not get setup link.")}catch(t){console.error(t),x.error(t?.message||"Something went wrong.")}finally{I(!1)}}},disabled:w,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:opacity-60",children:[w?e.jsx(oe,{className:"w-5 h-5 animate-spin"}):e.jsx(Ge,{className:"w-5 h-5"}),w?"Openingâ€¦":"Complete KYC (open setup link)"]})]}):e.jsxs(p.button,{onClick:async()=>{if(!(!l||w)){if(!a.email?.trim()){x.error("Please save your email in Owner Info first.");return}I(!0);try{const t=await l.getIdToken(),n=await fetch("https://asia-south1-stockpilotv1.cloudfunctions.net/cashfreeCreateMerchantAndOnboardingLinkHttp",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({})}),r=await n.json().catch(()=>({}));if(n.ok&&(r?.success||r?.onboardingLink)){const s=k(j,"businesses",l.uid),c=await P(s);if(c.exists()){const i=c.data();b(g=>({...g,cashfreeMerchantId:i.cashfreeMerchantId||r.merchantId||g.cashfreeMerchantId,cashfreeOnboardingStatus:i.cashfreeOnboardingStatus||r.onboardingStatus||g.cashfreeOnboardingStatus,cashfreeActive:i.cashfreeActive===!0}))}r?.onboardingLink&&window.open(r.onboardingLink,"_blank"),x.success("Open the new tab to complete setup. Weâ€™ll update status when youâ€™re done.")}else x.error(r?.error||"Could not start setup.")}catch(t){console.error(t),x.error(t?.message||"Something went wrong.")}finally{I(!1)}}},disabled:w,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white px-6 py-4 rounded-xl font-medium flex items-center justify-center gap-3",children:[w?e.jsx(oe,{className:"w-6 h-6 animate-spin"}):e.jsx(A,{className:"w-6 h-6"}),w?"Setting up...":"Connect Cashfree"]})]}),f==="whatsapp"&&e.jsx(Qe,{formData:a,setFormData:b,user:l}),f==="branding"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-pink-500/20 rounded-lg",children:e.jsx(te,{className:"w-6 h-6 text-pink-400"})}),o("profile.branding")||"Branding & Metadata"]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-start",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-2 text-sm font-medium text-gray-300 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-pink-400"}),"Business Logo"]}),e.jsx("input",{type:"file",accept:"image/*",onChange:he,className:"w-full bg-slate-800/80 border border-white/10 text-white placeholder-gray-500 rounded-lg px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent"}),G&&e.jsxs("div",{className:"mt-4",children:[e.jsx("img",{src:G,alt:"Logo Preview",className:"w-32 h-32 rounded-full object-cover ring-4 ring-emerald-500/50 shadow-lg"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Logo Preview"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[a.lastUpdated&&e.jsxs("div",{className:"bg-slate-800/60 rounded-xl p-4 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Last Updated"}),e.jsx("p",{className:"text-white font-medium",children:new Date(a.lastUpdated).toLocaleString()})]}),a.profileVersion>0&&e.jsxs("div",{className:"bg-slate-800/60 rounded-xl p-4 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Profile Version"}),e.jsx("p",{className:"text-white font-medium",children:a.profileVersion})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs(p.button,{onClick:y,disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-8 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx(v,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]})})]}),f==="notifications"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(re,{className:"w-6 h-6 text-yellow-400"})}),"Notifications"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-slate-800/60 rounded-xl p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-300 mb-1",children:"Email Notifications"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Receive notifications via email"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.emailNotifications,onChange:t=>b(n=>({...n,emailNotifications:t.target.checked}))}),e.jsx("div",{className:"w-14 h-7 bg-slate-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-yellow-500 rounded-full peer peer-checked:bg-yellow-500 transition-all"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-white",children:a.emailNotifications?"Enabled":"Disabled"})]})]})}),e.jsx("div",{className:"bg-slate-800/60 rounded-xl p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-300 mb-1",children:"SMS Notifications"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Receive notifications via SMS"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.smsNotifications,onChange:t=>b(n=>({...n,smsNotifications:t.target.checked}))}),e.jsx("div",{className:"w-14 h-7 bg-slate-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-yellow-500 rounded-full peer peer-checked:bg-yellow-500 transition-all"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-white",children:a.smsNotifications?"Enabled":"Disabled"})]})]})}),e.jsx("div",{className:"bg-slate-800/60 rounded-xl p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-300 mb-1",children:"WhatsApp Alerts"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Receive alerts via WhatsApp"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.whatsappAlerts,onChange:t=>b(n=>({...n,whatsappAlerts:t.target.checked}))}),e.jsx("div",{className:"w-14 h-7 bg-slate-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-green-500 rounded-full peer peer-checked:bg-green-500 transition-all"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-white",children:a.whatsappAlerts?"Enabled":"Disabled"})]})]})})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs(p.button,{onClick:y,disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-8 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx(v,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]})})]}),f==="preferences"&&e.jsxs("div",{className:`bg-slate-900/80 border border-white/10 backdrop-blur-md rounded-2xl space-y-4 ${h?"p-4":"p-6 space-y-6"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-500/20 rounded-lg",children:e.jsx(ne,{className:"w-6 h-6 text-gray-400"})}),o("profile.preferences")||"Preferences"]})}),e.jsxs("div",{className:"bg-slate-800/60 rounded-xl p-6 border border-white/10",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(ze,{className:"w-5 h-5 text-emerald-400"}),o("language.changeLanguage")||"Change Language"]}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:o("language.currentLanguage")||"Select your preferred language"}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx($e,{})})]}),e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded-xl p-6 border-white/10",children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2 text-red-300",children:[e.jsx(V,{className:"w-5 h-5"}),"Delete Account"]}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Permanently delete your FLYP business account and all associated data. This cannot be undone."}),e.jsx("button",{type:"button",onClick:()=>C(!0),className:"px-4 py-2 rounded-lg border border-red-500/50 text-red-300 hover:bg-red-500/20 transition",children:"Delete my account"})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs(p.button,{onClick:y,disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 text-white px-8 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx(v,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]})})]})]},f)}),me&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-2xl p-6 max-w-md w-full shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Delete Account"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["This will permanently delete your account and data. Type ",e.jsx("strong",{className:"text-red-400",children:"DELETE"})," to confirm."]}),e.jsx("input",{type:"text",value:O,onChange:t=>$(t.target.value),placeholder:"Type DELETE to confirm",className:"w-full px-4 py-3 rounded-lg bg-slate-800 border border-white/10 text-white placeholder-gray-500 mb-4"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{C(!1),$("")},className:"flex-1 py-3 rounded-lg border border-white/20 text-white hover:bg-white/10 transition",children:"Cancel"}),e.jsx("button",{type:"button",onClick:pe,disabled:O!=="DELETE"||K,className:"flex-1 py-3 rounded-lg bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition",children:K?"Deletingâ€¦":"Delete Account"})]})]})})]})]})]})};export{ma as default};
