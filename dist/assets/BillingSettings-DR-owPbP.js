import{j as s,l as De,d as Ae,y as ne,w as Qa,v as Ja,r as Ka,u as Xa,g as er}from"./index-DRC3F7i0.js";import{r as E,R as tt,c as _t}from"./router-BPBaD_i0.js";import{g as tr,c as sr,e as at,d as Ze,l as sa}from"./firebase-DWi1MSv1.js";import{httpsCallable as ar}from"./index.esm-Bux_mLJ0.js";//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var aa;function b(){return aa.apply(null,arguments)}function rr(e){aa=e}function je(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function rt(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function G(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function bs(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(G(e,t))return!1;return!0}function pe(e){return e===void 0}function We(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Pt(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function ra(e,t){var a=[],r,n=e.length;for(r=0;r<n;++r)a.push(t(e[r],r));return a}function $e(e,t){for(var a in t)G(t,a)&&(e[a]=t[a]);return G(t,"toString")&&(e.toString=t.toString),G(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Ie(e,t,a,r){return Ma(e,t,a,r,!0).utc()}function nr(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function I(e){return e._pf==null&&(e._pf=nr()),e._pf}var ds;Array.prototype.some?ds=Array.prototype.some:ds=function(e){var t=Object(this),a=t.length>>>0,r;for(r=0;r<a;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};function ys(e){var t=null,a=!1,r=e._d&&!isNaN(e._d.getTime());if(r&&(t=I(e),a=ds.call(t.parsedDateParts,function(n){return n!=null}),r=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&a),e._strict&&(r=r&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=r;else return r;return e._isValid}function Vt(e){var t=Ie(NaN);return e!=null?$e(I(t),e):I(t).userInvalidated=!0,t}var qs=b.momentProperties=[],is=!1;function ws(e,t){var a,r,n,i=qs.length;if(pe(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),pe(t._i)||(e._i=t._i),pe(t._f)||(e._f=t._f),pe(t._l)||(e._l=t._l),pe(t._strict)||(e._strict=t._strict),pe(t._tzm)||(e._tzm=t._tzm),pe(t._isUTC)||(e._isUTC=t._isUTC),pe(t._offset)||(e._offset=t._offset),pe(t._pf)||(e._pf=I(t)),pe(t._locale)||(e._locale=t._locale),i>0)for(a=0;a<i;a++)r=qs[a],n=t[r],pe(n)||(e[r]=n);return e}function Tt(e){ws(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),is===!1&&(is=!0,b.updateOffset(this),is=!1)}function _e(e){return e instanceof Tt||e!=null&&e._isAMomentObject!=null}function na(e){b.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function ye(e,t){var a=!0;return $e(function(){if(b.deprecationHandler!=null&&b.deprecationHandler(null,e),a){var r=[],n,i,o,l=arguments.length;for(i=0;i<l;i++){if(n="",typeof arguments[i]=="object"){n+=`
[`+i+"] ";for(o in arguments[0])G(arguments[0],o)&&(n+=o+": "+arguments[0][o]+", ");n=n.slice(0,-2)}else n=arguments[i];r.push(n)}na(e+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),a=!1}return t.apply(this,arguments)},t)}var Zs={};function ia(e,t){b.deprecationHandler!=null&&b.deprecationHandler(e,t),Zs[e]||(na(t),Zs[e]=!0)}b.suppressDeprecationWarnings=!1;b.deprecationHandler=null;function Ce(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function ir(e){var t,a;for(a in e)G(e,a)&&(t=e[a],Ce(t)?this[a]=t:this["_"+a]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function us(e,t){var a=$e({},e),r;for(r in t)G(t,r)&&(rt(e[r])&&rt(t[r])?(a[r]={},$e(a[r],e[r]),$e(a[r],t[r])):t[r]!=null?a[r]=t[r]:delete a[r]);for(r in e)G(e,r)&&!G(t,r)&&rt(e[r])&&(a[r]=$e({},a[r]));return a}function vs(e){e!=null&&this.set(e)}var hs;Object.keys?hs=Object.keys:hs=function(e){var t,a=[];for(t in e)G(e,t)&&a.push(t);return a};var lr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function or(e,t,a){var r=this._calendar[e]||this._calendar.sameElse;return Ce(r)?r.call(t,a):r}function Te(e,t,a){var r=""+Math.abs(e),n=t-r.length,i=e>=0;return(i?a?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+r}var Ns=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ot=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ls={},ht={};function _(e,t,a,r){var n=r;typeof r=="string"&&(n=function(){return this[r]()}),e&&(ht[e]=n),t&&(ht[t[0]]=function(){return Te(n.apply(this,arguments),t[1],t[2])}),a&&(ht[a]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function cr(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function dr(e){var t=e.match(Ns),a,r;for(a=0,r=t.length;a<r;a++)ht[t[a]]?t[a]=ht[t[a]]:t[a]=cr(t[a]);return function(n){var i="",o;for(o=0;o<r;o++)i+=Ce(t[o])?t[o].call(n,e):t[o];return i}}function Ut(e,t){return e.isValid()?(t=la(t,e.localeData()),ls[t]=ls[t]||dr(t),ls[t](e)):e.localeData().invalidDate()}function la(e,t){var a=5;function r(n){return t.longDateFormat(n)||n}for(Ot.lastIndex=0;a>=0&&Ot.test(e);)e=e.replace(Ot,r),Ot.lastIndex=0,a-=1;return e}var ur={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function hr(e){var t=this._longDateFormat[e],a=this._longDateFormat[e.toUpperCase()];return t||!a?t:(this._longDateFormat[e]=a.match(Ns).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[e])}var mr="Invalid date";function fr(){return this._invalidDate}var pr="%d",xr=/\d{1,2}/;function gr(e){return this._ordinal.replace("%d",e)}var br={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function yr(e,t,a,r){var n=this._relativeTime[a];return Ce(n)?n(e,t,a,r):n.replace(/%d/i,e)}function wr(e,t){var a=this._relativeTime[e>0?"future":"past"];return Ce(a)?a(t):a.replace(/%s/i,t)}var Qs={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function we(e){return typeof e=="string"?Qs[e]||Qs[e.toLowerCase()]:void 0}function js(e){var t={},a,r;for(r in e)G(e,r)&&(a=we(r),a&&(t[a]=e[r]));return t}var vr={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Nr(e){var t=[],a;for(a in e)G(e,a)&&t.push({unit:a,priority:vr[a]});return t.sort(function(r,n){return r.priority-n.priority}),t}var oa=/\d/,xe=/\d\d/,ca=/\d{3}/,_s=/\d{4}/,zt=/[+-]?\d{6}/,Q=/\d\d?/,da=/\d\d\d\d?/,ua=/\d\d\d\d\d\d?/,Bt=/\d{1,3}/,Ss=/\d{1,4}/,$t=/[+-]?\d{1,6}/,pt=/\d+/,qt=/[+-]?\d+/,jr=/Z|[+-]\d\d:?\d\d/gi,Zt=/Z|[+-]\d\d(?::?\d\d)?/gi,_r=/[+-]?\d+(\.\d{1,3})?/,It=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,xt=/^[1-9]\d?/,ks=/^([1-9]\d|\d)/,At;At={};function w(e,t,a){At[e]=Ce(t)?t:function(r,n){return r&&a?a:t}}function Sr(e,t){return G(At,e)?At[e](t._strict,t._locale):new RegExp(kr(e))}function kr(e){return Ee(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,a,r,n,i){return a||r||n||i}))}function Ee(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function be(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function O(e){var t=+e,a=0;return t!==0&&isFinite(t)&&(a=be(t)),a}var ms={};function q(e,t){var a,r=t,n;for(typeof e=="string"&&(e=[e]),We(t)&&(r=function(i,o){o[t]=O(i)}),n=e.length,a=0;a<n;a++)ms[e[a]]=r}function Ct(e,t){q(e,function(a,r,n,i){n._w=n._w||{},t(a,n._w,n,i)})}function Mr(e,t,a){t!=null&&G(ms,e)&&ms[e](t,a._a,a,e)}function Qt(e){return e%4===0&&e%100!==0||e%400===0}var de=0,Re=1,Pe=2,ie=3,Ne=4,Le=5,st=6,Dr=7,Pr=8;_("Y",0,0,function(){var e=this.year();return e<=9999?Te(e,4):"+"+e});_(0,["YY",2],0,function(){return this.year()%100});_(0,["YYYY",4],0,"year");_(0,["YYYYY",5],0,"year");_(0,["YYYYYY",6,!0],0,"year");w("Y",qt);w("YY",Q,xe);w("YYYY",Ss,_s);w("YYYYY",$t,zt);w("YYYYYY",$t,zt);q(["YYYYY","YYYYYY"],de);q("YYYY",function(e,t){t[de]=e.length===2?b.parseTwoDigitYear(e):O(e)});q("YY",function(e,t){t[de]=b.parseTwoDigitYear(e)});q("Y",function(e,t){t[de]=parseInt(e,10)});function jt(e){return Qt(e)?366:365}b.parseTwoDigitYear=function(e){return O(e)+(O(e)>68?1900:2e3)};var ha=gt("FullYear",!0);function Tr(){return Qt(this.year())}function gt(e,t){return function(a){return a!=null?(ma(this,e,a),b.updateOffset(this,t),this):St(this,e)}}function St(e,t){if(!e.isValid())return NaN;var a=e._d,r=e._isUTC;switch(t){case"Milliseconds":return r?a.getUTCMilliseconds():a.getMilliseconds();case"Seconds":return r?a.getUTCSeconds():a.getSeconds();case"Minutes":return r?a.getUTCMinutes():a.getMinutes();case"Hours":return r?a.getUTCHours():a.getHours();case"Date":return r?a.getUTCDate():a.getDate();case"Day":return r?a.getUTCDay():a.getDay();case"Month":return r?a.getUTCMonth():a.getMonth();case"FullYear":return r?a.getUTCFullYear():a.getFullYear();default:return NaN}}function ma(e,t,a){var r,n,i,o,l;if(!(!e.isValid()||isNaN(a))){switch(r=e._d,n=e._isUTC,t){case"Milliseconds":return void(n?r.setUTCMilliseconds(a):r.setMilliseconds(a));case"Seconds":return void(n?r.setUTCSeconds(a):r.setSeconds(a));case"Minutes":return void(n?r.setUTCMinutes(a):r.setMinutes(a));case"Hours":return void(n?r.setUTCHours(a):r.setHours(a));case"Date":return void(n?r.setUTCDate(a):r.setDate(a));case"FullYear":break;default:return}i=a,o=e.month(),l=e.date(),l=l===29&&o===1&&!Qt(i)?28:l,n?r.setUTCFullYear(i,o,l):r.setFullYear(i,o,l)}}function Ir(e){return e=we(e),Ce(this[e])?this[e]():this}function Cr(e,t){if(typeof e=="object"){e=js(e);var a=Nr(e),r,n=a.length;for(r=0;r<n;r++)this[a[r].unit](e[a[r].unit])}else if(e=we(e),Ce(this[e]))return this[e](t);return this}function Yr(e,t){return(e%t+t)%t}var te;Array.prototype.indexOf?te=Array.prototype.indexOf:te=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Ms(e,t){if(isNaN(e)||isNaN(t))return NaN;var a=Yr(t,12);return e+=(t-a)/12,a===1?Qt(e)?29:28:31-a%7%2}_("M",["MM",2],"Mo",function(){return this.month()+1});_("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});_("MMMM",0,0,function(e){return this.localeData().months(this,e)});w("M",Q,xt);w("MM",Q,xe);w("MMM",function(e,t){return t.monthsShortRegex(e)});w("MMMM",function(e,t){return t.monthsRegex(e)});q(["M","MM"],function(e,t){t[Re]=O(e)-1});q(["MMM","MMMM"],function(e,t,a,r){var n=a._locale.monthsParse(e,r,a._strict);n!=null?t[Re]=n:I(a).invalidMonth=e});var Or="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),fa="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),pa=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Fr=It,Ur=It;function Rr(e,t){return e?je(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||pa).test(t)?"format":"standalone"][e.month()]:je(this._months)?this._months:this._months.standalone}function Lr(e,t){return e?je(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[pa.test(t)?"format":"standalone"][e.month()]:je(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Ar(e,t,a){var r,n,i,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=Ie([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return a?t==="MMM"?(n=te.call(this._shortMonthsParse,o),n!==-1?n:null):(n=te.call(this._longMonthsParse,o),n!==-1?n:null):t==="MMM"?(n=te.call(this._shortMonthsParse,o),n!==-1?n:(n=te.call(this._longMonthsParse,o),n!==-1?n:null)):(n=te.call(this._longMonthsParse,o),n!==-1?n:(n=te.call(this._shortMonthsParse,o),n!==-1?n:null))}function Er(e,t,a){var r,n,i;if(this._monthsParseExact)return Ar.call(this,e,t,a);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(n=Ie([2e3,r]),a&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),!a&&!this._monthsParse[r]&&(i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),a&&t==="MMMM"&&this._longMonthsParse[r].test(e))return r;if(a&&t==="MMM"&&this._shortMonthsParse[r].test(e))return r;if(!a&&this._monthsParse[r].test(e))return r}}function xa(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=O(t);else if(t=e.localeData().monthsParse(t),!We(t))return e}var a=t,r=e.date();return r=r<29?r:Math.min(r,Ms(e.year(),a)),e._isUTC?e._d.setUTCMonth(a,r):e._d.setMonth(a,r),e}function ga(e){return e!=null?(xa(this,e),b.updateOffset(this,!0),this):St(this,"Month")}function Gr(){return Ms(this.year(),this.month())}function Wr(e){return this._monthsParseExact?(G(this,"_monthsRegex")||ba.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(G(this,"_monthsShortRegex")||(this._monthsShortRegex=Fr),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Hr(e){return this._monthsParseExact?(G(this,"_monthsRegex")||ba.call(this),e?this._monthsStrictRegex:this._monthsRegex):(G(this,"_monthsRegex")||(this._monthsRegex=Ur),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ba(){function e(p,N){return N.length-p.length}var t=[],a=[],r=[],n,i,o,l;for(n=0;n<12;n++)i=Ie([2e3,n]),o=Ee(this.monthsShort(i,"")),l=Ee(this.months(i,"")),t.push(o),a.push(l),r.push(l),r.push(o);t.sort(e),a.sort(e),r.sort(e),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Vr(e,t,a,r,n,i,o){var l;return e<100&&e>=0?(l=new Date(e+400,t,a,r,n,i,o),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,a,r,n,i,o),l}function kt(e){var t,a;return e<100&&e>=0?(a=Array.prototype.slice.call(arguments),a[0]=e+400,t=new Date(Date.UTC.apply(null,a)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Et(e,t,a){var r=7+t-a,n=(7+kt(e,0,r).getUTCDay()-t)%7;return-n+r-1}function ya(e,t,a,r,n){var i=(7+a-r)%7,o=Et(e,r,n),l=1+7*(t-1)+i+o,p,N;return l<=0?(p=e-1,N=jt(p)+l):l>jt(e)?(p=e+1,N=l-jt(e)):(p=e,N=l),{year:p,dayOfYear:N}}function Mt(e,t,a){var r=Et(e.year(),t,a),n=Math.floor((e.dayOfYear()-r-1)/7)+1,i,o;return n<1?(o=e.year()-1,i=n+Ge(o,t,a)):n>Ge(e.year(),t,a)?(i=n-Ge(e.year(),t,a),o=e.year()+1):(o=e.year(),i=n),{week:i,year:o}}function Ge(e,t,a){var r=Et(e,t,a),n=Et(e+1,t,a);return(jt(e)-r+n)/7}_("w",["ww",2],"wo","week");_("W",["WW",2],"Wo","isoWeek");w("w",Q,xt);w("ww",Q,xe);w("W",Q,xt);w("WW",Q,xe);Ct(["w","ww","W","WW"],function(e,t,a,r){t[r.substr(0,1)]=O(e)});function zr(e){return Mt(e,this._week.dow,this._week.doy).week}var Br={dow:0,doy:6};function $r(){return this._week.dow}function qr(){return this._week.doy}function Zr(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Qr(e){var t=Mt(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}_("d",0,"do","day");_("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});_("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});_("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});_("e",0,0,"weekday");_("E",0,0,"isoWeekday");w("d",Q);w("e",Q);w("E",Q);w("dd",function(e,t){return t.weekdaysMinRegex(e)});w("ddd",function(e,t){return t.weekdaysShortRegex(e)});w("dddd",function(e,t){return t.weekdaysRegex(e)});Ct(["dd","ddd","dddd"],function(e,t,a,r){var n=a._locale.weekdaysParse(e,r,a._strict);n!=null?t.d=n:I(a).invalidWeekday=e});Ct(["d","e","E"],function(e,t,a,r){t[r]=O(e)});function Jr(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Kr(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Ds(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Xr="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),wa="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),en="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),tn=It,sn=It,an=It;function rn(e,t){var a=je(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?Ds(a,this._week.dow):e?a[e.day()]:a}function nn(e){return e===!0?Ds(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function ln(e){return e===!0?Ds(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function on(e,t,a){var r,n,i,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=Ie([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return a?t==="dddd"?(n=te.call(this._weekdaysParse,o),n!==-1?n:null):t==="ddd"?(n=te.call(this._shortWeekdaysParse,o),n!==-1?n:null):(n=te.call(this._minWeekdaysParse,o),n!==-1?n:null):t==="dddd"?(n=te.call(this._weekdaysParse,o),n!==-1||(n=te.call(this._shortWeekdaysParse,o),n!==-1)?n:(n=te.call(this._minWeekdaysParse,o),n!==-1?n:null)):t==="ddd"?(n=te.call(this._shortWeekdaysParse,o),n!==-1||(n=te.call(this._weekdaysParse,o),n!==-1)?n:(n=te.call(this._minWeekdaysParse,o),n!==-1?n:null)):(n=te.call(this._minWeekdaysParse,o),n!==-1||(n=te.call(this._weekdaysParse,o),n!==-1)?n:(n=te.call(this._shortWeekdaysParse,o),n!==-1?n:null))}function cn(e,t,a){var r,n,i;if(this._weekdaysParseExact)return on.call(this,e,t,a);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(n=Ie([2e3,1]).day(r),a&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),a&&t==="dddd"&&this._fullWeekdaysParse[r].test(e))return r;if(a&&t==="ddd"&&this._shortWeekdaysParse[r].test(e))return r;if(a&&t==="dd"&&this._minWeekdaysParse[r].test(e))return r;if(!a&&this._weekdaysParse[r].test(e))return r}}function dn(e){if(!this.isValid())return e!=null?this:NaN;var t=St(this,"Day");return e!=null?(e=Jr(e,this.localeData()),this.add(e-t,"d")):t}function un(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function hn(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Kr(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function mn(e){return this._weekdaysParseExact?(G(this,"_weekdaysRegex")||Ps.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(G(this,"_weekdaysRegex")||(this._weekdaysRegex=tn),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function fn(e){return this._weekdaysParseExact?(G(this,"_weekdaysRegex")||Ps.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(G(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=sn),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function pn(e){return this._weekdaysParseExact?(G(this,"_weekdaysRegex")||Ps.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(G(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=an),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ps(){function e(x,k){return k.length-x.length}var t=[],a=[],r=[],n=[],i,o,l,p,N;for(i=0;i<7;i++)o=Ie([2e3,1]).day(i),l=Ee(this.weekdaysMin(o,"")),p=Ee(this.weekdaysShort(o,"")),N=Ee(this.weekdays(o,"")),t.push(l),a.push(p),r.push(N),n.push(l),n.push(p),n.push(N);t.sort(e),a.sort(e),r.sort(e),n.sort(e),this._weekdaysRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Ts(){return this.hours()%12||12}function xn(){return this.hours()||24}_("H",["HH",2],0,"hour");_("h",["hh",2],0,Ts);_("k",["kk",2],0,xn);_("hmm",0,0,function(){return""+Ts.apply(this)+Te(this.minutes(),2)});_("hmmss",0,0,function(){return""+Ts.apply(this)+Te(this.minutes(),2)+Te(this.seconds(),2)});_("Hmm",0,0,function(){return""+this.hours()+Te(this.minutes(),2)});_("Hmmss",0,0,function(){return""+this.hours()+Te(this.minutes(),2)+Te(this.seconds(),2)});function va(e,t){_(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}va("a",!0);va("A",!1);function Na(e,t){return t._meridiemParse}w("a",Na);w("A",Na);w("H",Q,ks);w("h",Q,xt);w("k",Q,xt);w("HH",Q,xe);w("hh",Q,xe);w("kk",Q,xe);w("hmm",da);w("hmmss",ua);w("Hmm",da);w("Hmmss",ua);q(["H","HH"],ie);q(["k","kk"],function(e,t,a){var r=O(e);t[ie]=r===24?0:r});q(["a","A"],function(e,t,a){a._isPm=a._locale.isPM(e),a._meridiem=e});q(["h","hh"],function(e,t,a){t[ie]=O(e),I(a).bigHour=!0});q("hmm",function(e,t,a){var r=e.length-2;t[ie]=O(e.substr(0,r)),t[Ne]=O(e.substr(r)),I(a).bigHour=!0});q("hmmss",function(e,t,a){var r=e.length-4,n=e.length-2;t[ie]=O(e.substr(0,r)),t[Ne]=O(e.substr(r,2)),t[Le]=O(e.substr(n)),I(a).bigHour=!0});q("Hmm",function(e,t,a){var r=e.length-2;t[ie]=O(e.substr(0,r)),t[Ne]=O(e.substr(r))});q("Hmmss",function(e,t,a){var r=e.length-4,n=e.length-2;t[ie]=O(e.substr(0,r)),t[Ne]=O(e.substr(r,2)),t[Le]=O(e.substr(n))});function gn(e){return(e+"").toLowerCase().charAt(0)==="p"}var bn=/[ap]\.?m?\.?/i,yn=gt("Hours",!0);function wn(e,t,a){return e>11?a?"pm":"PM":a?"am":"AM"}var ja={calendar:lr,longDateFormat:ur,invalidDate:mr,ordinal:pr,dayOfMonthOrdinalParse:xr,relativeTime:br,months:Or,monthsShort:fa,week:Br,weekdays:Xr,weekdaysMin:en,weekdaysShort:wa,meridiemParse:bn},K={},vt={},Dt;function vn(e,t){var a,r=Math.min(e.length,t.length);for(a=0;a<r;a+=1)if(e[a]!==t[a])return a;return r}function Js(e){return e&&e.toLowerCase().replace("_","-")}function Nn(e){for(var t=0,a,r,n,i;t<e.length;){for(i=Js(e[t]).split("-"),a=i.length,r=Js(e[t+1]),r=r?r.split("-"):null;a>0;){if(n=Jt(i.slice(0,a).join("-")),n)return n;if(r&&r.length>=a&&vn(i,r)>=a-1)break;a--}t++}return Dt}function jn(e){return!!(e&&e.match("^[^/\\\\]*$"))}function Jt(e){var t=null,a;if(K[e]===void 0&&typeof module<"u"&&module&&module.exports&&jn(e))try{t=Dt._abbr,a=require,a("./locale/"+e),Qe(t)}catch{K[e]=null}return K[e]}function Qe(e,t){var a;return e&&(pe(t)?a=He(e):a=Is(e,t),a?Dt=a:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Dt._abbr}function Is(e,t){if(t!==null){var a,r=ja;if(t.abbr=e,K[e]!=null)ia("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=K[e]._config;else if(t.parentLocale!=null)if(K[t.parentLocale]!=null)r=K[t.parentLocale]._config;else if(a=Jt(t.parentLocale),a!=null)r=a._config;else return vt[t.parentLocale]||(vt[t.parentLocale]=[]),vt[t.parentLocale].push({name:e,config:t}),null;return K[e]=new vs(us(r,t)),vt[e]&&vt[e].forEach(function(n){Is(n.name,n.config)}),Qe(e),K[e]}else return delete K[e],null}function _n(e,t){if(t!=null){var a,r,n=ja;K[e]!=null&&K[e].parentLocale!=null?K[e].set(us(K[e]._config,t)):(r=Jt(e),r!=null&&(n=r._config),t=us(n,t),r==null&&(t.abbr=e),a=new vs(t),a.parentLocale=K[e],K[e]=a),Qe(e)}else K[e]!=null&&(K[e].parentLocale!=null?(K[e]=K[e].parentLocale,e===Qe()&&Qe(e)):K[e]!=null&&delete K[e]);return K[e]}function He(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Dt;if(!je(e)){if(t=Jt(e),t)return t;e=[e]}return Nn(e)}function Sn(){return hs(K)}function Cs(e){var t,a=e._a;return a&&I(e).overflow===-2&&(t=a[Re]<0||a[Re]>11?Re:a[Pe]<1||a[Pe]>Ms(a[de],a[Re])?Pe:a[ie]<0||a[ie]>24||a[ie]===24&&(a[Ne]!==0||a[Le]!==0||a[st]!==0)?ie:a[Ne]<0||a[Ne]>59?Ne:a[Le]<0||a[Le]>59?Le:a[st]<0||a[st]>999?st:-1,I(e)._overflowDayOfYear&&(t<de||t>Pe)&&(t=Pe),I(e)._overflowWeeks&&t===-1&&(t=Dr),I(e)._overflowWeekday&&t===-1&&(t=Pr),I(e).overflow=t),e}var kn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Mn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Dn=/Z|[+-]\d\d(?::?\d\d)?/,Ft=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],os=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Pn=/^\/?Date\((-?\d+)/i,Tn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,In={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function _a(e){var t,a,r=e._i,n=kn.exec(r)||Mn.exec(r),i,o,l,p,N=Ft.length,x=os.length;if(n){for(I(e).iso=!0,t=0,a=N;t<a;t++)if(Ft[t][1].exec(n[1])){o=Ft[t][0],i=Ft[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(n[3]){for(t=0,a=x;t<a;t++)if(os[t][1].exec(n[3])){l=(n[2]||" ")+os[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(n[4])if(Dn.exec(n[4]))p="Z";else{e._isValid=!1;return}e._f=o+(l||"")+(p||""),Os(e)}else e._isValid=!1}function Cn(e,t,a,r,n,i){var o=[Yn(e),fa.indexOf(t),parseInt(a,10),parseInt(r,10),parseInt(n,10)];return i&&o.push(parseInt(i,10)),o}function Yn(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function On(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Fn(e,t,a){if(e){var r=wa.indexOf(e),n=new Date(t[0],t[1],t[2]).getDay();if(r!==n)return I(a).weekdayMismatch=!0,a._isValid=!1,!1}return!0}function Un(e,t,a){if(e)return In[e];if(t)return 0;var r=parseInt(a,10),n=r%100,i=(r-n)/100;return i*60+n}function Sa(e){var t=Tn.exec(On(e._i)),a;if(t){if(a=Cn(t[4],t[3],t[2],t[5],t[6],t[7]),!Fn(t[1],a,e))return;e._a=a,e._tzm=Un(t[8],t[9],t[10]),e._d=kt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),I(e).rfc2822=!0}else e._isValid=!1}function Rn(e){var t=Pn.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(_a(e),e._isValid===!1)delete e._isValid;else return;if(Sa(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:b.createFromInputFallback(e)}b.createFromInputFallback=ye("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function dt(e,t,a){return e??t??a}function Ln(e){var t=new Date(b.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Ys(e){var t,a,r=[],n,i,o;if(!e._d){for(n=Ln(e),e._w&&e._a[Pe]==null&&e._a[Re]==null&&An(e),e._dayOfYear!=null&&(o=dt(e._a[de],n[de]),(e._dayOfYear>jt(o)||e._dayOfYear===0)&&(I(e)._overflowDayOfYear=!0),a=kt(o,0,e._dayOfYear),e._a[Re]=a.getUTCMonth(),e._a[Pe]=a.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=r[t]=n[t];for(;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[ie]===24&&e._a[Ne]===0&&e._a[Le]===0&&e._a[st]===0&&(e._nextDay=!0,e._a[ie]=0),e._d=(e._useUTC?kt:Vr).apply(null,r),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ie]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(I(e).weekdayMismatch=!0)}}function An(e){var t,a,r,n,i,o,l,p,N;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,o=4,a=dt(t.GG,e._a[de],Mt(Z(),1,4).year),r=dt(t.W,1),n=dt(t.E,1),(n<1||n>7)&&(p=!0)):(i=e._locale._week.dow,o=e._locale._week.doy,N=Mt(Z(),i,o),a=dt(t.gg,e._a[de],N.year),r=dt(t.w,N.week),t.d!=null?(n=t.d,(n<0||n>6)&&(p=!0)):t.e!=null?(n=t.e+i,(t.e<0||t.e>6)&&(p=!0)):n=i),r<1||r>Ge(a,i,o)?I(e)._overflowWeeks=!0:p!=null?I(e)._overflowWeekday=!0:(l=ya(a,r,n,i,o),e._a[de]=l.year,e._dayOfYear=l.dayOfYear)}b.ISO_8601=function(){};b.RFC_2822=function(){};function Os(e){if(e._f===b.ISO_8601){_a(e);return}if(e._f===b.RFC_2822){Sa(e);return}e._a=[],I(e).empty=!0;var t=""+e._i,a,r,n,i,o,l=t.length,p=0,N,x;for(n=la(e._f,e._locale).match(Ns)||[],x=n.length,a=0;a<x;a++)i=n[a],r=(t.match(Sr(i,e))||[])[0],r&&(o=t.substr(0,t.indexOf(r)),o.length>0&&I(e).unusedInput.push(o),t=t.slice(t.indexOf(r)+r.length),p+=r.length),ht[i]?(r?I(e).empty=!1:I(e).unusedTokens.push(i),Mr(i,r,e)):e._strict&&!r&&I(e).unusedTokens.push(i);I(e).charsLeftOver=l-p,t.length>0&&I(e).unusedInput.push(t),e._a[ie]<=12&&I(e).bigHour===!0&&e._a[ie]>0&&(I(e).bigHour=void 0),I(e).parsedDateParts=e._a.slice(0),I(e).meridiem=e._meridiem,e._a[ie]=En(e._locale,e._a[ie],e._meridiem),N=I(e).era,N!==null&&(e._a[de]=e._locale.erasConvertYear(N,e._a[de])),Ys(e),Cs(e)}function En(e,t,a){var r;return a==null?t:e.meridiemHour!=null?e.meridiemHour(t,a):(e.isPM!=null&&(r=e.isPM(a),r&&t<12&&(t+=12),!r&&t===12&&(t=0)),t)}function Gn(e){var t,a,r,n,i,o,l=!1,p=e._f.length;if(p===0){I(e).invalidFormat=!0,e._d=new Date(NaN);return}for(n=0;n<p;n++)i=0,o=!1,t=ws({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[n],Os(t),ys(t)&&(o=!0),i+=I(t).charsLeftOver,i+=I(t).unusedTokens.length*10,I(t).score=i,l?i<r&&(r=i,a=t):(r==null||i<r||o)&&(r=i,a=t,o&&(l=!0));$e(e,a||t)}function Wn(e){if(!e._d){var t=js(e._i),a=t.day===void 0?t.date:t.day;e._a=ra([t.year,t.month,a,t.hour,t.minute,t.second,t.millisecond],function(r){return r&&parseInt(r,10)}),Ys(e)}}function Hn(e){var t=new Tt(Cs(ka(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function ka(e){var t=e._i,a=e._f;return e._locale=e._locale||He(e._l),t===null||a===void 0&&t===""?Vt({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),_e(t)?new Tt(Cs(t)):(Pt(t)?e._d=t:je(a)?Gn(e):a?Os(e):Vn(e),ys(e)||(e._d=null),e))}function Vn(e){var t=e._i;pe(t)?e._d=new Date(b.now()):Pt(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Rn(e):je(t)?(e._a=ra(t.slice(0),function(a){return parseInt(a,10)}),Ys(e)):rt(t)?Wn(e):We(t)?e._d=new Date(t):b.createFromInputFallback(e)}function Ma(e,t,a,r,n){var i={};return(t===!0||t===!1)&&(r=t,t=void 0),(a===!0||a===!1)&&(r=a,a=void 0),(rt(e)&&bs(e)||je(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=n,i._l=a,i._i=e,i._f=t,i._strict=r,Hn(i)}function Z(e,t,a,r){return Ma(e,t,a,r,!1)}var zn=ye("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Z.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Vt()}),Bn=ye("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Z.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Vt()});function Da(e,t){var a,r;if(t.length===1&&je(t[0])&&(t=t[0]),!t.length)return Z();for(a=t[0],r=1;r<t.length;++r)(!t[r].isValid()||t[r][e](a))&&(a=t[r]);return a}function $n(){var e=[].slice.call(arguments,0);return Da("isBefore",e)}function qn(){var e=[].slice.call(arguments,0);return Da("isAfter",e)}var Zn=function(){return Date.now?Date.now():+new Date},Nt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Qn(e){var t,a=!1,r,n=Nt.length;for(t in e)if(G(e,t)&&!(te.call(Nt,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(r=0;r<n;++r)if(e[Nt[r]]){if(a)return!1;parseFloat(e[Nt[r]])!==O(e[Nt[r]])&&(a=!0)}return!0}function Jn(){return this._isValid}function Kn(){return Se(NaN)}function Kt(e){var t=js(e),a=t.year||0,r=t.quarter||0,n=t.month||0,i=t.week||t.isoWeek||0,o=t.day||0,l=t.hour||0,p=t.minute||0,N=t.second||0,x=t.millisecond||0;this._isValid=Qn(t),this._milliseconds=+x+N*1e3+p*6e4+l*1e3*60*60,this._days=+o+i*7,this._months=+n+r*3+a*12,this._data={},this._locale=He(),this._bubble()}function Rt(e){return e instanceof Kt}function fs(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Xn(e,t,a){var r=Math.min(e.length,t.length),n=Math.abs(e.length-t.length),i=0,o;for(o=0;o<r;o++)O(e[o])!==O(t[o])&&i++;return i+n}function Pa(e,t){_(e,0,0,function(){var a=this.utcOffset(),r="+";return a<0&&(a=-a,r="-"),r+Te(~~(a/60),2)+t+Te(~~a%60,2)})}Pa("Z",":");Pa("ZZ","");w("Z",Zt);w("ZZ",Zt);q(["Z","ZZ"],function(e,t,a){a._useUTC=!0,a._tzm=Fs(Zt,e)});var ei=/([\+\-]|\d\d)/gi;function Fs(e,t){var a=(t||"").match(e),r,n,i;return a===null?null:(r=a[a.length-1]||[],n=(r+"").match(ei)||["-",0,0],i=+(n[1]*60)+O(n[2]),i===0?0:n[0]==="+"?i:-i)}function Us(e,t){var a,r;return t._isUTC?(a=t.clone(),r=(_e(e)||Pt(e)?e.valueOf():Z(e).valueOf())-a.valueOf(),a._d.setTime(a._d.valueOf()+r),b.updateOffset(a,!1),a):Z(e).local()}function ps(e){return-Math.round(e._d.getTimezoneOffset())}b.updateOffset=function(){};function ti(e,t,a){var r=this._offset||0,n;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=Fs(Zt,e),e===null)return this}else Math.abs(e)<16&&!a&&(e=e*60);return!this._isUTC&&t&&(n=ps(this)),this._offset=e,this._isUTC=!0,n!=null&&this.add(n,"m"),r!==e&&(!t||this._changeInProgress?Ca(this,Se(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,b.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:ps(this)}function si(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function ai(e){return this.utcOffset(0,e)}function ri(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(ps(this),"m")),this}function ni(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=Fs(jr,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function ii(e){return this.isValid()?(e=e?Z(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function li(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function oi(){if(!pe(this._isDSTShifted))return this._isDSTShifted;var e={},t;return ws(e,this),e=ka(e),e._a?(t=e._isUTC?Ie(e._a):Z(e._a),this._isDSTShifted=this.isValid()&&Xn(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function ci(){return this.isValid()?!this._isUTC:!1}function di(){return this.isValid()?this._isUTC:!1}function Ta(){return this.isValid()?this._isUTC&&this._offset===0:!1}var ui=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,hi=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Se(e,t){var a=e,r=null,n,i,o;return Rt(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:We(e)||!isNaN(+e)?(a={},t?a[t]=+e:a.milliseconds=+e):(r=ui.exec(e))?(n=r[1]==="-"?-1:1,a={y:0,d:O(r[Pe])*n,h:O(r[ie])*n,m:O(r[Ne])*n,s:O(r[Le])*n,ms:O(fs(r[st]*1e3))*n}):(r=hi.exec(e))?(n=r[1]==="-"?-1:1,a={y:et(r[2],n),M:et(r[3],n),w:et(r[4],n),d:et(r[5],n),h:et(r[6],n),m:et(r[7],n),s:et(r[8],n)}):a==null?a={}:typeof a=="object"&&("from"in a||"to"in a)&&(o=mi(Z(a.from),Z(a.to)),a={},a.ms=o.milliseconds,a.M=o.months),i=new Kt(a),Rt(e)&&G(e,"_locale")&&(i._locale=e._locale),Rt(e)&&G(e,"_isValid")&&(i._isValid=e._isValid),i}Se.fn=Kt.prototype;Se.invalid=Kn;function et(e,t){var a=e&&parseFloat(e.replace(",","."));return(isNaN(a)?0:a)*t}function Ks(e,t){var a={};return a.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(a.months,"M").isAfter(t)&&--a.months,a.milliseconds=+t-+e.clone().add(a.months,"M"),a}function mi(e,t){var a;return e.isValid()&&t.isValid()?(t=Us(t,e),e.isBefore(t)?a=Ks(e,t):(a=Ks(t,e),a.milliseconds=-a.milliseconds,a.months=-a.months),a):{milliseconds:0,months:0}}function Ia(e,t){return function(a,r){var n,i;return r!==null&&!isNaN(+r)&&(ia(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=a,a=r,r=i),n=Se(a,r),Ca(this,n,e),this}}function Ca(e,t,a,r){var n=t._milliseconds,i=fs(t._days),o=fs(t._months);e.isValid()&&(r=r??!0,o&&xa(e,St(e,"Month")+o*a),i&&ma(e,"Date",St(e,"Date")+i*a),n&&e._d.setTime(e._d.valueOf()+n*a),r&&b.updateOffset(e,i||o))}var fi=Ia(1,"add"),pi=Ia(-1,"subtract");function Ya(e){return typeof e=="string"||e instanceof String}function xi(e){return _e(e)||Pt(e)||Ya(e)||We(e)||bi(e)||gi(e)||e===null||e===void 0}function gi(e){var t=rt(e)&&!bs(e),a=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],n,i,o=r.length;for(n=0;n<o;n+=1)i=r[n],a=a||G(e,i);return t&&a}function bi(e){var t=je(e),a=!1;return t&&(a=e.filter(function(r){return!We(r)&&Ya(e)}).length===0),t&&a}function yi(e){var t=rt(e)&&!bs(e),a=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],n,i;for(n=0;n<r.length;n+=1)i=r[n],a=a||G(e,i);return t&&a}function wi(e,t){var a=e.diff(t,"days",!0);return a<-6?"sameElse":a<-1?"lastWeek":a<0?"lastDay":a<1?"sameDay":a<2?"nextDay":a<7?"nextWeek":"sameElse"}function vi(e,t){arguments.length===1&&(arguments[0]?xi(arguments[0])?(e=arguments[0],t=void 0):yi(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var a=e||Z(),r=Us(a,this).startOf("day"),n=b.calendarFormat(this,r)||"sameElse",i=t&&(Ce(t[n])?t[n].call(this,a):t[n]);return this.format(i||this.localeData().calendar(n,this,Z(a)))}function Ni(){return new Tt(this)}function ji(e,t){var a=_e(e)?e:Z(e);return this.isValid()&&a.isValid()?(t=we(t)||"millisecond",t==="millisecond"?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(t).valueOf()):!1}function _i(e,t){var a=_e(e)?e:Z(e);return this.isValid()&&a.isValid()?(t=we(t)||"millisecond",t==="millisecond"?this.valueOf()<a.valueOf():this.clone().endOf(t).valueOf()<a.valueOf()):!1}function Si(e,t,a,r){var n=_e(e)?e:Z(e),i=_e(t)?t:Z(t);return this.isValid()&&n.isValid()&&i.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(n,a):!this.isBefore(n,a))&&(r[1]===")"?this.isBefore(i,a):!this.isAfter(i,a))):!1}function ki(e,t){var a=_e(e)?e:Z(e),r;return this.isValid()&&a.isValid()?(t=we(t)||"millisecond",t==="millisecond"?this.valueOf()===a.valueOf():(r=a.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf())):!1}function Mi(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Di(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Pi(e,t,a){var r,n,i;if(!this.isValid())return NaN;if(r=Us(e,this),!r.isValid())return NaN;switch(n=(r.utcOffset()-this.utcOffset())*6e4,t=we(t),t){case"year":i=Lt(this,r)/12;break;case"month":i=Lt(this,r);break;case"quarter":i=Lt(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-n)/864e5;break;case"week":i=(this-r-n)/6048e5;break;default:i=this-r}return a?i:be(i)}function Lt(e,t){if(e.date()<t.date())return-Lt(t,e);var a=(t.year()-e.year())*12+(t.month()-e.month()),r=e.clone().add(a,"months"),n,i;return t-r<0?(n=e.clone().add(a-1,"months"),i=(t-r)/(r-n)):(n=e.clone().add(a+1,"months"),i=(t-r)/(n-r)),-(a+i)||0}b.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";b.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Ti(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Ii(e){if(!this.isValid())return null;var t=e!==!0,a=t?this.clone().utc():this;return a.year()<0||a.year()>9999?Ut(a,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ce(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ut(a,"Z")):Ut(a,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Ci(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",a,r,n,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),a="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(a+r+n+i)}function Yi(e){e||(e=this.isUtc()?b.defaultFormatUtc:b.defaultFormat);var t=Ut(this,e);return this.localeData().postformat(t)}function Oi(e,t){return this.isValid()&&(_e(e)&&e.isValid()||Z(e).isValid())?Se({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Fi(e){return this.from(Z(),e)}function Ui(e,t){return this.isValid()&&(_e(e)&&e.isValid()||Z(e).isValid())?Se({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Ri(e){return this.to(Z(),e)}function Oa(e){var t;return e===void 0?this._locale._abbr:(t=He(e),t!=null&&(this._locale=t),this)}var Fa=ye("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function Ua(){return this._locale}var Gt=1e3,mt=60*Gt,Wt=60*mt,Ra=(365*400+97)*24*Wt;function ft(e,t){return(e%t+t)%t}function La(e,t,a){return e<100&&e>=0?new Date(e+400,t,a)-Ra:new Date(e,t,a).valueOf()}function Aa(e,t,a){return e<100&&e>=0?Date.UTC(e+400,t,a)-Ra:Date.UTC(e,t,a)}function Li(e){var t,a;if(e=we(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?Aa:La,e){case"year":t=a(this.year(),0,1);break;case"quarter":t=a(this.year(),this.month()-this.month()%3,1);break;case"month":t=a(this.year(),this.month(),1);break;case"week":t=a(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=a(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ft(t+(this._isUTC?0:this.utcOffset()*mt),Wt);break;case"minute":t=this._d.valueOf(),t-=ft(t,mt);break;case"second":t=this._d.valueOf(),t-=ft(t,Gt);break}return this._d.setTime(t),b.updateOffset(this,!0),this}function Ai(e){var t,a;if(e=we(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?Aa:La,e){case"year":t=a(this.year()+1,0,1)-1;break;case"quarter":t=a(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=a(this.year(),this.month()+1,1)-1;break;case"week":t=a(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=a(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Wt-ft(t+(this._isUTC?0:this.utcOffset()*mt),Wt)-1;break;case"minute":t=this._d.valueOf(),t+=mt-ft(t,mt)-1;break;case"second":t=this._d.valueOf(),t+=Gt-ft(t,Gt)-1;break}return this._d.setTime(t),b.updateOffset(this,!0),this}function Ei(){return this._d.valueOf()-(this._offset||0)*6e4}function Gi(){return Math.floor(this.valueOf()/1e3)}function Wi(){return new Date(this.valueOf())}function Hi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Vi(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function zi(){return this.isValid()?this.toISOString():null}function Bi(){return ys(this)}function $i(){return $e({},I(this))}function qi(){return I(this).overflow}function Zi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}_("N",0,0,"eraAbbr");_("NN",0,0,"eraAbbr");_("NNN",0,0,"eraAbbr");_("NNNN",0,0,"eraName");_("NNNNN",0,0,"eraNarrow");_("y",["y",1],"yo","eraYear");_("y",["yy",2],0,"eraYear");_("y",["yyy",3],0,"eraYear");_("y",["yyyy",4],0,"eraYear");w("N",Rs);w("NN",Rs);w("NNN",Rs);w("NNNN",il);w("NNNNN",ll);q(["N","NN","NNN","NNNN","NNNNN"],function(e,t,a,r){var n=a._locale.erasParse(e,r,a._strict);n?I(a).era=n:I(a).invalidEra=e});w("y",pt);w("yy",pt);w("yyy",pt);w("yyyy",pt);w("yo",ol);q(["y","yy","yyy","yyyy"],de);q(["yo"],function(e,t,a,r){var n;a._locale._eraYearOrdinalRegex&&(n=e.match(a._locale._eraYearOrdinalRegex)),a._locale.eraYearOrdinalParse?t[de]=a._locale.eraYearOrdinalParse(e,n):t[de]=parseInt(e,10)});function Qi(e,t){var a,r,n,i=this._eras||He("en")._eras;for(a=0,r=i.length;a<r;++a){switch(typeof i[a].since){case"string":n=b(i[a].since).startOf("day"),i[a].since=n.valueOf();break}switch(typeof i[a].until){case"undefined":i[a].until=1/0;break;case"string":n=b(i[a].until).startOf("day").valueOf(),i[a].until=n.valueOf();break}}return i}function Ji(e,t,a){var r,n,i=this.eras(),o,l,p;for(e=e.toUpperCase(),r=0,n=i.length;r<n;++r)if(o=i[r].name.toUpperCase(),l=i[r].abbr.toUpperCase(),p=i[r].narrow.toUpperCase(),a)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[r];break;case"NNNN":if(o===e)return i[r];break;case"NNNNN":if(p===e)return i[r];break}else if([o,l,p].indexOf(e)>=0)return i[r]}function Ki(e,t){var a=e.since<=e.until?1:-1;return t===void 0?b(e.since).year():b(e.since).year()+(t-e.offset)*a}function Xi(){var e,t,a,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e)if(a=this.clone().startOf("day").valueOf(),r[e].since<=a&&a<=r[e].until||r[e].until<=a&&a<=r[e].since)return r[e].name;return""}function el(){var e,t,a,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e)if(a=this.clone().startOf("day").valueOf(),r[e].since<=a&&a<=r[e].until||r[e].until<=a&&a<=r[e].since)return r[e].narrow;return""}function tl(){var e,t,a,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e)if(a=this.clone().startOf("day").valueOf(),r[e].since<=a&&a<=r[e].until||r[e].until<=a&&a<=r[e].since)return r[e].abbr;return""}function sl(){var e,t,a,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(a=n[e].since<=n[e].until?1:-1,r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return(this.year()-b(n[e].since).year())*a+n[e].offset;return this.year()}function al(e){return G(this,"_erasNameRegex")||Ls.call(this),e?this._erasNameRegex:this._erasRegex}function rl(e){return G(this,"_erasAbbrRegex")||Ls.call(this),e?this._erasAbbrRegex:this._erasRegex}function nl(e){return G(this,"_erasNarrowRegex")||Ls.call(this),e?this._erasNarrowRegex:this._erasRegex}function Rs(e,t){return t.erasAbbrRegex(e)}function il(e,t){return t.erasNameRegex(e)}function ll(e,t){return t.erasNarrowRegex(e)}function ol(e,t){return t._eraYearOrdinalRegex||pt}function Ls(){var e=[],t=[],a=[],r=[],n,i,o,l,p,N=this.eras();for(n=0,i=N.length;n<i;++n)o=Ee(N[n].name),l=Ee(N[n].abbr),p=Ee(N[n].narrow),t.push(o),e.push(l),a.push(p),r.push(o),r.push(l),r.push(p);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+a.join("|")+")","i")}_(0,["gg",2],0,function(){return this.weekYear()%100});_(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Xt(e,t){_(0,[e,e.length],0,t)}Xt("gggg","weekYear");Xt("ggggg","weekYear");Xt("GGGG","isoWeekYear");Xt("GGGGG","isoWeekYear");w("G",qt);w("g",qt);w("GG",Q,xe);w("gg",Q,xe);w("GGGG",Ss,_s);w("gggg",Ss,_s);w("GGGGG",$t,zt);w("ggggg",$t,zt);Ct(["gggg","ggggg","GGGG","GGGGG"],function(e,t,a,r){t[r.substr(0,2)]=O(e)});Ct(["gg","GG"],function(e,t,a,r){t[r]=b.parseTwoDigitYear(e)});function cl(e){return Ea.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function dl(e){return Ea.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function ul(){return Ge(this.year(),1,4)}function hl(){return Ge(this.isoWeekYear(),1,4)}function ml(){var e=this.localeData()._week;return Ge(this.year(),e.dow,e.doy)}function fl(){var e=this.localeData()._week;return Ge(this.weekYear(),e.dow,e.doy)}function Ea(e,t,a,r,n){var i;return e==null?Mt(this,r,n).year:(i=Ge(e,r,n),t>i&&(t=i),pl.call(this,e,t,a,r,n))}function pl(e,t,a,r,n){var i=ya(e,t,a,r,n),o=kt(i.year,0,i.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}_("Q",0,"Qo","quarter");w("Q",oa);q("Q",function(e,t){t[Re]=(O(e)-1)*3});function xl(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}_("D",["DD",2],"Do","date");w("D",Q,xt);w("DD",Q,xe);w("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});q(["D","DD"],Pe);q("Do",function(e,t){t[Pe]=O(e.match(Q)[0])});var Ga=gt("Date",!0);_("DDD",["DDDD",3],"DDDo","dayOfYear");w("DDD",Bt);w("DDDD",ca);q(["DDD","DDDD"],function(e,t,a){a._dayOfYear=O(e)});function gl(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}_("m",["mm",2],0,"minute");w("m",Q,ks);w("mm",Q,xe);q(["m","mm"],Ne);var bl=gt("Minutes",!1);_("s",["ss",2],0,"second");w("s",Q,ks);w("ss",Q,xe);q(["s","ss"],Le);var yl=gt("Seconds",!1);_("S",0,0,function(){return~~(this.millisecond()/100)});_(0,["SS",2],0,function(){return~~(this.millisecond()/10)});_(0,["SSS",3],0,"millisecond");_(0,["SSSS",4],0,function(){return this.millisecond()*10});_(0,["SSSSS",5],0,function(){return this.millisecond()*100});_(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});_(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});_(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});_(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});w("S",Bt,oa);w("SS",Bt,xe);w("SSS",Bt,ca);var qe,Wa;for(qe="SSSS";qe.length<=9;qe+="S")w(qe,pt);function wl(e,t){t[st]=O(("0."+e)*1e3)}for(qe="S";qe.length<=9;qe+="S")q(qe,wl);Wa=gt("Milliseconds",!1);_("z",0,0,"zoneAbbr");_("zz",0,0,"zoneName");function vl(){return this._isUTC?"UTC":""}function Nl(){return this._isUTC?"Coordinated Universal Time":""}var f=Tt.prototype;f.add=fi;f.calendar=vi;f.clone=Ni;f.diff=Pi;f.endOf=Ai;f.format=Yi;f.from=Oi;f.fromNow=Fi;f.to=Ui;f.toNow=Ri;f.get=Ir;f.invalidAt=qi;f.isAfter=ji;f.isBefore=_i;f.isBetween=Si;f.isSame=ki;f.isSameOrAfter=Mi;f.isSameOrBefore=Di;f.isValid=Bi;f.lang=Fa;f.locale=Oa;f.localeData=Ua;f.max=Bn;f.min=zn;f.parsingFlags=$i;f.set=Cr;f.startOf=Li;f.subtract=pi;f.toArray=Hi;f.toObject=Vi;f.toDate=Wi;f.toISOString=Ii;f.inspect=Ci;typeof Symbol<"u"&&Symbol.for!=null&&(f[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});f.toJSON=zi;f.toString=Ti;f.unix=Gi;f.valueOf=Ei;f.creationData=Zi;f.eraName=Xi;f.eraNarrow=el;f.eraAbbr=tl;f.eraYear=sl;f.year=ha;f.isLeapYear=Tr;f.weekYear=cl;f.isoWeekYear=dl;f.quarter=f.quarters=xl;f.month=ga;f.daysInMonth=Gr;f.week=f.weeks=Zr;f.isoWeek=f.isoWeeks=Qr;f.weeksInYear=ml;f.weeksInWeekYear=fl;f.isoWeeksInYear=ul;f.isoWeeksInISOWeekYear=hl;f.date=Ga;f.day=f.days=dn;f.weekday=un;f.isoWeekday=hn;f.dayOfYear=gl;f.hour=f.hours=yn;f.minute=f.minutes=bl;f.second=f.seconds=yl;f.millisecond=f.milliseconds=Wa;f.utcOffset=ti;f.utc=ai;f.local=ri;f.parseZone=ni;f.hasAlignedHourOffset=ii;f.isDST=li;f.isLocal=ci;f.isUtcOffset=di;f.isUtc=Ta;f.isUTC=Ta;f.zoneAbbr=vl;f.zoneName=Nl;f.dates=ye("dates accessor is deprecated. Use date instead.",Ga);f.months=ye("months accessor is deprecated. Use month instead",ga);f.years=ye("years accessor is deprecated. Use year instead",ha);f.zone=ye("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",si);f.isDSTShifted=ye("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",oi);function jl(e){return Z(e*1e3)}function _l(){return Z.apply(null,arguments).parseZone()}function Ha(e){return e}var W=vs.prototype;W.calendar=or;W.longDateFormat=hr;W.invalidDate=fr;W.ordinal=gr;W.preparse=Ha;W.postformat=Ha;W.relativeTime=yr;W.pastFuture=wr;W.set=ir;W.eras=Qi;W.erasParse=Ji;W.erasConvertYear=Ki;W.erasAbbrRegex=rl;W.erasNameRegex=al;W.erasNarrowRegex=nl;W.months=Rr;W.monthsShort=Lr;W.monthsParse=Er;W.monthsRegex=Hr;W.monthsShortRegex=Wr;W.week=zr;W.firstDayOfYear=qr;W.firstDayOfWeek=$r;W.weekdays=rn;W.weekdaysMin=ln;W.weekdaysShort=nn;W.weekdaysParse=cn;W.weekdaysRegex=mn;W.weekdaysShortRegex=fn;W.weekdaysMinRegex=pn;W.isPM=gn;W.meridiem=wn;function Ht(e,t,a,r){var n=He(),i=Ie().set(r,t);return n[a](i,e)}function Va(e,t,a){if(We(e)&&(t=e,e=void 0),e=e||"",t!=null)return Ht(e,t,a,"month");var r,n=[];for(r=0;r<12;r++)n[r]=Ht(e,r,a,"month");return n}function As(e,t,a,r){typeof e=="boolean"?(We(t)&&(a=t,t=void 0),t=t||""):(t=e,a=t,e=!1,We(t)&&(a=t,t=void 0),t=t||"");var n=He(),i=e?n._week.dow:0,o,l=[];if(a!=null)return Ht(t,(a+i)%7,r,"day");for(o=0;o<7;o++)l[o]=Ht(t,(o+i)%7,r,"day");return l}function Sl(e,t){return Va(e,t,"months")}function kl(e,t){return Va(e,t,"monthsShort")}function Ml(e,t,a){return As(e,t,a,"weekdays")}function Dl(e,t,a){return As(e,t,a,"weekdaysShort")}function Pl(e,t,a){return As(e,t,a,"weekdaysMin")}Qe("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,a=O(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+a}});b.lang=ye("moment.lang is deprecated. Use moment.locale instead.",Qe);b.langData=ye("moment.langData is deprecated. Use moment.localeData instead.",He);var Fe=Math.abs;function Tl(){var e=this._data;return this._milliseconds=Fe(this._milliseconds),this._days=Fe(this._days),this._months=Fe(this._months),e.milliseconds=Fe(e.milliseconds),e.seconds=Fe(e.seconds),e.minutes=Fe(e.minutes),e.hours=Fe(e.hours),e.months=Fe(e.months),e.years=Fe(e.years),this}function za(e,t,a,r){var n=Se(t,a);return e._milliseconds+=r*n._milliseconds,e._days+=r*n._days,e._months+=r*n._months,e._bubble()}function Il(e,t){return za(this,e,t,1)}function Cl(e,t){return za(this,e,t,-1)}function Xs(e){return e<0?Math.floor(e):Math.ceil(e)}function Yl(){var e=this._milliseconds,t=this._days,a=this._months,r=this._data,n,i,o,l,p;return e>=0&&t>=0&&a>=0||e<=0&&t<=0&&a<=0||(e+=Xs(xs(a)+t)*864e5,t=0,a=0),r.milliseconds=e%1e3,n=be(e/1e3),r.seconds=n%60,i=be(n/60),r.minutes=i%60,o=be(i/60),r.hours=o%24,t+=be(o/24),p=be(Ba(t)),a+=p,t-=Xs(xs(p)),l=be(a/12),a%=12,r.days=t,r.months=a,r.years=l,this}function Ba(e){return e*4800/146097}function xs(e){return e*146097/4800}function Ol(e){if(!this.isValid())return NaN;var t,a,r=this._milliseconds;if(e=we(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+r/864e5,a=this._months+Ba(t),e){case"month":return a;case"quarter":return a/3;case"year":return a/12}else switch(t=this._days+Math.round(xs(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return t*24+r/36e5;case"minute":return t*1440+r/6e4;case"second":return t*86400+r/1e3;case"millisecond":return Math.floor(t*864e5)+r;default:throw new Error("Unknown unit "+e)}}function Ve(e){return function(){return this.as(e)}}var $a=Ve("ms"),Fl=Ve("s"),Ul=Ve("m"),Rl=Ve("h"),Ll=Ve("d"),Al=Ve("w"),El=Ve("M"),Gl=Ve("Q"),Wl=Ve("y"),Hl=$a;function Vl(){return Se(this)}function zl(e){return e=we(e),this.isValid()?this[e+"s"]():NaN}function nt(e){return function(){return this.isValid()?this._data[e]:NaN}}var Bl=nt("milliseconds"),$l=nt("seconds"),ql=nt("minutes"),Zl=nt("hours"),Ql=nt("days"),Jl=nt("months"),Kl=nt("years");function Xl(){return be(this.days()/7)}var Ue=Math.round,ut={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function eo(e,t,a,r,n){return n.relativeTime(t||1,!!a,e,r)}function to(e,t,a,r){var n=Se(e).abs(),i=Ue(n.as("s")),o=Ue(n.as("m")),l=Ue(n.as("h")),p=Ue(n.as("d")),N=Ue(n.as("M")),x=Ue(n.as("w")),k=Ue(n.as("y")),A=i<=a.ss&&["s",i]||i<a.s&&["ss",i]||o<=1&&["m"]||o<a.m&&["mm",o]||l<=1&&["h"]||l<a.h&&["hh",l]||p<=1&&["d"]||p<a.d&&["dd",p];return a.w!=null&&(A=A||x<=1&&["w"]||x<a.w&&["ww",x]),A=A||N<=1&&["M"]||N<a.M&&["MM",N]||k<=1&&["y"]||["yy",k],A[2]=t,A[3]=+e>0,A[4]=r,eo.apply(null,A)}function so(e){return e===void 0?Ue:typeof e=="function"?(Ue=e,!0):!1}function ao(e,t){return ut[e]===void 0?!1:t===void 0?ut[e]:(ut[e]=t,e==="s"&&(ut.ss=t-1),!0)}function ro(e,t){if(!this.isValid())return this.localeData().invalidDate();var a=!1,r=ut,n,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(a=e),typeof t=="object"&&(r=Object.assign({},ut,t),t.s!=null&&t.ss==null&&(r.ss=t.s-1)),n=this.localeData(),i=to(this,!a,r,n),a&&(i=n.pastFuture(+this,i)),n.postformat(i)}var cs=Math.abs;function ct(e){return(e>0)-(e<0)||+e}function es(){if(!this.isValid())return this.localeData().invalidDate();var e=cs(this._milliseconds)/1e3,t=cs(this._days),a=cs(this._months),r,n,i,o,l=this.asSeconds(),p,N,x,k;return l?(r=be(e/60),n=be(r/60),e%=60,r%=60,i=be(a/12),a%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",p=l<0?"-":"",N=ct(this._months)!==ct(l)?"-":"",x=ct(this._days)!==ct(l)?"-":"",k=ct(this._milliseconds)!==ct(l)?"-":"",p+"P"+(i?N+i+"Y":"")+(a?N+a+"M":"")+(t?x+t+"D":"")+(n||r||e?"T":"")+(n?k+n+"H":"")+(r?k+r+"M":"")+(e?k+o+"S":"")):"P0D"}var L=Kt.prototype;L.isValid=Jn;L.abs=Tl;L.add=Il;L.subtract=Cl;L.as=Ol;L.asMilliseconds=$a;L.asSeconds=Fl;L.asMinutes=Ul;L.asHours=Rl;L.asDays=Ll;L.asWeeks=Al;L.asMonths=El;L.asQuarters=Gl;L.asYears=Wl;L.valueOf=Hl;L._bubble=Yl;L.clone=Vl;L.get=zl;L.milliseconds=Bl;L.seconds=$l;L.minutes=ql;L.hours=Zl;L.days=Ql;L.weeks=Xl;L.months=Jl;L.years=Kl;L.humanize=ro;L.toISOString=es;L.toString=es;L.toJSON=es;L.locale=Oa;L.localeData=Ua;L.toIsoString=ye("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",es);L.lang=Fa;_("X",0,0,"unix");_("x",0,0,"valueOf");w("x",qt);w("X",_r);q("X",function(e,t,a){a._d=new Date(parseFloat(e)*1e3)});q("x",function(e,t,a){a._d=new Date(O(e))});//! moment.js
b.version="2.30.1";rr(Z);b.fn=f;b.min=$n;b.max=qn;b.now=Zn;b.utc=Ie;b.unix=jl;b.months=Sl;b.isDate=Pt;b.locale=Qe;b.invalid=Vt;b.duration=Se;b.isMoment=_e;b.weekdays=Ml;b.parseZone=_l;b.localeData=He;b.isDuration=Rt;b.monthsShort=kl;b.weekdaysMin=Pl;b.defineLocale=Is;b.updateLocale=_n;b.locales=Sn;b.weekdaysShort=Dl;b.normalizeUnits=we;b.relativeTimeRounding=so;b.relativeTimeThreshold=ao;b.calendarFormat=wi;b.prototype=f;b.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function gs(e={}){const t=(e.gstRate??0)/100,a=`${e.gstRate??0}%`,r=o=>{const l=Number(o??0);return Number.isNaN(l)?0:Number(l.toFixed(2))};if(e.pricingMode==="MRP_INCLUSIVE"){const o=e.mrp??0,l=t>0?o/(1+t):o,p=o-l;return{unitPriceNet:r(l),unitPriceGross:r(o),taxPerUnit:r(p),taxIncludedAtSource:!0,pricingExplainer:`MRP ${r(o)} incl ${a}  base ${r(l)} + GST ${r(p)}`}}if(e.pricingMode==="BASE_PLUS_GST"){const o=e.basePrice??0,l=o*(1+t),p=l-o;return{unitPriceNet:r(o),unitPriceGross:r(l),taxPerUnit:r(p),taxIncludedAtSource:!1,pricingExplainer:`Base ${r(o)} + ${a} GST = ${r(l)}`}}const n=e.sellingIncludesGst??!0,i=e.sellingPrice??0;if(n){const o=i,l=t>0?o/(1+t):o,p=o-l;return{unitPriceNet:r(l),unitPriceGross:r(o),taxPerUnit:r(p),taxIncludedAtSource:!0,pricingExplainer:`Selling ${r(o)} incl ${a}  base ${r(l)} + GST ${r(p)}`}}else{const o=i,l=o*(1+t),p=l-o;return{unitPriceNet:r(o),unitPriceGross:r(l),taxPerUnit:r(p),taxIncludedAtSource:!1,pricingExplainer:`Selling ${r(o)} + ${a} GST = ${r(l)}`}}}const fo=({selectedProducts:e=[],cartItems:t,onUpdateCart:a,settings:r})=>{const[n,i]=E.useState([]),o=Array.isArray(t),l=o?t:n,[p,N]=E.useState({}),x=h=>N(u=>({...u,[h]:!u[h]})),k=h=>{const u=Math.max(0,parseFloat(h.quantity)||0),d=Math.max(0,Math.min(100,parseFloat(h.discount)||0)),j=Math.max(0,parseFloat(h.price)||0);if(h?.normalized&&(h.pricingMode==="MRP_INCLUSIVE"||h.pricingMode==="BASE_PLUS_GST")){const X=Math.max(0,parseFloat(h.normalized.unitPriceNet)||0),ve=Math.max(0,parseFloat(h.normalized.taxPerUnit)||0),ke=X>0?ve/X:0;return X*(1-d/100)*(1+ke)*u}if(h.pricingMode==="SELLING_SIMPLE"||h.pricingMode==="LEGACY"){const X=Math.max(0,parseFloat(h.price)||0),ve=Math.max(0,parseFloat(h.inlineGstRate??h.gstRate??0))/100;return X*(1-d/100)*(1+ve)*u}return(j-j*d/100)*u},{includeGST:A,gstRate:P,enableCGST:M,enableSGST:F,enableIGST:le,includeCGST:z,includeSGST:y,includeIGST:Y,cgstRate:B,sgstRate:J,igstRate:m}=r||{},S=(h,u=r||{})=>{const d=u.extras||{},j=parseFloat(u.deliveryCharge)||0,C=parseFloat(u.packingCharge)||0,X=parseFloat(u.otherCharge)||0,ve=parseFloat(d.deliveryFee)||0,ke=parseFloat(d.packagingFee)||0;let ze=0;const lt=d.insuranceType||"none",Be=parseFloat(d.insuranceValue)||0;lt==="flat"&&(ze=Be),lt==="percent"&&(ze=h*(Be/100));const bt=j+ve,yt=C+ke,wt=X,ot=bt+yt+ze+wt;return{delivery:bt,packaging:yt,insurance:ze,other:wt,total:ot,insuranceMeta:{type:lt,val:Be}}},U=(h=l,u=r)=>{const d=h.reduce((ve,ke)=>ve+k(ke),0),j={gst:u?.includeGST&&u?.gstRate?d*u.gstRate/100:0,cgst:u?.includeCGST&&u?.cgstRate?d*u.cgstRate/100:0,sgst:u?.includeSGST&&u?.sgstRate?d*u.sgstRate/100:0,igst:u?.includeIGST&&u?.igstRate?d*u.igstRate/100:0},C=S(d,u),X=d+j.gst+j.cgst+j.sgst+j.igst+C.total;return{subtotal:d,taxBreakdown:j,extras:C,finalTotal:X}},R=h=>{if(a){const u=U(h,r);a(h,u)}o||i(h)};E.useEffect(()=>{if(!a)return;const h=U(l,r);a(l,h)},[r?.extras?.deliveryFee,r?.extras?.packagingFee,r?.extras?.insuranceType,r?.extras?.insuranceValue,r?.deliveryCharge,r?.packingCharge,r?.otherCharge,r?.includeGST,r?.includeCGST,r?.includeSGST,r?.includeIGST,r?.gstRate,r?.cgstRate,r?.sgstRate,r?.igstRate]);const v=()=>{const h=[...l,{id:"manual",name:"",sku:"",brand:"",category:"",unit:"",quantity:1,price:0,discount:0}];R(h)},T=(h,u,d)=>{const j=[...l];let C=d;(u==="quantity"||u==="price"||u==="discount"||u==="inlineGstRate")&&(C=parseFloat(d),Number.isNaN(C)&&(C=0),u==="discount"&&(C=Math.max(0,Math.min(100,C))),u==="inlineGstRate"&&(C=Math.max(0,Math.min(100,C)))),j[h]={...j[h],[u]:C},R(j)},$=h=>{const u=l.filter((d,j)=>j!==h);R(u)},ce=h=>{const u=k(h);return(Math.round(u*100)/100).toFixed(2)},H=l.reduce((h,u)=>h+k(u),0),ue=S(H,r),V=(A&&P?H*P/100:0)+(z&&B?H*B/100:0)+(y&&J?H*J/100:0)+(Y&&m?H*m/100:0),it=H+V+ue.total,Je=r?.orderPricingMode&&r.orderPricingMode.trim()?r.orderPricingMode.trim():null;E.useEffect(()=>{if(!e||e.length===0)return;const h=l,u=e.filter(d=>!h.some(j=>j.id&&d.id&&j.id===d.id||j.sku===(d.sku||""))).map(d=>{const j=!d.pricingMode||d.pricingMode==="LEGACY"?d.mrp?"MRP_INCLUSIVE":"SELLING_SIMPLE":d.pricingMode,C=Je||j,X=gs({pricingMode:C,gstRate:d.gstRate??d.taxRate??r?.gstRate??0,hsnCode:d.hsnCode,sellingPrice:d.sellingPrice??d.price??d.mrp??0,sellingIncludesGst:!(C==="SELLING_SIMPLE"||C==="BASE_PLUS_GST"),mrp:d.mrp,basePrice:d.basePrice});return{id:d.id,name:d.name||d.productName||"",sku:d.sku||"",brand:d.brand||"",category:d.category||"",unit:d.unit||"",quantity:1,price:Number(X.unitPriceGross)||0,discount:0,pricingMode:C,gstRate:d.gstRate??d.taxRate??r?.gstRate??0,inlineGstRate:d.gstRate??d.taxRate??r?.gstRate??0,hsnCode:d.hsnCode||"",normalized:X,sourceFields:{sellingPrice:d.sellingPrice??null,sellingIncludesGst:d.sellingIncludesGst??!0,mrp:d.mrp??null,basePrice:d.basePrice??null,productPricingMode:j}}});u.length>0&&R([...h,...u])},[e,Je]),E.useEffect(()=>{if(l.length===0||!a)return;const h=Je||void 0,u=r?.gstRate??0,d=l.map(j=>{if(!j.sourceFields)return j;const C=h??j.sourceFields?.productPricingMode??j.pricingMode??"SELLING_SIMPLE",X=gs({pricingMode:C,gstRate:j.gstRate??j.inlineGstRate??u,sellingPrice:j.sourceFields?.sellingPrice??j.price??0,sellingIncludesGst:!(C==="SELLING_SIMPLE"||C==="BASE_PLUS_GST"),mrp:j.sourceFields?.mrp??null,basePrice:j.sourceFields?.basePrice??null});return{...j,pricingMode:C,price:Number(X.unitPriceGross)||0,normalized:X}});R(d)},[Je]),E.useEffect(()=>{console.log("Rendered Items (source-of-truth):",l)},[l]);const Ye=()=>s.jsx("style",{children:`
      input[type=number].no-spin::-webkit-outer-spin-button,
      input[type=number].no-spin::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      input[type=number].no-spin {
        -moz-appearance: textfield;
      }
    `});return s.jsxs("div",{className:"space-y-6 px-4 pt-4 md:px-6 text-white",children:[s.jsx(Ye,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("button",{onClick:v,className:"px-4 py-2 rounded-xl font-medium text-slate-900 bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 hover:shadow-[0_10px_30px_rgba(16,185,129,0.35)] transition",children:"+ Add Item"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm border border-white/10 bg-white/5 backdrop-blur-xl rounded-xl overflow-hidden",children:[s.jsx("thead",{className:"text-left bg-white/10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 md:p-3 text-xs md:text-sm font-semibold text-white/80 border-b border-white/10",children:"Product"}),s.jsx("th",{className:"p-2 md:p-3 text-xs md:text-sm font-semibold text-white/80 border-b border-white/10",children:"Qty"}),s.jsx("th",{className:"p-2 md:p-3 text-xs md:text-sm font-semibold text-white/80 border-b border-white/10",children:"Selling"}),s.jsx("th",{className:"p-2 md:p-3 text-xs md:text-sm font-semibold text-white/80 border-b border-white/10",children:"Discount (%)"}),s.jsx("th",{className:"p-2 md:p-3 text-xs md:text-sm font-semibold text-white/80 border-b border-white/10",children:"Subtotal"}),s.jsx("th",{className:"p-2 md:p-3 text-xs md:text-sm font-semibold text-white/80 border-b border-white/10",children:"Action"})]})}),s.jsx("tbody",{children:l.map((h,u)=>s.jsxs(tt.Fragment,{children:[s.jsxs("tr",{className:"border-t border-white/10 hover:bg-white/5",children:[s.jsx("td",{className:"p-2 align-top",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("button",{type:"button",onClick:()=>x(u),className:"mt-1 w-6 h-6 rounded-full bg-white/10 border border-white/20 text-white/80 flex items-center justify-center hover:bg-white/20","aria-label":p[u]?"Hide details":"Show details",title:p[u]?"Hide details":"Show details",children:p[u]?"":"+"}),s.jsxs("div",{className:"flex-1 space-y-1",children:[s.jsx("input",{type:"text",value:h.name||"",onChange:d=>T(u,"name",d.target.value),placeholder:"Product name",className:"w-full px-2 py-1 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"}),!p[u]&&s.jsxs("div",{className:"text-[11px] text-white/50",children:[h.sku?`SKU: ${h.sku}`:"",h.brand?(h.sku?"  ":"")+`Brand: ${h.brand}`:""]})]})]})}),s.jsx("td",{className:"p-2 align-top",children:s.jsx("input",{type:"number",value:h.quantity||0,onChange:d=>T(u,"quantity",d.target.value),className:"w-16 px-2 py-1 rounded bg-white/10 border border-white/20 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400/50"})}),s.jsxs("td",{className:"p-2 align-top",children:[s.jsx("div",{className:"text-sm font-semibold",children:(()=>{const d=l[u]?.normalized?.unitPriceGross;if(typeof d=="number")return`${d.toFixed(2)}`;const j=Math.max(0,parseFloat(l[u]?.normalized?.unitPriceNet??h.price??0)),C=h.pricingMode==="SELLING_SIMPLE"||h.pricingMode==="LEGACY"?Math.max(0,parseFloat(h.inlineGstRate??h.gstRate??0)):l[u]?.normalized?.unitPriceNet?l[u].normalized.taxPerUnit/Math.max(1e-9,l[u].normalized.unitPriceNet)*100:0;return`${(j*(1+C/100)).toFixed(2)}`})()}),s.jsx("div",{className:"text-[11px] text-white/50",children:h.pricingMode==="MRP_INCLUSIVE"?"MRP (incl. GST)":h.pricingMode==="BASE_PLUS_GST"?"Base + GST":"Selling + GST"}),(!h.id||h.id==="manual")&&s.jsxs("div",{className:"pt-2",children:[s.jsx("label",{className:"text-[11px] text-white/60 block mb-1",children:"Price (net)"}),s.jsx("input",{type:"number",className:"no-spin w-24 px-2 py-1 rounded bg-white/10 border border-white/20 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400/50",value:h.price||0,min:0,step:"0.01",inputMode:"decimal",onFocus:d=>d.target.select(),onWheel:d=>d.currentTarget.blur(),onKeyDown:d=>{(d.key==="ArrowUp"||d.key==="ArrowDown")&&d.preventDefault()},onChange:d=>T(u,"price",d.target.value)})]})]}),s.jsx("td",{className:"p-2 align-top",children:s.jsx("input",{type:"number",value:h.discount||0,onChange:d=>T(u,"discount",d.target.value),className:"w-20 px-2 py-1 rounded bg-white/10 border border-white/20 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400/50"})}),s.jsx("td",{className:"p-2 md:p-3 text-white/90 align-top",children:ce(h)}),s.jsx("td",{className:"p-2 align-top",children:s.jsx("button",{onClick:()=>$(u),className:"text-rose-300 hover:text-rose-200 underline",children:"Remove"})})]},u),p[u]&&s.jsx("tr",{className:"border-t border-white/10 bg-white/5",children:s.jsx("td",{colSpan:6,className:"p-3",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.jsx("input",{type:"text",value:h.sku||"",onChange:d=>T(u,"sku",d.target.value),placeholder:"SKU",className:"px-2 py-1 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"}),s.jsx("input",{type:"text",value:h.brand||"",onChange:d=>T(u,"brand",d.target.value),placeholder:"Brand",className:"px-2 py-1 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"}),s.jsx("input",{type:"text",value:h.category||"",onChange:d=>T(u,"category",d.target.value),placeholder:"Category",className:"px-2 py-1 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"}),s.jsx("input",{type:"text",value:h.unit||"",onChange:d=>T(u,"unit",d.target.value),placeholder:"Unit",className:"px-2 py-1 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"})]})}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("span",{className:"text-white/70",children:"Base"}),s.jsx("span",{className:"font-medium",children:(()=>{const d=l[u]?.normalized?.unitPriceNet;return typeof d=="number"?`${d.toFixed(2)}`:`${Math.max(0,parseFloat(h.price)||0).toFixed(2)}`})()})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("span",{className:"text-white/70",children:"GST %"}),h.pricingMode==="SELLING_SIMPLE"||h.pricingMode==="LEGACY"?s.jsx("input",{type:"number",className:"no-spin w-20 px-2 py-1 rounded bg-white/10 border border-white/20 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400/50 text-right",value:h.inlineGstRate??h.gstRate??0,min:0,max:100,step:"0.01",inputMode:"decimal",onFocus:d=>d.target.select(),onWheel:d=>d.currentTarget.blur(),onKeyDown:d=>{(d.key==="ArrowUp"||d.key==="ArrowDown")&&d.preventDefault()},onChange:d=>T(u,"inlineGstRate",d.target.value)}):s.jsx("span",{className:"font-medium",children:(()=>{const d=l[u]?.normalized?.unitPriceNet??0,j=l[u]?.normalized?.taxPerUnit??0;return`${(d>0?j/d*100:0).toFixed(0)}%`})()})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("span",{className:"text-white/70",children:"GST "}),s.jsx("span",{className:"font-medium",children:(()=>{const d=l[u]?.normalized?.unitPriceNet,j=l[u]?.normalized?.taxPerUnit;if(typeof d=="number"&&typeof j=="number")return`${j.toFixed(2)}`;const C=Math.max(0,parseFloat(h.price)||0),X=Math.max(0,parseFloat(h.inlineGstRate??h.gstRate??0))/100;return`${(C*X).toFixed(2)}`})()})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("span",{className:"text-white/70",children:"Selling"}),s.jsx("span",{className:"font-semibold",children:(()=>{const d=l[u]?.normalized?.unitPriceGross;if(typeof d=="number")return`${d.toFixed(2)}`;const j=Math.max(0,parseFloat(h.price)||0),C=Math.max(0,parseFloat(h.inlineGstRate??h.gstRate??0))/100;return`${(j*(1+C)).toFixed(2)}`})()})]}),s.jsx("div",{className:"text-[11px] text-white/50",children:h.pricingMode==="MRP_INCLUSIVE"?"MRP (incl. GST)":h.pricingMode==="BASE_PLUS_GST"?"Base + GST":"Selling + GST"})]})]})})})]},u))})]})})]}),s.jsxs("div",{className:"mt-6 text-right space-y-2 text-sm md:text-base bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4 md:p-6",children:[s.jsxs("p",{children:["Total Items: ",l.length]}),s.jsxs("p",{children:["Total Quantity: ",l.reduce((h,u)=>h+u.quantity,0)]}),s.jsxs("p",{children:["Total Before Discount: ",l.reduce((h,u)=>{const d=Math.max(0,parseFloat(u.quantity)||0),j=u?.normalized&&(u.pricingMode==="MRP_INCLUSIVE"||u.pricingMode==="BASE_PLUS_GST")?parseFloat(u.normalized.unitPriceGross)||0:parseFloat(u.price)||0;return h+j*d},0).toFixed(2)]}),s.jsxs("p",{children:["Total Discount: ",l.reduce((h,u)=>{const d=Math.max(0,parseFloat(u.quantity)||0),j=Math.max(0,Math.min(100,parseFloat(u.discount)||0));if(u?.normalized&&(u.pricingMode==="MRP_INCLUSIVE"||u.pricingMode==="BASE_PLUS_GST")){const ke=Math.max(0,parseFloat(u.normalized.unitPriceNet)||0)*j/100;return h+ke*d}const X=Math.max(0,parseFloat(u.price)||0)*j/100;return h+X*d},0).toFixed(2)]}),A&&P>0&&s.jsxs("p",{children:["GST (",P,"%): ",(H*P/100).toFixed(2)]}),z&&B>0&&s.jsxs("p",{children:["CGST (",B,"%): ",(H*B/100).toFixed(2)]}),y&&J>0&&s.jsxs("p",{children:["SGST (",J,"%): ",(H*J/100).toFixed(2)]}),Y&&m>0&&s.jsxs("p",{children:["IGST (",m,"%): ",(H*m/100).toFixed(2)]}),ue.delivery>0&&s.jsxs("p",{children:["Delivery Fee: ",ue.delivery.toFixed(2)]}),ue.packaging>0&&s.jsxs("p",{children:["Packaging Fee: ",ue.packaging.toFixed(2)]}),ue.insurance>0&&s.jsxs("p",{children:["Insurance",ue.insuranceMeta?.type==="percent"?` (${ue.insuranceMeta.val}% of subtotal)`:"",": ",ue.insurance.toFixed(2)]}),ue.other>0&&s.jsxs("p",{children:["Other Charges: ",ue.other.toFixed(2)]}),s.jsxs("p",{className:"font-semibold text-lg",children:["Final Total: ",it.toFixed(2)]})]}),(()=>{const h=r?.driver||r?.extras?.driver||{},u=h.name||"",d=h.phone||"",j=h.vehicle||"",C=h.tracking||"";return u||d||j||C?s.jsxs("div",{className:"mt-4 bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4 md:p-6 text-sm md:text-base text-left",children:[s.jsx("div",{className:"font-semibold text-white/80 mb-2",children:"Delivery Details"}),s.jsxs("div",{className:"space-y-1",children:[u&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/60",children:"Driver Name: "}),s.jsx("span",{className:"text-white/90",children:u})]}),d&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/60",children:"Phone: "}),s.jsx("span",{className:"text-white/90",children:d})]}),j&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/60",children:"Vehicle: "}),s.jsx("span",{className:"text-white/90",children:j})]}),C&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/60",children:"Tracking: "}),s.jsx("span",{className:"text-white/90",children:C})]})]})]}):null})()]})},po=({settings:e,onChange:t,grandTotal:a})=>{const r=M=>{const{name:F,type:le,checked:z,value:y}=M.target;let Y=y;le==="number"&&(Y=parseFloat(y||0)),t({...e,[F]:le==="checkbox"?z:Y})},n=M=>t({...e,extras:{...e.extras||{},...M}}),i=M=>t({...e,driver:{...e.driver||{},...M}}),o=Number(a??e?.cartTotals?.finalTotal??e?.finalTotal??0),l=E.useRef(null),p=()=>({cash:Number(e?.splitPayment?.cash||0),upi:Number(e?.splitPayment?.upi||0),card:Number(e?.splitPayment?.card||0)}),N=(M,F)=>{const le=Number(F||0),z=e?.splitPayment||{};t({...e,splitPayment:{...z,[M]:le}})},x=(M=["upi","card","cash"])=>{const F=e?.splitPayment||{},le=Number(F.cash||0),z=Number(F.upi||0),y=Number(F.card||0),Y=Math.max(0,o-(le+z+y));if(Y<=0)return;const B=M.find(J=>J!==l.current&&!Number(F[J]));B&&t({...e,splitPayment:{...F,[B]:Y}})},k=()=>{const{cash:M,upi:F,card:le}=p();return Math.max(0,o-(M+F+le))},[A,P]=E.useState(!!e?.extras);return s.jsxs("div",{className:"p-4 md:p-6 rounded-xl space-y-6 mb-6 bg-white/10 backdrop-blur-xl border border-white/10 shadow-[0_8px_40px_rgba(0,0,0,0.35)] text-white",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2 text-white",children:"Invoice Settings"}),s.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:[s.jsx("span",{className:"block text-sm font-medium text-white/80 mb-2",children:"Price basis for this order"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{type:"button",onClick:()=>t({...e,orderPricingMode:""}),className:`px-3 py-2 rounded-lg border text-sm font-medium transition ${e.orderPricingMode?"border-white/20 text-white/80 hover:bg-white/10":"bg-emerald-500/30 border-emerald-400/50 text-emerald-200"}`,children:"Product default"}),s.jsx("button",{type:"button",onClick:()=>t({...e,orderPricingMode:"MRP_INCLUSIVE"}),className:`px-3 py-2 rounded-lg border text-sm font-medium transition ${e.orderPricingMode==="MRP_INCLUSIVE"?"bg-emerald-500/30 border-emerald-400/50 text-emerald-200":"border-white/20 text-white/80 hover:bg-white/10"}`,children:"MRP (inclusive)"}),s.jsx("button",{type:"button",onClick:()=>t({...e,orderPricingMode:"BASE_PLUS_GST"}),className:`px-3 py-2 rounded-lg border text-sm font-medium transition ${e.orderPricingMode==="BASE_PLUS_GST"?"bg-emerald-500/30 border-emerald-400/50 text-emerald-200":"border-white/20 text-white/80 hover:bg-white/10"}`,children:"Base + GST"}),s.jsx("button",{type:"button",onClick:()=>t({...e,orderPricingMode:"SELLING_SIMPLE"}),className:`px-3 py-2 rounded-lg border text-sm font-medium transition ${e.orderPricingMode==="SELLING_SIMPLE"?"bg-emerald-500/30 border-emerald-400/50 text-emerald-200":"border-white/20 text-white/80 hover:bg-white/10"}`,children:"Selling price"})]}),s.jsx("p",{className:"text-xs text-white/50 mt-1",children:`Override how each line is priced for this invoice. "Product default" uses each product's own mode.`})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[s.jsx("div",{className:"flex flex-col gap-2 p-3 rounded-lg bg-white/5 border border-white/10",children:s.jsxs("label",{className:"flex flex-col",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",name:"includeGST",checked:e.includeGST,onChange:r,className:"accent-emerald-400"}),"Include GST"]}),e.includeGST&&s.jsx("input",{type:"number",name:"gstRate",value:e.gstRate||"",onChange:r,className:"px-2 py-1 rounded w-20 bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50 mt-2",placeholder:"% GST"})]})}),s.jsx("div",{className:"flex flex-col gap-2 p-3 rounded-lg bg-white/5 border border-white/10",children:s.jsxs("label",{className:"flex flex-col",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",name:"includeCGST",checked:e.includeCGST,onChange:r,className:"accent-emerald-400"}),"Include CGST"]}),e.includeCGST&&s.jsx("input",{type:"number",name:"cgstRate",value:e.cgstRate||"",onChange:r,className:"px-2 py-1 rounded w-20 bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50 mt-2",placeholder:"% CGST"})]})}),s.jsx("div",{className:"flex flex-col gap-2 p-3 rounded-lg bg-white/5 border border-white/10",children:s.jsxs("label",{className:"flex flex-col",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",name:"includeSGST",checked:e.includeSGST,onChange:r,className:"accent-emerald-400"}),"Include SGST"]}),e.includeSGST&&s.jsx("input",{type:"number",name:"sgstRate",value:e.sgstRate||"",onChange:r,className:"px-2 py-1 rounded w-20 bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50 mt-2",placeholder:"% SGST"})]})}),s.jsx("div",{className:"flex flex-col gap-2 p-3 rounded-lg bg-white/5 border border-white/10",children:s.jsxs("label",{className:"flex flex-col",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",name:"includeIGST",checked:e.includeIGST,onChange:r,className:"accent-emerald-400"}),"Include IGST"]}),e.includeIGST&&s.jsx("input",{type:"number",name:"igstRate",value:e.igstRate||"",onChange:r,className:"px-2 py-1 rounded w-20 bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50 mt-2",placeholder:"% IGST"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Invoice Type"}),s.jsxs("select",{name:"invoiceType",value:e.invoiceType,onChange:r,className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400/50",children:[s.jsx("option",{value:"",children:"Select Invoice Type"}),s.jsx("option",{value:"retail",children:"Retail"}),s.jsx("option",{value:"tax",children:"Tax"}),s.jsx("option",{value:"quote",children:"Quote"}),s.jsx("option",{value:"estimation",children:"Estimation"})]})]}),s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Payment Mode"}),s.jsxs("select",{name:"paymentMode",value:e.paymentMode,onChange:r,className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400/50",children:[s.jsx("option",{value:"",children:"Select Payment Mode"}),s.jsx("option",{value:"cash",children:"Cash"}),s.jsx("option",{value:"upi",children:"UPI"}),s.jsx("option",{value:"card",children:"Card"}),s.jsx("option",{value:"split",children:"Split"}),s.jsx("option",{value:"credit",children:"Credit"}),s.jsx("option",{value:"advance",children:"Advance"})]})]}),e.paymentMode==="split"&&s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mt-2",children:[s.jsxs("label",{className:"flex flex-col space-y-1",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Cash Amount"}),s.jsx("input",{type:"number",name:"splitCash",value:e.splitPayment?.cash??"",onFocus:()=>l.current="cash",onBlur:()=>{l.current=null,x(["upi","card"])},onChange:M=>N("cash",M.target.value),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"  type amount; use Fill remaining",inputMode:"decimal",step:"0.01",min:"0"})]}),s.jsxs("label",{className:"flex flex-col space-y-1",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"UPI Amount"}),s.jsx("input",{type:"number",name:"splitUPI",value:e.splitPayment?.upi??"",onFocus:()=>l.current="upi",onBlur:()=>{l.current=null,x(["card","cash"])},onChange:M=>N("upi",M.target.value),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"  type amount; use Fill remaining",inputMode:"decimal",step:"0.01",min:"0"})]}),s.jsxs("label",{className:"flex flex-col space-y-1",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Card Amount"}),s.jsx("input",{type:"number",name:"splitCard",value:e.splitPayment?.card??"",onFocus:()=>l.current="card",onBlur:()=>{l.current=null,x(["upi","cash"])},onChange:M=>N("card",M.target.value),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"  type amount; use Fill remaining",inputMode:"decimal",step:"0.01",min:"0"})]}),s.jsxs("div",{className:"sm:col-span-3 flex items-center gap-3 text-sm text-white/70",children:[s.jsxs("span",{children:["Remaining balance: ",k().toLocaleString("en-IN",{maximumFractionDigits:2})]}),k()>0&&s.jsx("button",{type:"button",onClick:()=>x(),className:"px-2 py-1 rounded border border-white/20 bg-white/10 hover:bg-white/15 text-white",children:"Fill remaining"})]})]}),e.paymentMode==="credit"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[s.jsxs("label",{className:"flex flex-col space-y-1",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Credit Due Date"}),s.jsx("input",{type:"date",name:"creditDueDate",value:e.creditDueDate||"",onChange:r,className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"})]}),s.jsxs("label",{className:"flex flex-col space-y-1",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Credit Note"}),s.jsx("input",{type:"text",name:"creditNote",value:e.creditNote||"",onChange:r,className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"Optional note or reference"})]})]}),e.paymentMode==="advance"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[s.jsxs("label",{className:"flex flex-col space-y-1",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Advance Paid"}),s.jsx("input",{type:"number",name:"advancePaid",value:e.advancePaid||"",onChange:r,className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"})]}),s.jsxs("label",{className:"flex flex-col space-y-1",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Expected Payment Completion Date"}),s.jsx("input",{type:"date",name:"advanceDueDate",value:e.advanceDueDate||"",onChange:r,className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50"})]})]})]}),s.jsxs("div",{className:"mt-2 border-t border-white/10 pt-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-base font-semibold text-white",children:"Delivery & Extras"}),s.jsx("button",{type:"button",onClick:()=>P(M=>!M),className:"text-xs px-2 py-1 rounded border border-white/10 bg-white/5 hover:bg-white/10 text-white/80",children:A?"Hide":"Show"})]}),A&&s.jsxs("div",{className:"mt-4 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Delivery Fee"}),s.jsx("input",{type:"number",name:"deliveryFee",value:e?.extras?.deliveryFee??"",onChange:M=>n({deliveryFee:parseFloat(M.target.value||0)}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:""})]}),s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Packaging Fee"}),s.jsx("input",{type:"number",name:"packagingFee",value:e?.extras?.packagingFee??"",onChange:M=>n({packagingFee:parseFloat(M.target.value||0)}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:""})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Insurance Type"}),s.jsxs("select",{name:"insuranceType",value:e?.extras?.insuranceType||"none",onChange:M=>n({insuranceType:M.target.value}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400/50",children:[s.jsx("option",{value:"none",children:"None"}),s.jsx("option",{value:"flat",children:"Flat"}),s.jsx("option",{value:"percent",children:"Percent of Subtotal"})]})]}),s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Insurance Value"}),s.jsx("input",{type:"number",name:"insuranceValue",value:e?.extras?.insuranceValue??"",onChange:M=>n({insuranceValue:parseFloat(M.target.value||0)}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:" or %"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Driver Name"}),s.jsx("input",{type:"text",name:"driverName",value:e?.driver?.name||"",onChange:M=>i({name:M.target.value}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"e.g., Ramesh"})]}),s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Driver Phone"}),s.jsx("input",{type:"text",name:"driverPhone",value:e?.driver?.phone||"",onChange:M=>i({phone:M.target.value}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"10-digit"})]}),s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Vehicle / ID"}),s.jsx("input",{type:"text",name:"driverVehicle",value:e?.driver?.vehicle||"",onChange:M=>i({vehicle:M.target.value}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"MH12AB1234"})]}),s.jsxs("label",{className:"flex flex-col",children:[s.jsx("span",{className:"mb-1 font-medium text-white/80",children:"Tracking / Ref"}),s.jsx("input",{type:"text",name:"driverTracking",value:e?.driver?.tracking||"",onChange:M=>i({tracking:M.target.value}),className:"px-3 py-2 rounded bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50",placeholder:"Optional"})]})]})]})]})]})},xo=({onSelect:e})=>{const[t,a]=E.useState(""),[r,n]=E.useState([]),[i,o]=E.useState([]),l=E.useRef(null),[p,N]=E.useState(null);return E.useEffect(()=>{(async()=>{try{const k=De.currentUser?.uid;if(!k)return;const P=(await tr(sr(Ae,"businesses",k,"products"))).docs.map(M=>{const F=M.data(),le=F.pricingMode?F.pricingMode:F.mrp?"MRP_INCLUSIVE":"SELLING_SIMPLE",z=F.gstRate??F.taxRate??0,y=F.sellingIncludesGst??le!=="BASE_PLUS_GST";return{id:M.id,...F,pricingMode:le,gstRate:z,sellingIncludesGst:y}});o(P)}catch(k){console.error("Failed to load inventory:",k)}})()},[]),E.useEffect(()=>{const x=t.toLowerCase(),k=i.filter(A=>A.productName?.toLowerCase().includes(x)||A.sku?.toLowerCase().includes(x)||A.brand?.toLowerCase().includes(x)||A.category?.toLowerCase().includes(x));n(x?k:[])},[t,i]),E.useEffect(()=>{const x=()=>{if(!l.current)return;const k=l.current.getBoundingClientRect();N({left:k.left,top:k.bottom+8,width:k.width})};return r.length>0&&(x(),window.addEventListener("scroll",x,!0),window.addEventListener("resize",x)),()=>{window.removeEventListener("scroll",x,!0),window.removeEventListener("resize",x)}},[r.length,t]),s.jsxs("div",{className:"relative z-[999] mb-6 px-4 md:px-0 text-white",children:[s.jsx("input",{ref:l,type:"text",value:t,onChange:x=>a(x.target.value),placeholder:"Search product by name, SKU, brand, category...",className:"w-full px-4 py-2 rounded-xl text-sm md:text-base bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400/50 shadow-[0_6px_20px_rgba(0,0,0,0.25)]"}),r.length>0&&p&&_t.createPortal(s.jsx("ul",{style:{position:"fixed",left:p.left,top:p.top,width:p.width,maxHeight:"16rem"},className:"mt-2 overflow-y-auto z-[2000] rounded-xl border border-white/10 bg-[#0B0F14]/70 backdrop-blur-xl shadow-[0_12px_40px_rgba(0,0,0,0.45)]",children:r.map(x=>s.jsxs("li",{onClick:()=>{e(x),a(""),n([])},className:"p-3 hover:bg-white/10 cursor-pointer flex items-center gap-4 border-b border-white/10",children:[x.imageUrl&&s.jsx("img",{src:x.imageUrl,alt:x.productName,className:"w-10 h-10 object-cover rounded ring-1 ring-white/20"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-medium text-white",children:x.productName}),s.jsxs("span",{className:"text-sm text-white/60",children:["SKU: ",x.sku||"N/A"," | Brand: ",x.brand||"N/A"," | Category: ",x.category||"N/A"]}),(()=>{const k=gs({pricingMode:x.pricingMode||(x.mrp?"MRP_INCLUSIVE":"SELLING_SIMPLE"),gstRate:x.gstRate??x.taxRate??0,hsnCode:x.hsnCode,sellingPrice:x.sellingPrice??x.price??x.mrp??0,sellingIncludesGst:x.sellingIncludesGst??x.pricingMode!=="BASE_PLUS_GST",mrp:x.mrp,basePrice:x.basePrice});return s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"text-sm text-white/70",children:["Price: ",k.unitPriceGross?.toFixed?.(2)??k.unitPriceGross]}),(x.pricingMode==="MRP_INCLUSIVE"||x.pricingMode==="BASE_PLUS_GST")&&s.jsx("span",{className:"text-[11px] text-white/60",children:k.pricingExplainer})]})})(),s.jsxs("span",{className:"text-xs text-white/60",children:["Unit: ",x.unit||"N/A"]}),s.jsxs("span",{className:"text-xs text-emerald-300",children:["In Stock: ",x.quantity??0]})]})]},x.id))}),document.body)]})},ea="/assets/flyp_logo.png",no=()=>s.jsx("style",{children:`
    /* On-screen: Tabular numbers for perfect column alignment */
    #invoice-content .num { font-variant-numeric: tabular-nums; }

    /* On-screen: tighten table look */
    #invoice-content table th { letter-spacing: .02em; font-weight: 600; }
    #invoice-content table td, #invoice-content table th { vertical-align: middle; }

    /* Signature line helper */
    .sig-line { height:1px; background: currentColor; opacity:.25; }

    /* Non-print helpers */
    .avoid-break { page-break-inside: avoid !important; break-inside: avoid !important; }
  `});function io(e){try{const t=Math.round(Number(e||0));if(!isFinite(t))return"Zero";const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=P=>P?P+" ":"",i=P=>P<20?a[P]:r[Math.floor(P/10)]+(P%10?" "+a[P%10]:""),o=P=>{const M=Math.floor(P/100),F=P%100;return(M?a[M]+" Hundred"+(F?" ":""):"")+(F?i(F):"")};let l="",p=Math.floor(t/1e7),N=t%1e7,x=Math.floor(N/1e5);N=N%1e5;let k=Math.floor(N/1e3);N=N%1e3;let A=N;return p&&(l+=n(o(p))+"Crore "),x&&(l+=n(o(x))+"Lakh "),k&&(l+=n(o(k))+"Thousand "),A&&(l+=o(A)),l.trim()||"Zero"}catch{return"Zero"}}const go=e=>{const{customer:t,cartItems:a,settings:r,paymentMode:n,invoiceType:i,issuedAt:o,userInfo:l,onCancel:p,onConfirm:N,cart:x,invoiceConfig:k,totals:A,previewMode:P=!1,branding:M={logoUrl:"",signatureUrl:""},bank:F={name:"",branch:"",account:"",ifsc:""},payment:le={upiId:"",upiQrUrl:""},terms:z="",billingPrefsOverride:y=void 0}=e,[Y,B]=tt.useState(null),[J,m]=tt.useState("idle"),S=y||Y||{},U={...M||{},...S.branding||{}},R={...F||{},...S.bank||{}},v={...le||{},...S.payment||{}},T=typeof S.terms=="string"?S.terms:z,$="py-2",ce="from-white via-white to-emerald-200",[H,ue]=tt.useState(null);tt.useEffect(()=>{(async()=>{const g=De.currentUser;if(!g)return;const D=await at(Ze(Ae,"businesses",g.uid));D.exists()&&ue(D.data())})()},[]),tt.useEffect(()=>{(async()=>{const g=De.currentUser;if(g)try{const D=await at(Ze(Ae,"businesses",g.uid,"preferences","billing"));D.exists()&&B(D.data())}catch(D){console.error("Failed to load billing prefs",D)}})()},[]);const V=r??k??A?.invoiceConfig??{gstRate:0,deliveryCharge:0,packingCharge:0,otherCharge:0,dueDate:null,invoiceType:""},it=Array.isArray(a)?a:Array.isArray(x)?x:[],Je=typeof n<"u"&&n!==null?n:V?.paymentMode||A?.paymentMode||"",Ye=typeof i<"u"&&i!==null?i:V.invoiceType||"",h=c=>{const g=Number(c.quantity??c.qty??c.count??1);return Number.isFinite(g)&&g>0?g:1},u=c=>{const g=Number(c.price??c.unitPrice??c.rate??0);return Number.isFinite(g)&&g>=0?g:0},d=c=>{let g=Number(c.discount??c.discountPct??c.discountPercent??c.disc??c.off??0);return Number.isFinite(g)||(g=0),g=Math.max(0,Math.min(100,g)),g},j=c=>{let g=Number(c.discountAmount??c.discount_value??c.discountInRs??c.discountAmt??0);return Number.isFinite(g)||(g=0),Math.max(0,g)},C=String(Je||"").toLowerCase(),ve=((c="")=>{const g=String(c).trim().toLowerCase();return g==="tax"?"TAX INVOICE":g==="proforma"?"PROFORMA INVOICE":g==="estimate"||g==="estimation"?"ESTIMATE INVOICE":g==="quote"||g==="quotation"?"QUOTATION":g==="retail"?"RETAIL INVOICE":"TAX INVOICE"})(Ye),ke=(c,g={})=>{const D=g.extras||{},ee=Number(g.deliveryCharge)||0,me=Number(g.packingCharge)||0,se=Number(g.otherCharge)||0,oe=Number(D.deliveryFee)||0,fe=Number(D.packagingFee)||0;let ae=0;const re=D.insuranceType||"none",ge=Number(D.insuranceValue)||0;re==="flat"&&(ae=ge),re==="percent"&&(ae=c*(ge/100));const Me=ee+oe,Xe=me+fe,Yt=se,Oe=Me+Xe+ae+Yt;return{delivery:Me,packaging:Xe,insurance:ae,other:Yt,total:Oe,insuranceMeta:{type:re,val:ge}}},ze=()=>{const c=r?.driver||r?.extras?.driver||V?.driver||V?.extras?.driver||{};return{name:c.name||r?.driverName||V?.driverName||"",phone:c.phone||r?.driverPhone||V?.driverPhone||"",vehicle:c.vehicle||r?.vehicleId||V?.vehicleId||"",tracking:c.tracking||r?.trackingRef||V?.trackingRef||""}},lt=(c,g=0)=>{if(c==null)return g;const D=typeof c=="string"?parseFloat(c):Number(c);return Number.isFinite(D)?D:g},Be=c=>{if(c?.normalized&&(c.pricingMode==="MRP_INCLUSIVE"||c.pricingMode==="BASE_PLUS_GST")){const g=Number(c.normalized.unitPriceNet||0),D=Number(c.normalized.taxPerUnit||0);return g>0?D/g*100:0}return lt(c?.inlineGstRate??c?.gstRate??V.gstRate??0,0)},bt=c=>{const g=String(c||"").match(/^(\d{2})/);return g?g[1]:null},yt=(c,g)=>{const D=bt(g?.gstNumber),ee=bt(c?.gstNumber||c?.gstin);return D&&ee?D!==ee:!1},wt=(c,g,D)=>{const ee=Number(c)||0,me=Number(g)||0;return D?{igstPct:ee,igstAmt:me,cgstPct:0,sgstPct:0,cgstAmt:0,sgstAmt:0}:{igstPct:0,igstAmt:0,cgstPct:ee/2,sgstPct:ee/2,cgstAmt:me/2,sgstAmt:me/2}},ot=c=>Number(c||0).toFixed(2).replace(/\.00$/,""),Es=c=>{const g=Number(c.quantity??c.qty??1),D=Math.max(0,Math.min(100,Number(c.discount??c.discountPct??0)));if(c?.normalized&&(c.pricingMode==="MRP_INCLUSIVE"||c.pricingMode==="BASE_PLUS_GST")){const se=Number(c.normalized.unitPriceNet||0),oe=Number(c.normalized.taxPerUnit||0),fe=se>0?oe/se:0,ae=se*(1-D/100),re=ae*(1+fe),ge=re-ae;return{lineGrossAfterDisc:re*g,lineTaxAfterDisc:ge*g}}if(c.pricingMode==="SELLING_SIMPLE"||c.pricingMode==="LEGACY"){const se=Number(c.price||0),oe=Number(c.inlineGstRate??c.gstRate??0)/100,fe=se*(1-D/100),ae=fe*(1+oe),re=ae-fe;return{lineGrossAfterDisc:ae*g,lineTaxAfterDisc:re*g}}return{lineGrossAfterDisc:Number(c.price||0)*(1-D/100)*g,lineTaxAfterDisc:0}},Gs=it.reduce((c,g)=>{const D=Es(g);return c.subtotal+=D.lineGrossAfterDisc-D.lineTaxAfterDisc,c.rowTax+=D.lineTaxAfterDisc,c},{subtotal:0,rowTax:0}),ts=Gs.subtotal,Ws=Gs.rowTax,Ke=ke(ts,V),Hs=Ke.delivery,Vs=Ke.packaging,zs=Ke.other,Bs=Ke.insurance,qa=Ke.total,$s=ts+Ws+qa,Za=yt(t||{},H||{});let ss=0,as=0,rs=0;return(it||[]).forEach(c=>{const g=Be(c),D=Es(c),ee=wt(g,D.lineTaxAfterDisc||0,Za);ss+=ee.cgstAmt||0,as+=ee.sgstAmt||0,rs+=ee.igstAmt||0}),s.jsxs(s.Fragment,{children:[s.jsx(no,{}),s.jsxs("div",{id:"invoice-content",className:"p-4 md:p-6 rounded-xl max-w-5xl w-full mx-auto mt-6 pt-[env(safe-area-inset-top)] pb-[env(safe-area-inset-bottom)] space-y-6 text-white bg-white/10 backdrop-blur-2xl border border-white/10 shadow-[0_12px_50px_rgba(0,0,0,0.45)] overflow-visible print:bg-white print:text-black",children:[s.jsxs("div",{className:"pdf-hide flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Invoice Preview"}),s.jsx("button",{className:"no-print text-rose-300 hover:text-rose-200 underline",onClick:p,children:"Cancel"})]}),s.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 md:p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[U?.logoUrl?s.jsx("img",{src:U.logoUrl,alt:"Logo",className:"w-10 h-10 object-contain"}):s.jsx("img",{src:ea,alt:"FLYP",className:"w-10 h-10 rounded-md opacity-80"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs uppercase tracking-widest text-white/60",children:ve}),s.jsx("div",{className:"text-base font-semibold",children:"Invoice Preview"})]})]}),s.jsxs("div",{className:"text-right text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-white/60",children:"Invoice ID:"})," FLYP-",o?new Date(o).getTime():Date.now()]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-white/60",children:"Issued On:"})," ",o?b(o).local().format("DD MMM YYYY, hh:mm A"):"N/A"]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-white/60",children:"Now:"})," ",b().local().format("DD MMM YYYY, hh:mm A")]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h3",{className:"font-semibold",children:"Customer"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Name:"})," ",t?.name||""]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Phone:"})," ",t?.phone||""]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Email:"})," ",t?.email||""]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Address:"})," ",t?.address||""]})]}),s.jsxs("div",{className:"space-y-1 md:text-right",children:[s.jsx("h3",{className:"font-semibold",children:l?"Distributor":"Retailer"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Business:"})," ",(l?.businessName||H?.businessName||H?.distributorName||"").trim()||(l?"Distributor":"Retailer")]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Owner:"})," ",(l?.ownerName||H?.ownerName||H?.name||"").trim()||""]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Phone:"})," ",(l?.phone||H?.phone||"").trim()||""]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Email:"})," ",(l?.email||H?.email||"").trim()||""]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Address:"})," ",(l?.address||H?.address||"").trim()||""]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-white/60",children:"GSTIN:"})," ",(l?.gstin||l?.gstNumber||H?.gstNumber||"").trim()||"N/A","  ",s.jsx("span",{className:"ml-4 text-white/60",children:"PAN:"})," ",(l?.pan||H?.pan||"").trim()||"N/A"]})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("h2",{className:`text-center font-extrabold text-2xl mb-6 uppercase tracking-widest font-bold bg-clip-text text-transparent bg-gradient-to-r ${ce}`,children:ve}),s.jsx("div",{className:"pdf-hide pointer-events-none select-none absolute inset-0 flex items-center justify-center opacity-[0.06] text-6xl font-extrabold uppercase tracking-[0.3em]",children:Ye?String(Ye).toUpperCase():"INVOICE"})]}),s.jsx("div",{className:"pdf-hide h-[1px] w-full bg-white/10 print:bg-black/20 my-4"}),s.jsxs("div",{className:"mb-4 products-section pb-4",children:[s.jsx("h3",{className:"text-center font-bold text-lg mt-6 uppercase",children:"Products"}),s.jsx("div",{className:"overflow-x-auto w-full avoid-break",children:s.jsxs("table",{className:"min-w-full table-fixed text-[13px] border border-white/10 bg-white/5 rounded-xl overflow-hidden",children:[s.jsxs("colgroup",{children:[s.jsx("col",{style:{width:"28%"}}),s.jsx("col",{style:{width:"8%"}}),s.jsx("col",{style:{width:"8%"}}),s.jsx("col",{style:{width:"12%"}}),s.jsx("col",{style:{width:"10%"}}),s.jsx("col",{style:{width:"12%"}}),s.jsx("col",{style:{width:"8%"}}),s.jsx("col",{style:{width:"8%"}}),s.jsx("col",{style:{width:"6%"}})]}),s.jsx("thead",{className:"bg-white/10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-left whitespace-nowrap",children:"Name"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-left whitespace-nowrap",children:"Unit"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-right whitespace-nowrap",children:"Qty"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-right whitespace-nowrap",children:"Unit (Net)"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-right whitespace-nowrap",children:"Discount"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-right whitespace-nowrap",children:"Net"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-right whitespace-nowrap",children:"GST %"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-right whitespace-nowrap",children:"Tax"}),s.jsx("th",{className:"px-2 py-2 text-white/80 border-b border-white/10 text-right whitespace-nowrap",children:"Total"})]})}),s.jsx("tbody",{children:it.map((c,g)=>{const D=h(c),ee=u(c),me=d(c),se=j(c);let oe=ee,fe=Be(c),ae=0,re=0,ge=fe,Me=0,Xe=0;c?.normalized&&(c.pricingMode==="MRP_INCLUSIVE"||c.pricingMode==="BASE_PLUS_GST")?(oe=Number(c.normalized.unitPriceNet||0),fe=Be(c),se>0?ae=se/D:ae=oe*(me/100),re=Math.max(0,oe-ae)*D,ge=fe,Me=re*(fe/100),Xe=re+Me):c.pricingMode==="SELLING_SIMPLE"||c.pricingMode==="LEGACY"?(oe=ee,fe=Be(c),se>0?ae=se/D:ae=oe*(me/100),re=Math.max(0,oe-ae)*D,ge=fe,Me=re*(fe/100),Xe=re+Me):(oe=ee,se>0?(ae=se/D,re=oe*D-se):(ae=oe*(me/100),re=(oe-ae)*D),ge=0,Me=0,Xe=re);const Yt=yt(t||{},H||{}),Oe=wt(ge,Me,Yt);return s.jsxs(tt.Fragment,{children:[s.jsxs("tr",{className:"hover:bg-white/5 odd:bg-white/[0.03]",children:[s.jsx("td",{className:`px-2 ${$} md:px-3 border-t border-white/10`,children:(()=>{const ns=c.displayName||c.productName||c.name||c.product&&(c.product.productName||c.product.name)||c.title||c.itemName||c.label||"";return String(ns)})()}),s.jsx("td",{className:`px-2 ${$} md:px-3 border-t border-white/10`,children:c.unit||c.packSize||c.product&&(c.product.unit||c.product.packSize)||"-"}),s.jsx("td",{className:`px-2 ${$} md:px-3 border-t border-white/10 text-right num`,children:D}),s.jsxs("td",{className:`px-2 ${$} md:px-3 border-t border-white/10 text-right num`,children:["",oe.toFixed(2)]}),s.jsx("td",{className:`px-2 ${$} md:px-3 border-t border-white/10 text-right num`,children:se>0?`${se.toFixed(2)}`:me>0?`${me}%`:""}),s.jsxs("td",{className:`px-2 ${$} md:px-3 border-t border-white/10 text-right num`,children:["",re.toFixed(2)]}),s.jsx("td",{className:`px-2 ${$} md:px-3 border-t border-white/10 text-right num`,children:ge>0?`${ot(ge)}%`:""}),s.jsxs("td",{className:`px-2 ${$} md:px-3 border-t border-white/10 text-right num`,children:["",Me.toFixed(2)]}),s.jsxs("td",{className:`px-2 ${$} md:px-3 border-t border-white/10 text-right num`,children:["",Xe.toFixed(2)]})]}),s.jsxs("tr",{className:"text-[11px] text-white/60",children:[s.jsx("td",{className:"px-2 pb-2 md:px-3 border-b border-white/10",colSpan:5,children:s.jsx("div",{className:"flex flex-wrap items-center gap-3",children:(c.batch||c.lot||c.serial||c.imei||c.expiryDate)&&s.jsx("span",{className:"text-white/50",children:[c.batch||c.lot,c.serial||c.imei,c.expiryDate].filter(Boolean).join("  ")})})}),s.jsx("td",{className:"px-2 pb-2 md:px-3 border-b border-white/10 text-right",colSpan:4,children:Oe.igstPct>0?s.jsxs("span",{children:["IGST ",ot(Oe.igstPct),"% = ",Oe.igstAmt.toFixed(2)]}):s.jsxs("span",{children:["CGST ",ot(Oe.cgstPct),"% = ",Oe.cgstAmt.toFixed(2),"  SGST ",ot(Oe.sgstPct),"% = ",Oe.sgstAmt.toFixed(2)]})})]})]},g)})})]})})]}),s.jsxs("div",{id:"tax-summary",className:"mb-4 text-right",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2 text-white",children:"Tax Summary"}),s.jsxs("div",{className:"grid grid-cols-2 gap-y-1 gap-x-4 items-center w-full max-w-md ml-auto text-sm",children:[s.jsx("span",{className:"text-white/70",children:"Net Subtotal:"}),s.jsxs("span",{className:"text-right",children:["",ts.toFixed(2)]}),s.jsx("span",{className:"text-white/70",children:"Total Discount:"}),s.jsxs("span",{className:"text-right",children:["",(()=>{let c=0;return it.forEach(g=>{const D=h(g),ee=u(g),me=d(g),se=j(g);c+=se>0?se:ee*D*(me/100)}),c.toFixed(2)})()]}),s.jsx("span",{className:"text-white/70",children:"Total Tax:"}),s.jsxs("span",{className:"text-right",children:["",Ws.toFixed(2)]}),ss>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-white/70",children:"CGST:"}),s.jsxs("span",{className:"text-right",children:["",ss.toFixed(2)]})]}),as>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-white/70",children:"SGST:"}),s.jsxs("span",{className:"text-right",children:["",as.toFixed(2)]})]}),rs>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-white/70",children:"IGST:"}),s.jsxs("span",{className:"text-right",children:["",rs.toFixed(2)]})]}),Hs>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-white/70",children:"Delivery:"}),s.jsxs("span",{className:"text-right",children:["",Hs.toFixed(2)]})]}),Vs>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-white/70",children:"Packing:"}),s.jsxs("span",{className:"text-right",children:["",Vs.toFixed(2)]})]}),zs>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-white/70",children:"Other:"}),s.jsxs("span",{className:"text-right",children:["",zs.toFixed(2)]})]}),Bs>0&&s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"text-white/70",children:["Insurance",Ke?.insuranceMeta?.type==="percent"?` (${Ke.insuranceMeta.val}% of subtotal)`:"",":"]}),s.jsxs("span",{className:"text-right",children:["",Bs.toFixed(2)]})]}),s.jsx("span",{className:"col-span-2 h-[1px] bg-white/10 my-1"}),s.jsx("span",{className:"font-semibold",children:"Grand Total:"}),s.jsxs("span",{className:"text-right font-bold text-lg",children:["",$s.toFixed(2)]})]}),s.jsxs("p",{className:"text-sm text-white/70 mt-3",children:["Payment Mode: ",Je||"N/A"," | Invoice Type: ",Ye&&Ye.length>0?Ye.charAt(0).toUpperCase()+Ye.slice(1):"N/A"]}),C==="credit"&&(V.creditDueDate||V.dueDate)&&s.jsxs("p",{className:"text-sm text-rose-300 mt-1",children:["Due Date: ",b(V.creditDueDate||V.dueDate).format("DD MMM YYYY")]}),V.isPaid&&V.paidOn&&s.jsxs("p",{className:"text-sm text-emerald-300 mt-1",children:[" Paid on: ",b(V.paidOn.toDate?.()||V.paidOn).format("DD MMM YYYY")," via ",V.paidVia?.toUpperCase()]}),C==="split"&&(()=>{const c=V.splitPayment||{},g=c.cash??V.splitCash??0,D=c.upi??V.splitUPI??0,ee=c.card??V.splitCard??0;return s.jsxs("div",{className:"text-sm text-white/70 mt-1 space-y-1",children:[s.jsx("p",{children:"Split Breakdown:"}),s.jsxs("p",{children:["- ",Number(g).toFixed(2)," by Cash"]}),s.jsxs("p",{children:["- ",Number(D).toFixed(2)," by UPI"]}),s.jsxs("p",{children:["- ",Number(ee).toFixed(2)," by Card"]})]})})()]}),(()=>{const c=ze();return!!(c.name||c.phone||c.vehicle||c.tracking)?s.jsxs("div",{className:"mt-4 rounded-lg border border-white/10 bg-white/5 p-4 text-sm avoid-break",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Delivery Details"}),s.jsxs("div",{className:"space-y-1",children:[c.name&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/70",children:"Driver Name:"})," ",s.jsx("span",{children:c.name})]}),c.phone&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/70",children:"Phone:"})," ",s.jsx("span",{children:c.phone})]}),c.vehicle&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/70",children:"Vehicle / ID:"})," ",s.jsx("span",{children:c.vehicle})]}),c.tracking&&s.jsxs("div",{children:[s.jsx("span",{className:"text-white/70",children:"Tracking / Ref:"})," ",s.jsx("span",{children:c.tracking})]})]})]}):null})(),s.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 avoid-break",children:[s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 p-4 text-sm",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Bank Details"}),s.jsxs("p",{children:[R?.bankName||"Bank",R?.branch?`  ${R.branch}`:""]}),R?.accountNumber?s.jsxs("p",{children:["Account: ",R.accountNumber]}):null,R?.ifsc?s.jsxs("p",{children:["IFSC: ",R.ifsc]}):null,R?.accountName?s.jsxs("p",{children:["Name: ",R.accountName]}):null]}),s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 p-4 text-sm",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"UPI"}),s.jsx("p",{children:v?.upiId||""}),v?.upiQrUrl?s.jsx("img",{src:v.upiQrUrl,alt:"UPI QR",className:"h-24 mt-2 object-contain"}):null]})]}),s.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6 avoid-break",children:[s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 p-4",children:[s.jsx("div",{className:"text-sm text-white/70 mb-1",children:"Amount in Words"}),s.jsxs("div",{className:"font-medium",children:["Rupees ",io($s)," Only"]})]}),s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 p-4",children:[s.jsx("div",{className:"text-sm text-white/70 mb-4",children:"Authorized Signatory"}),U?.signatureUrl&&s.jsx("img",{src:U.signatureUrl,alt:"Signature",className:"h-12 mb-2 object-contain"}),s.jsx("div",{className:"sig-line"}),s.jsx("div",{className:"mt-2 text-sm text-white/60",children:"Seal & Signature"})]})]}),(T||V?.terms||V?.notes)&&s.jsxs("div",{className:"mt-4 rounded-lg border border-white/10 bg-white/5 p-4 text-sm text-white/80",children:[s.jsx("div",{className:"font-semibold mb-1",children:"Terms & Conditions"}),s.jsx("div",{className:"whitespace-pre-wrap",children:T||V.terms||V.notes})]}),s.jsx("div",{className:"mt-8 avoid-break",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("img",{src:ea,alt:"FLYP Logo",className:"w-16 h-16 opacity-80"}),s.jsx("div",{className:"text-xs text-white/60",children:"Powered by FLYP"})]}),s.jsx("div",{className:"text-right text-sm text-white/70 italic",children:"Thank you for your business!"})]})})]}),s.jsx("div",{className:"text-center mt-6",children:!e.viewOnly&&!P&&s.jsx("button",{className:"no-print px-6 py-2 rounded-xl font-semibold text-slate-900 bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 hover:shadow-[0_10px_30px_rgba(16,185,129,0.35)] disabled:opacity-60 disabled:cursor-not-allowed",disabled:J==="publishing",onClick:async c=>{c.preventDefault?.();try{m("publishing");const g=typeof e.onPublish=="function"?e.onPublish:typeof N=="function"?N:null,D=g?g():null;D&&typeof D.then=="function"&&await D,m("success"),setTimeout(()=>m("idle"),1200)}catch(g){console.error("Publish failed",g),m("error"),setTimeout(()=>m("idle"),1500)}},children:J==="publishing"?"Publishing":"Publish Invoice"})}),J!=="idle"&&s.jsx("div",{className:"no-print fixed inset-0 z-[120] flex items-center justify-center bg-slate-950/60 backdrop-blur-sm",children:s.jsxs("div",{className:"relative w-[min(92vw,420px)] rounded-2xl border border-white/10 bg-white/10 p-6 text-white shadow-2xl",children:[s.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[s.jsx("div",{className:"absolute -top-12 -left-10 h-48 w-48 rounded-full blur-3xl bg-emerald-400/20 animate-[auroraShift_18s_ease-in-out_infinite]"}),s.jsx("div",{className:"absolute -bottom-12 -right-10 h-56 w-56 rounded-full blur-3xl bg-cyan-400/20 animate-[auroraShift_18s_ease-in-out_infinite]"})]}),s.jsxs("div",{className:"relative text-center",children:[J==="publishing"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mx-auto mb-3 h-10 w-10 rounded-full border-4 border-white/30 border-t-emerald-300 animate-spin"}),s.jsx("div",{className:"text-lg font-semibold",children:"Publishing invoice"}),s.jsx("div",{className:"text-sm text-white/80 mt-1",children:"Saving and generating a shareable copy"}),s.jsx("div",{className:"mt-4 h-2 w-full overflow-hidden rounded-full bg-white/10",children:s.jsx("div",{className:"h-full w-1/2 bg-gradient-to-r from-transparent via-white/60 to-transparent animate-[shimmer_1.6s_linear_infinite]"})})]}),J==="success"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mx-auto mb-3 h-10 w-10 rounded-full bg-emerald-400/90 flex items-center justify-center",children:s.jsx("svg",{viewBox:"0 0 24 24",className:"h-6 w-6 text-slate-900",children:s.jsx("path",{fill:"currentColor",d:"M9 16.2l-3.5-3.5 1.4-1.4L9 13.4l8.1-8.1 1.4 1.4z"})})}),s.jsx("div",{className:"text-lg font-semibold",children:"Invoice published"}),s.jsx("div",{className:"text-sm text-white/80 mt-1",children:"You can now share or print the invoice"})]}),J==="error"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mx-auto mb-3 h-10 w-10 rounded-full bg-rose-400/90 flex items-center justify-center",children:s.jsx("svg",{viewBox:"0 0 24 24",className:"h-6 w-6 text-slate-900",children:s.jsx("path",{fill:"currentColor",d:"M12 2L2 22h20L12 2zm1 15h-2v-2h2v2zm0-4h-2V9h2v4z"})})}),s.jsx("div",{className:"text-lg font-semibold",children:"Publish failed"}),s.jsx("div",{className:"text-sm text-white/80 mt-1",children:"Please try again"})]})]}),s.jsx("style",{children:`
              @keyframes auroraShift { 0%{transform:translateX(-8%) translateY(-6%) rotate(0)} 50%{transform:translateX(6%) translateY(4%) rotate(10deg)} 100%{transform:translateX(-8%) translateY(-6%) rotate(0)} }
              @keyframes shimmer { 0%{transform:translateX(-100%)} 100%{transform:translateX(200%)} }
            `})]})})]})},bo=({isOpen:e,onClose:t,onConfirm:a,invoice:r})=>{const[n,i]=E.useState("cash"),o=()=>{a(n)};return e?s.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md w-full max-w-md",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Mark Invoice as Paid"}),s.jsxs("p",{className:"mb-2",children:["Invoice ID: ",s.jsx("span",{className:"font-mono",children:r?.invoiceId})]}),s.jsx("label",{className:"block mt-4 font-medium",children:"Select Payment Mode:"}),s.jsxs("select",{className:"border px-3 py-2 w-full mt-2 rounded",value:n,onChange:l=>i(l.target.value),children:[s.jsx("option",{value:"cash",children:"Cash"}),s.jsx("option",{value:"upi",children:"UPI"}),s.jsx("option",{value:"card",children:"Card"})]}),s.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 rounded border border-gray-400 hover:bg-gray-100",children:"Cancel"}),s.jsx("button",{onClick:o,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Confirm Paid"})]})]})}):null},lo=({isOpen:e,onClose:t,onComplete:a})=>{const[r,n]=E.useState(1),[i,o]=E.useState(!1),[l,p]=E.useState({businessName:"",businessType:"",businessCategory:"",gstin:"",pan:"",email:"",phone:"",address:"",city:"",state:"",pincode:"",bankAccountNumber:"",bankIfsc:"",bankName:"",accountHolderName:""}),[N,x]=E.useState(null),[k,A]=E.useState(null);E.useEffect(()=>{if(!e)return;(async()=>{const Y=De.currentUser?.uid;if(Y)try{const B=await at(Ze(Ae,"businesses",Y));if(B.exists()){const m=B.data();x(m),p(S=>({...S,businessName:m.businessName||m.distributorName||"",email:m.email||"",phone:m.phone||"",address:m.address||"",city:m.city||"",state:m.state||"",gstin:m.gstin||m.gstNumber||"",pan:m.pan||""}))}const J=await at(Ze(Ae,"businesses",Y,"preferences","billing"));if(J.exists()){const m=J.data();m.payment?.card?.merchantAccountId&&A({status:m.payment?.card?.merchantStatus||"active",merchantId:m.payment?.card?.merchantAccountId})}}catch(B){console.error("Error loading user info:",B)}})()},[e]);const P=(y,Y)=>{p(B=>({...B,[y]:Y}))},M=y=>{if(y===1){if(!l.businessName||!l.businessType||!l.businessCategory)return ne.error("Please fill all required business information"),!1;if(!l.gstin||l.gstin.length!==15)return ne.error("Please enter a valid 15-character GSTIN"),!1;if(!l.pan||l.pan.length!==10)return ne.error("Please enter a valid 10-character PAN"),!1}if(y===2){if(!l.email||!l.phone||!l.address||!l.city||!l.state||!l.pincode)return ne.error("Please fill all contact information"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email))return ne.error("Please enter a valid email address"),!1;const B=l.phone.replace(/\D/g,"").slice(-10);if(!/^[6-9]\d{9}$/.test(B))return ne.error("Please enter a valid 10-digit Indian phone number (starting with 6-9)"),!1}if(y===3){if(!l.bankAccountNumber||!l.bankIfsc||!l.bankName||!l.accountHolderName)return ne.error("Please fill all bank account details"),!1;if(l.bankIfsc.length!==11)return ne.error("IFSC code must be 11 characters"),!1}return!0},F=()=>{M(r)&&n(y=>y+1)},le=()=>{n(y=>y-1)},z=async()=>{if(M(3)){o(!0);try{const y=De.currentUser?.uid;if(!y){ne.error("User not authenticated"),o(!1);return}const B=await ar(Qa,"createMerchantAccount")({businessInfo:{businessName:l.businessName,businessType:l.businessType,businessCategory:l.businessCategory,gstin:l.gstin.toUpperCase(),pan:l.pan.toUpperCase()},contactInfo:{email:l.email,phone:l.phone.replace(/\D/g,"").slice(-10),address:l.address,city:l.city,state:l.state,pincode:l.pincode},bankInfo:{accountNumber:l.bankAccountNumber,ifsc:l.bankIfsc.toUpperCase(),bankName:l.bankName,accountHolderName:l.accountHolderName},userId:y});if(B.data.success){const J=Ze(Ae,"businesses",y,"preferences","billing"),m=await at(J),S=m.exists()?m.data():{};await sa(J,{...S,payment:{...S.payment,card:{...S.payment?.card,enabled:!0,gateway:B.data.gateway||"razorpay",merchantAccountId:B.data.merchantId,merchantStatus:B.data.status||"pending",paymentLinkEnabled:!0,onboardedAt:new Date().toISOString()}}},{merge:!0}),ne.success("Merchant account created successfully! Your payment gateway will be activated shortly."),a?.(B.data),t()}else throw new Error(B.data.error||"Failed to create merchant account")}catch(y){console.error("Error creating merchant account:",y);let Y="Failed to create merchant account. Please try again.";y.code==="functions/not-found"?Y="Payment gateway service is not available. Please contact support.":y.code==="functions/permission-denied"?Y="You don't have permission to create a merchant account. Please contact support.":y.code==="functions/unauthenticated"?Y="Please log in again to continue.":y.message?Y=y.message:y.details&&(Y=y.details),ne.error(Y)}finally{o(!1)}}};return e?k?_t.createPortal(s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"w-full max-w-2xl mx-4 rounded-xl border border-white/10 bg-white/10 backdrop-blur-2xl text-white shadow-xl",children:[s.jsxs("div",{className:"p-4 md:p-6 border-b border-white/10 flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg md:text-xl font-semibold",children:"Payment Gateway Status"}),s.jsx("button",{className:"opacity-80 hover:opacity-100 text-2xl leading-none",onClick:t,children:""})]}),s.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[s.jsxs("div",{className:"p-4 rounded-lg bg-emerald-500/20 border border-emerald-500/30",children:[s.jsx("p",{className:"font-semibold text-emerald-300 mb-2",children:" Merchant Account Active"}),s.jsx("p",{className:"text-sm text-white/70",children:"Your payment gateway is set up and ready to accept card payments."}),s.jsxs("p",{className:"text-xs text-white/60 mt-2",children:["Merchant ID: ",k.merchantId]})]}),s.jsx("button",{className:"w-full px-4 py-2 rounded-lg font-medium text-slate-900 bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 hover:shadow-[0_8px_24px_rgba(16,185,129,0.35)]",onClick:t,children:"Close"})]})]})}),document.body):_t.createPortal(s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm overflow-y-auto",children:s.jsxs("div",{className:"w-full max-w-3xl mx-4 my-8 rounded-xl border border-white/10 bg-white/10 backdrop-blur-2xl text-white shadow-xl",children:[s.jsxs("div",{className:"p-4 md:p-6 border-b border-white/10 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg md:text-xl font-semibold",children:"Setup Payment Gateway"}),s.jsxs("p",{className:"text-sm text-white/70 mt-1",children:["Step ",r," of 3"]})]}),s.jsx("button",{className:"opacity-80 hover:opacity-100 text-2xl leading-none",onClick:t,disabled:i,children:""})]}),s.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[r===1&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-base",children:"Business Information"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Business Name *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.businessName,onChange:y=>P("businessName",y.target.value),placeholder:"Enter your business name"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Business Type *"}),s.jsxs("select",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.businessType,onChange:y=>P("businessType",y.target.value),children:[s.jsx("option",{value:"",children:"Select Type"}),s.jsx("option",{value:"sole_proprietorship",children:"Sole Proprietorship"}),s.jsx("option",{value:"partnership",children:"Partnership"}),s.jsx("option",{value:"private_limited",children:"Private Limited"}),s.jsx("option",{value:"llp",children:"Limited Liability Partnership (LLP)"}),s.jsx("option",{value:"public_limited",children:"Public Limited"}),s.jsx("option",{value:"huf",children:"HUF (Hindu Undivided Family)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Business Category *"}),s.jsxs("select",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.businessCategory,onChange:y=>P("businessCategory",y.target.value),children:[s.jsx("option",{value:"",children:"Select Category"}),s.jsx("option",{value:"retail",children:"Retail"}),s.jsx("option",{value:"wholesale",children:"Wholesale"}),s.jsx("option",{value:"manufacturing",children:"Manufacturing"}),s.jsx("option",{value:"services",children:"Services"}),s.jsx("option",{value:"ecommerce",children:"E-commerce"}),s.jsx("option",{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"GSTIN *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20 uppercase",value:l.gstin,onChange:y=>P("gstin",y.target.value.toUpperCase()),placeholder:"15-character GSTIN",maxLength:15})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"PAN *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20 uppercase",value:l.pan,onChange:y=>P("pan",y.target.value.toUpperCase()),placeholder:"10-character PAN",maxLength:10})]})]})]}),r===2&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-base",children:"Contact Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Email *"}),s.jsx("input",{type:"email",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.email,onChange:y=>P("email",y.target.value),placeholder:"business@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Phone *"}),s.jsx("input",{type:"tel",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.phone,onChange:y=>{let Y=y.target.value.replace(/[^\d+]/g,"");Y.startsWith("+91")?Y="+91"+Y.slice(3).replace(/\D/g,"").slice(0,10):Y=Y.replace(/\D/g,"").slice(0,10),P("phone",Y)},placeholder:"10-digit phone number (e.g., 9828738372 or +919828738372)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Address *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.address,onChange:y=>P("address",y.target.value),placeholder:"Street address"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"City *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.city,onChange:y=>P("city",y.target.value),placeholder:"City"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"State *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.state,onChange:y=>P("state",y.target.value),placeholder:"State"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Pincode *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.pincode,onChange:y=>P("pincode",y.target.value.replace(/\D/g,"")),placeholder:"6-digit pincode",maxLength:6})]})]})]}),r===3&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-base",children:"Bank Account Details (for Settlements)"}),s.jsx("p",{className:"text-sm text-white/70",children:"This account will receive payment settlements from card transactions."}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Account Holder Name *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.accountHolderName,onChange:y=>P("accountHolderName",y.target.value),placeholder:"Name as per bank account"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Bank Name *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.bankName,onChange:y=>P("bankName",y.target.value),placeholder:"Bank name"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Account Number *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.bankAccountNumber,onChange:y=>P("bankAccountNumber",y.target.value.replace(/\D/g,"")),placeholder:"Bank account number"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"IFSC Code *"}),s.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20 uppercase",value:l.bankIfsc,onChange:y=>P("bankIfsc",y.target.value.toUpperCase()),placeholder:"11-character IFSC",maxLength:11})]})]}),s.jsx("div",{className:"p-4 rounded-lg bg-blue-500/20 border border-blue-500/30",children:s.jsxs("p",{className:"text-sm text-blue-200",children:[s.jsx("strong",{children:"Note:"})," Your merchant account will be created automatically. Once approved (usually within 24-48 hours), you'll be able to accept card payments. You'll receive email notifications about the status."]})})]}),s.jsx("div",{className:"flex gap-2",children:[1,2,3].map(y=>s.jsx("div",{className:`flex-1 h-2 rounded ${y<=r?"bg-emerald-400":"bg-white/20"}`},y))})]}),s.jsxs("div",{className:"p-4 md:p-6 border-t border-white/10 flex items-center justify-between",children:[s.jsx("button",{className:"px-4 py-2 rounded-lg border border-white/20 hover:bg-white/10 transition",onClick:r===1?t:le,disabled:i,children:r===1?"Cancel":"Back"}),r<3?s.jsx("button",{className:"px-4 py-2 rounded-lg font-medium text-slate-900 bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 hover:shadow-[0_8px_24px_rgba(16,185,129,0.35)]",onClick:F,disabled:i,children:"Next"}):s.jsx("button",{className:"px-4 py-2 rounded-lg font-medium text-slate-900 bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 hover:shadow-[0_8px_24px_rgba(16,185,129,0.35)] disabled:opacity-50",onClick:z,disabled:i,children:i?"Creating Account...":"Submit & Create Account"})]})]})}),document.body):null},ta={branding:{logoUrl:"",signatureUrl:"",stampUrl:""},bank:{bankName:"",branch:"",accountNumber:"",ifsc:"",accountName:""},payment:{upiId:"",upiQrUrl:"",multipleUpiIds:[],card:{enabled:!1,gateway:"",merchantId:"",apiKey:"",paymentLinkEnabled:!1},notifications:{sendOnInvoice:!1,sendOnCredit:!0,autoSendPaymentLink:!1}},terms:""},he=e=>e==null?"":String(e),oo=e=>{const t=e?.branding||{},a=e?.bank||{},r=e?.payment||{},n={branding:{logoUrl:he(t.logoUrl),signatureUrl:he(t.signatureUrl),stampUrl:he(t.stampUrl)},bank:{bankName:he(a.bankName||a.name),branch:he(a.branch),accountNumber:he(a.accountNumber||a.account),ifsc:he(a.ifsc),accountName:he(a.accountName)},payment:{upiId:he(r.upiId),upiQrUrl:he(r.upiQrUrl),multipleUpiIds:Array.isArray(r.multipleUpiIds)?r.multipleUpiIds.map(he).filter(Boolean):[],card:{enabled:!!r.card?.enabled,gateway:he(r.card?.gateway||""),merchantId:he(r.card?.merchantId||""),apiKey:he(r.card?.apiKey||""),paymentLinkEnabled:!!r.card?.paymentLinkEnabled},notifications:{sendOnInvoice:!!r.notifications?.sendOnInvoice,sendOnCredit:r.notifications?.sendOnCredit!==!1,autoSendPaymentLink:!!r.notifications?.autoSendPaymentLink}},terms:he(e?.terms),updatedAt:Date.now()};return JSON.parse(JSON.stringify(n))};function yo({isOpen:e,onClose:t,onSaved:a}){const[r,n]=E.useState(!1),[i,o]=E.useState(!1),[l,p]=E.useState(ta),[N,x]=E.useState(!1),[k,A]=E.useState(""),[P,M]=E.useState(!1),F=E.useRef(null),le=Ja();E.useEffect(()=>{if(!e)return;const m=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=m}},[e]),E.useEffect(()=>{if(!e)return;(async()=>{const S=De.currentUser?.uid;if(S){n(!0);try{const U=Ze(Ae,"businesses",S,"preferences","billing"),R=await at(U);if(R.exists()){const v=R.data()||{},T=v.bank||{},$={bankName:T.bankName||T.name||"",branch:T.branch||"",accountNumber:T.accountNumber||T.account||"",ifsc:T.ifsc||"",accountName:T.accountName||""};p({branding:{logoUrl:v.branding?.logoUrl||"",signatureUrl:v.branding?.signatureUrl||"",stampUrl:v.branding?.stampUrl||""},bank:$,payment:{upiId:v.payment?.upiId||"",upiQrUrl:v.payment?.upiQrUrl||"",multipleUpiIds:v.payment?.multipleUpiIds||[],card:{enabled:v.payment?.card?.enabled||!1,gateway:v.payment?.card?.gateway||"",merchantId:v.payment?.card?.merchantId||"",apiKey:v.payment?.card?.apiKey||"",paymentLinkEnabled:v.payment?.card?.paymentLinkEnabled||!1},notifications:{sendOnInvoice:v.payment?.notifications?.sendOnInvoice||!1,sendOnCredit:v.payment?.notifications?.sendOnCredit!==!1,autoSendPaymentLink:v.payment?.notifications?.autoSendPaymentLink||!1}},terms:v.terms||""})}else p(ta)}catch(U){console.error("Failed to load billing settings",U),ne?.error?.("Failed to load billing settings")}finally{n(!1)}}})()},[e]);const z=(m,S)=>{p(U=>{const R={...U},v=m.split(".");let T=R;for(let $=0;$<v.length-1;$++)T[v[$]]={...T[v[$]]||{}},T=T[v[$]];return T[v[v.length-1]]=S,R})},y=async(m,S,U="image.png")=>{const R=De.currentUser?.uid;if(!(!R||!S))try{A(m);const v=m.replace(/\./g,"-"),T=Ka(le,`businesses/${R}/billing/${v}/${Date.now()}-${U}`),$=S instanceof Blob||S instanceof File?S:new Blob([S],{type:"application/octet-stream"});await Xa(T,$);const ce=await er(T);z(m,ce),ne?.success?.("Image uploaded")}catch(v){console.error("Upload to storage failed",v),ne?.error?.("Upload failed")}finally{A("")}},Y=async(m,S)=>{S&&await y(m,S,S.name||"image.png")},B=async()=>{const m=De.currentUser?.uid;if(m){o(!0);try{const S=Ze(Ae,"businesses",m,"preferences","billing"),U=oo(l),R=JSON.stringify(U),v=new Blob([R]).size;if(console.debug("Saving billing settings payload bytes:",v,U),v>9e5){ne?.error?.("Images are too large to store in settings. Please re-upload smaller images."),o(!1);return}await sa(S,U,{merge:!0}),ne?.success?.("Billing settings saved"),a?.(U),t?.()}catch(S){console.error("Failed to save billing settings",S),ne?.error?.("Failed to save billing settings")}finally{o(!1)}}};E.useEffect(()=>{if(!N||!F.current)return;const m=F.current,S=m.getContext("2d");S.lineWidth=2,S.lineCap="round",S.strokeStyle="#111";let U=!1;const R=ce=>{const H=m.getBoundingClientRect(),ue=(ce.touches?ce.touches[0].clientX:ce.clientX)-H.left,V=(ce.touches?ce.touches[0].clientY:ce.clientY)-H.top;return{x:ue,y:V}},v=ce=>{U=!0;const H=R(ce);S.beginPath(),S.moveTo(H.x,H.y)},T=ce=>{if(!U)return;const H=R(ce);S.lineTo(H.x,H.y),S.stroke()},$=()=>{U=!1};return m.addEventListener("mousedown",v),m.addEventListener("mousemove",T),window.addEventListener("mouseup",$),m.addEventListener("touchstart",v,{passive:!0}),m.addEventListener("touchmove",T,{passive:!0}),window.addEventListener("touchend",$),()=>{m.removeEventListener("mousedown",v),m.removeEventListener("mousemove",T),window.removeEventListener("mouseup",$),m.removeEventListener("touchstart",v),m.removeEventListener("touchmove",T),window.removeEventListener("touchend",$)}},[N]);const J=async()=>{if(!(!De.currentUser?.uid||!F.current))try{A("branding.signatureUrl");const S=await new Promise(U=>F.current.toBlob(U,"image/png"));await y("branding.signatureUrl",S,"signature.png"),x(!1)}catch(S){console.error("Signature upload failed",S),ne?.error?.("Signature upload failed")}finally{A("")}};return e&&e?_t.createPortal(s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:[s.jsxs("div",{className:"w-full max-w-3xl mx-4 rounded-lg border border-white/10 bg-white/10 backdrop-blur-2xl text-white shadow-xl",children:[s.jsxs("div",{className:"p-4 md:p-6 border-b border-white/10 flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg md:text-xl font-semibold",children:"Billing Settings"}),s.jsx("button",{className:"opacity-80 hover:opacity-100",onClick:t,children:"Close"})]}),s.jsxs("div",{className:"p-4 md:p-6 space-y-6 max-h-[75vh] overflow-y-auto relative "+(r?"opacity-60 pointer-events-none":""),children:[s.jsxs("section",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Branding"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Logo"}),s.jsx("div",{className:"flex gap-2 items-center",children:s.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:m=>Y("branding.logoUrl",m.target.files?.[0]),className:"block w-full text-sm",disabled:k==="branding.logoUrl"})}),l.branding.logoUrl?s.jsx("div",{className:"mt-2 p-2 rounded bg-white/5 border border-white/10",children:s.jsx("img",{src:l.branding.logoUrl,alt:"Logo preview",className:"max-h-16 object-contain"})}):null,k==="branding.logoUrl"&&s.jsx("p",{className:"text-xs opacity-70 mt-1",children:"Uploading"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Signature"}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"file",accept:"image/*",capture:"user",onChange:m=>Y("branding.signatureUrl",m.target.files?.[0]),className:"block w-full text-sm",disabled:k==="branding.signatureUrl"}),s.jsx("button",{type:"button",onClick:()=>x(!0),className:"px-2 py-1 rounded border border-white/20 bg-white/10 hover:bg-white/15 text-sm",children:"Draw"})]}),l.branding.signatureUrl?s.jsx("div",{className:"mt-2 p-2 rounded bg-white/5 border border-white/10",children:s.jsx("img",{src:l.branding.signatureUrl,alt:"Signature preview",className:"max-h-16 object-contain"})}):null,k==="branding.signatureUrl"&&s.jsx("p",{className:"text-xs opacity-70 mt-1",children:"Uploading"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Stamp (optional)"}),s.jsx("input",{type:"file",accept:"image/*",onChange:m=>Y("branding.stampUrl",m.target.files?.[0]),className:"block w-full text-sm",disabled:k==="branding.stampUrl"}),l.branding.stampUrl?s.jsx("div",{className:"mt-2 p-2 rounded bg-white/5 border border-white/10",children:s.jsx("img",{src:l.branding.stampUrl,alt:"Stamp preview",className:"max-h-20 object-contain"})}):null,k==="branding.stampUrl"&&s.jsx("p",{className:"text-xs opacity-70 mt-1",children:"Uploading"})]})})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"UPI Payment Gateway"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Primary UPI ID"}),s.jsx("input",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",placeholder:"username@bank",value:l.payment?.upiId??"",onChange:m=>z("payment.upiId",m.target.value)}),s.jsx("p",{className:"text-xs opacity-70 mt-1",children:"Used for payment links and QR generation."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"UPI QR Code"}),s.jsx("input",{type:"file",accept:"image/*",onChange:m=>Y("payment.upiQrUrl",m.target.files?.[0]),className:"block w-full text-sm",disabled:k==="payment.upiQrUrl"}),l.payment?.upiQrUrl?s.jsx("div",{className:"mt-2 p-2 rounded bg-white/5 border border-white/10",children:s.jsx("img",{src:l.payment.upiQrUrl,alt:"UPI QR",className:"max-h-32 object-contain"})}):null,k==="payment.upiQrUrl"&&s.jsx("p",{className:"text-xs opacity-70 mt-1",children:"Uploading"})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm opacity-80 mb-2",children:"Additional UPI IDs (Optional)"}),s.jsx("p",{className:"text-xs opacity-70 mb-2",children:"Add multiple UPI IDs if you have different accounts for different purposes."}),(l.payment?.multipleUpiIds||[]).map((m,S)=>s.jsxs("div",{className:"flex gap-2 mb-2",children:[s.jsx("input",{className:"flex-1 px-3 py-2 rounded-lg bg-white/10 border border-white/20",placeholder:"username@bank",value:m,onChange:U=>{const R=[...l.payment?.multipleUpiIds||[]];R[S]=U.target.value,z("payment.multipleUpiIds",R)}}),s.jsx("button",{type:"button",onClick:()=>{const U=[...l.payment?.multipleUpiIds||[]];U.splice(S,1),z("payment.multipleUpiIds",U)},className:"px-3 py-2 rounded-lg border border-white/20 hover:bg-white/10",children:"Remove"})]},S)),s.jsx("button",{type:"button",onClick:()=>{const m=l.payment?.multipleUpiIds||[];z("payment.multipleUpiIds",[...m,""])},className:"px-3 py-2 rounded-lg border border-white/20 hover:bg-white/10 text-sm",children:"+ Add UPI ID"})]})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Card Payment Gateway"}),s.jsxs("div",{className:"space-y-4",children:[l.payment?.card?.merchantAccountId?s.jsxs("div",{className:"p-4 rounded-lg bg-emerald-500/20 border border-emerald-500/30",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-emerald-300",children:" Payment Gateway Active"}),s.jsxs("p",{className:"text-sm text-white/70 mt-1",children:["Gateway: ",l.payment.card.gateway||"razorpay"," | Status: ",l.payment.card.merchantStatus||"active"]}),l.payment.card.merchantAccountId&&s.jsxs("p",{className:"text-xs text-white/60 mt-1",children:["Merchant ID: ",l.payment.card.merchantAccountId]})]})}),s.jsx("p",{className:"text-sm text-white/80",children:"Your card payment gateway is set up and ready to accept payments. Customers can pay via card using payment links."})]}):s.jsxs("div",{className:"p-4 rounded-lg bg-blue-500/20 border border-blue-500/30",children:[s.jsxs("p",{className:"text-sm text-blue-200 mb-3",children:[s.jsx("strong",{children:"Easy Setup:"})," We'll create a payment gateway account for you automatically. No need to sign up with Razorpay or Stripe separately!"]}),s.jsx("button",{type:"button",onClick:()=>M(!0),className:"px-4 py-2 rounded-lg font-medium text-slate-900 bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 hover:shadow-[0_8px_24px_rgba(16,185,129,0.35)]",children:"Setup Payment Gateway"}),s.jsx("p",{className:"text-xs text-white/60 mt-2",children:"You'll need: Business details (GSTIN, PAN), Contact info, and Bank account details"})]}),l.payment?.card?.enabled&&!l.payment?.card?.merchantAccountId&&s.jsx("div",{className:"pl-7 space-y-4 border-l-2 border-white/10",children:s.jsx("p",{className:"text-sm text-white/70",children:'Click "Setup Payment Gateway" above to get started. The setup process takes just a few minutes.'})})]})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Payment Notifications"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:l.payment?.notifications?.sendOnInvoice||!1,onChange:m=>z("payment.notifications.sendOnInvoice",m.target.checked),className:"w-5 h-5 accent-emerald-400"}),s.jsx("span",{className:"text-sm opacity-80",children:"Automatically send payment link when invoice is created"})]}),s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:l.payment?.notifications?.sendOnCredit!==!1,onChange:m=>z("payment.notifications.sendOnCredit",m.target.checked),className:"w-5 h-5 accent-emerald-400"}),s.jsx("span",{className:"text-sm opacity-80",children:"Send payment reminders for credit invoices"})]}),s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:l.payment?.notifications?.autoSendPaymentLink||!1,onChange:m=>z("payment.notifications.autoSendPaymentLink",m.target.checked),className:"w-5 h-5 accent-emerald-400"}),s.jsx("span",{className:"text-sm opacity-80",children:"Auto-send payment link via WhatsApp (requires customer phone)"})]})]})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Bank Details"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Bank Name"}),s.jsx("input",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.bank.bankName??"",onChange:m=>z("bank.bankName",m.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Branch"}),s.jsx("input",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.bank.branch??"",onChange:m=>z("bank.branch",m.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Account Number"}),s.jsx("input",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.bank.accountNumber??"",onChange:m=>z("bank.accountNumber",m.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"IFSC"}),s.jsx("input",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.bank.ifsc??"",onChange:m=>z("bank.ifsc",m.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm opacity-80 mb-1",children:"Account Holder Name"}),s.jsx("input",{className:"w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20",value:l.bank.accountName??"",onChange:m=>z("bank.accountName",m.target.value)})]})]})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Terms / Declaration"}),s.jsx("textarea",{className:"w-full min-h-[120px] px-3 py-2 rounded-lg bg-white/10 border border-white/20",placeholder:"Any terms & conditions you want to show on invoices",value:l.terms??"",onChange:m=>z("terms",m.target.value)})]}),r&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin h-8 w-8 rounded-full border-2 border-white/30 border-t-white"})})]}),s.jsxs("div",{className:"p-4 md:p-6 border-t border-white/10 flex items-center justify-end gap-3",children:[s.jsx("button",{className:"px-4 py-2 rounded-lg border border-white/20",onClick:t,disabled:i,children:"Cancel"}),s.jsx("button",{className:"px-4 py-2 rounded-lg font-medium text-slate-900 bg-gradient-to-r from-emerald-400 via-teal-300 to-cyan-400 hover:shadow-[0_8px_24px_rgba(16,185,129,0.35)]",onClick:B,disabled:i||!!k,title:k?"Please wait for uploads to finish":"",children:i?"Saving":"Save Settings"})]})]}),P&&s.jsx(lo,{isOpen:P,onClose:()=>{M(!1),(async()=>{const S=De.currentUser?.uid;if(S)try{const U=Ze(Ae,"businesses",S,"preferences","billing"),R=await at(U);if(R.exists()){const v=R.data(),T=v.bank||{},$={bankName:T.bankName||T.name||"",branch:T.branch||"",accountNumber:T.accountNumber||T.account||"",ifsc:T.ifsc||"",accountName:T.accountName||""};p({branding:{logoUrl:v.branding?.logoUrl||"",signatureUrl:v.branding?.signatureUrl||"",stampUrl:v.branding?.stampUrl||""},bank:$,payment:{upiId:v.payment?.upiId||"",upiQrUrl:v.payment?.upiQrUrl||"",multipleUpiIds:v.payment?.multipleUpiIds||[],card:{enabled:v.payment?.card?.enabled||!1,gateway:v.payment?.card?.gateway||"",merchantId:v.payment?.card?.merchantId||"",merchantAccountId:v.payment?.card?.merchantAccountId||"",merchantStatus:v.payment?.card?.merchantStatus||"",apiKey:v.payment?.card?.apiKey||"",paymentLinkEnabled:v.payment?.card?.paymentLinkEnabled||!1},notifications:{sendOnInvoice:v.payment?.notifications?.sendOnInvoice||!1,sendOnCredit:v.payment?.notifications?.sendOnCredit!==!1,autoSendPaymentLink:v.payment?.notifications?.autoSendPaymentLink||!1}},terms:v.terms||""})}}catch(U){console.error("Failed to reload billing settings",U)}})()},onComplete:()=>{ne.success("Payment gateway setup completed!")}}),N&&_t.createPortal(s.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60",children:s.jsxs("div",{className:"bg-white text-slate-900 rounded-lg p-4 w-[90vw] max-w-md",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"font-semibold",children:"Draw Signature"}),s.jsx("button",{onClick:()=>x(!1),children:""})]}),s.jsx("canvas",{ref:F,width:500,height:200,className:"border w-full bg-white"}),s.jsxs("div",{className:"mt-3 flex gap-2 justify-end",children:[s.jsx("button",{className:"px-3 py-1 rounded border",onClick:()=>{const m=F.current;m.getContext("2d").clearRect(0,0,m.width,m.height)},children:"Clear"}),s.jsx("button",{className:"px-3 py-1 rounded bg-emerald-500 text-white",onClick:J,disabled:k==="branding.signatureUrl",children:"Use"})]})]})}),document.body)]}),document.body):null}export{fo as B,go as I,bo as M,xo as P,po as a,yo as b,b as h,gs as n};
